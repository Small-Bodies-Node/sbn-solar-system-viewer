!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three"),require("julian"),require("react")):"function"==typeof define&&define.amd?define(["exports","three","julian","react"],t):t((e=e||self).SbnSolarSystemViewer={},e.THREE,e.julian,e.React)}(this,(function(e,t,n,r){"use strict";function o(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var s=e.apply(t,n);function a(e){o(s,r,i,a,c,"next",e)}function c(e){o(s,r,i,a,c,"throw",e)}a(void 0)}))}}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n,r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r;var c=function(e,t){return function(e){var t=function(e){var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var o=Object.create((t&&t.prototype instanceof h?t:h).prototype),i=new T(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return{value:void 0,done:!0}}for(n.method=o,n.arg=i;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===u)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(e,n,i),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function h(){}function p(){}function d(){}var m={};m[o]=function(){return this};var f=Object.getPrototypeOf,g=f&&f(f(S([])));g&&g!==t&&n.call(g,o)&&(m=g);var y=d.prototype=h.prototype=Object.create(m);function _(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function v(e,t){var r;this._invoke=function(o,i){function s(){return new t((function(r,s){!function r(o,i,s,a){var c=l(e[o],e,i);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(h).then((function(e){u.value=e,s(u)}),(function(e){return r("throw",e,s,a)}))}a(c.arg)}(o,i,r,s)}))}return r=r?r.then(s,s):s()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,u;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function S(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return p.prototype=y.constructor=d,d.constructor=p,p.displayName=a(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,s,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},_(v.prototype),v.prototype[i]=function(){return this},e.AsyncIterator=v,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var s=new v(c(t,n,r,o),i);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(y),a(y,s,"Generator"),y[o]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return s.type="throw",s.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var a=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(a&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;E(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(t={exports:{}}),t.exports}();const l={type:"change"},u={type:"start"},h={type:"end"};class p extends t.EventDispatcher{constructor(e,n){super(),void 0===n&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=n,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.touches={ONE:t.TOUCH.ROTATE,TWO:t.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return a.phi},this.getAzimuthalAngle=function(){return a.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",Y),this._domElementKeyEvents=e},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(l),r.update(),i=o.NONE},this.update=function(){const n=new t.Vector3,u=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),h=u.clone().invert(),f=new t.Vector3,g=new t.Quaternion,y=2*Math.PI;return function(){const e=r.object.position;n.copy(e).sub(r.target),n.applyQuaternion(u),a.setFromVector3(n),r.autoRotate&&i===o.NONE&&x(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(a.theta+=c.theta*r.dampingFactor,a.phi+=c.phi*r.dampingFactor):(a.theta+=c.theta,a.phi+=c.phi);let t=r.minAzimuthAngle,_=r.maxAzimuthAngle;return isFinite(t)&&isFinite(_)&&(t<-Math.PI?t+=y:t>Math.PI&&(t-=y),_<-Math.PI?_+=y:_>Math.PI&&(_-=y),a.theta=t<=_?Math.max(t,Math.min(_,a.theta)):a.theta>(t+_)/2?Math.max(t,a.theta):Math.min(_,a.theta)),a.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,a.phi)),a.makeSafe(),a.radius*=p,a.radius=Math.max(r.minDistance,Math.min(r.maxDistance,a.radius)),!0===r.enableDamping?r.target.addScaledVector(d,r.dampingFactor):r.target.add(d),n.setFromSpherical(a),n.applyQuaternion(h),e.copy(r.target).add(n),r.object.lookAt(r.target),!0===r.enableDamping?(c.theta*=1-r.dampingFactor,c.phi*=1-r.dampingFactor,d.multiplyScalar(1-r.dampingFactor)):(c.set(0,0,0),d.set(0,0,0)),p=1,!!(m||f.distanceToSquared(r.object.position)>s||8*(1-g.dot(r.object.quaternion))>s)&&(r.dispatchEvent(l),f.copy(r.object.position),g.copy(r.object.quaternion),m=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",q),r.domElement.removeEventListener("pointerdown",F),r.domElement.removeEventListener("wheel",B),r.domElement.removeEventListener("touchstart",z),r.domElement.removeEventListener("touchend",X),r.domElement.removeEventListener("touchmove",K),r.domElement.ownerDocument.removeEventListener("pointermove",G),r.domElement.ownerDocument.removeEventListener("pointerup",V),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",Y)};const r=this,o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=o.NONE;const s=1e-6,a=new t.Spherical,c=new t.Spherical;let p=1;const d=new t.Vector3;let m=!1;const f=new t.Vector2,g=new t.Vector2,y=new t.Vector2,_=new t.Vector2,v=new t.Vector2,w=new t.Vector2,b=new t.Vector2,E=new t.Vector2,T=new t.Vector2;function S(){return Math.pow(.95,r.zoomSpeed)}function x(e){c.theta-=e}function M(e){c.phi-=e}const L=function(){const e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),d.add(e)}}(),A=function(){const e=new t.Vector3;return function(t,n){!0===r.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),d.add(e)}}(),P=function(){const e=new t.Vector3;return function(t,n){const o=r.domElement;if(r.object.isPerspectiveCamera){e.copy(r.object.position).sub(r.target);let i=e.length();i*=Math.tan(r.object.fov/2*Math.PI/180),L(2*t*i/o.clientHeight,r.object.matrix),A(2*n*i/o.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(L(t*(r.object.right-r.object.left)/r.object.zoom/o.clientWidth,r.object.matrix),A(n*(r.object.top-r.object.bottom)/r.object.zoom/o.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function R(e){r.object.isPerspectiveCamera?p/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function O(e){r.object.isPerspectiveCamera?p*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),m=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function I(e){f.set(e.clientX,e.clientY)}function C(e){_.set(e.clientX,e.clientY)}function N(e){1==e.touches.length?f.set(e.touches[0].pageX,e.touches[0].pageY):f.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY))}function k(e){1==e.touches.length?_.set(e.touches[0].pageX,e.touches[0].pageY):_.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY))}function D(e){const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);b.set(0,r)}function U(e){1==e.touches.length?g.set(e.touches[0].pageX,e.touches[0].pageY):g.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY)),y.subVectors(g,f).multiplyScalar(r.rotateSpeed);const t=r.domElement;x(2*Math.PI*y.x/t.clientHeight),M(2*Math.PI*y.y/t.clientHeight),f.copy(g)}function H(e){1==e.touches.length?v.set(e.touches[0].pageX,e.touches[0].pageY):v.set(.5*(e.touches[0].pageX+e.touches[1].pageX),.5*(e.touches[0].pageY+e.touches[1].pageY)),w.subVectors(v,_).multiplyScalar(r.panSpeed),P(w.x,w.y),_.copy(v)}function j(e){const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);E.set(0,o),T.set(0,Math.pow(E.y/b.y,r.zoomSpeed)),R(T.y),b.copy(E)}function F(e){if(!1!==r.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){let n;switch(e.preventDefault(),r.domElement.focus?r.domElement.focus():window.focus(),e.button){case 0:n=r.mouseButtons.LEFT;break;case 1:n=r.mouseButtons.MIDDLE;break;case 2:n=r.mouseButtons.RIGHT;break;default:n=-1}switch(n){case t.MOUSE.DOLLY:if(!1===r.enableZoom)return;!function(e){b.set(e.clientX,e.clientY)}(e),i=o.DOLLY;break;case t.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;C(e),i=o.PAN}else{if(!1===r.enableRotate)return;I(e),i=o.ROTATE}break;case t.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enableRotate)return;I(e),i=o.ROTATE}else{if(!1===r.enablePan)return;C(e),i=o.PAN}break;default:i=o.NONE}i!==o.NONE&&(r.domElement.ownerDocument.addEventListener("pointermove",G),r.domElement.ownerDocument.addEventListener("pointerup",V),r.dispatchEvent(u))}(e)}}function G(e){if(!1!==r.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1!==r.enabled)switch(e.preventDefault(),i){case o.ROTATE:if(!1===r.enableRotate)return;!function(e){g.set(e.clientX,e.clientY),y.subVectors(g,f).multiplyScalar(r.rotateSpeed);const t=r.domElement;x(2*Math.PI*y.x/t.clientHeight),M(2*Math.PI*y.y/t.clientHeight),f.copy(g),r.update()}(e);break;case o.DOLLY:if(!1===r.enableZoom)return;!function(e){E.set(e.clientX,e.clientY),T.subVectors(E,b),T.y>0?R(S()):T.y<0&&O(S()),b.copy(E),r.update()}(e);break;case o.PAN:if(!1===r.enablePan)return;!function(e){v.set(e.clientX,e.clientY),w.subVectors(v,_).multiplyScalar(r.panSpeed),P(w.x,w.y),_.copy(v),r.update()}(e)}}(e)}}function V(e){switch(e.pointerType){case"mouse":case"pen":r.domElement.ownerDocument.removeEventListener("pointermove",G),r.domElement.ownerDocument.removeEventListener("pointerup",V),!1!==r.enabled&&(r.dispatchEvent(h),i=o.NONE)}}function B(e){!1===r.enabled||!1===r.enableZoom||i!==o.NONE&&i!==o.ROTATE||(e.preventDefault(),r.dispatchEvent(u),function(e){e.deltaY<0?O(S()):e.deltaY>0&&R(S()),r.update()}(e),r.dispatchEvent(h))}function Y(e){!1!==r.enabled&&!1!==r.enablePan&&function(e){let t=!1;switch(e.code){case r.keys.UP:P(0,r.keyPanSpeed),t=!0;break;case r.keys.BOTTOM:P(0,-r.keyPanSpeed),t=!0;break;case r.keys.LEFT:P(r.keyPanSpeed,0),t=!0;break;case r.keys.RIGHT:P(-r.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),r.update())}(e)}function z(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(r.touches.ONE){case t.TOUCH.ROTATE:if(!1===r.enableRotate)return;N(e),i=o.TOUCH_ROTATE;break;case t.TOUCH.PAN:if(!1===r.enablePan)return;k(e),i=o.TOUCH_PAN;break;default:i=o.NONE}break;case 2:switch(r.touches.TWO){case t.TOUCH.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){r.enableZoom&&D(e),r.enablePan&&k(e)}(e),i=o.TOUCH_DOLLY_PAN;break;case t.TOUCH.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){r.enableZoom&&D(e),r.enableRotate&&N(e)}(e),i=o.TOUCH_DOLLY_ROTATE;break;default:i=o.NONE}break;default:i=o.NONE}i!==o.NONE&&r.dispatchEvent(u)}}function K(e){if(!1!==r.enabled)switch(e.preventDefault(),i){case o.TOUCH_ROTATE:if(!1===r.enableRotate)return;U(e),r.update();break;case o.TOUCH_PAN:if(!1===r.enablePan)return;H(e),r.update();break;case o.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){r.enableZoom&&j(e),r.enablePan&&H(e)}(e),r.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(e){r.enableZoom&&j(e),r.enableRotate&&U(e)}(e),r.update();break;default:i=o.NONE}}function X(e){!1!==r.enabled&&(r.dispatchEvent(h),i=o.NONE)}function q(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",q),r.domElement.addEventListener("pointerdown",F),r.domElement.addEventListener("wheel",B,{passive:!1}),r.domElement.addEventListener("touchstart",z,{passive:!1}),r.domElement.addEventListener("touchend",X),r.domElement.addEventListener("touchmove",K,{passive:!1}),this.update()}}const d={type:"change"},m={type:"start"},f={type:"end"};class g extends t.EventDispatcher{constructor(e,n){super(),void 0===n&&console.warn('THREE.TrackballControls: The second parameter "domElement" is now mandatory.'),n===document&&console.error('THREE.TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');const r=this;this.object=e,this.domElement=n,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=Infinity,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:t.MOUSE.ROTATE,MIDDLE:t.MOUSE.DOLLY,RIGHT:t.MOUSE.PAN},this.target=new t.Vector3;const o=new t.Vector3;let i=1,s=-1,a=-1,c=0,l=0,u=0;const h=new t.Vector3,p=new t.Vector2,g=new t.Vector2,y=new t.Vector3,_=new t.Vector2,v=new t.Vector2,w=new t.Vector2,b=new t.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const e=r.domElement.getBoundingClientRect(),t=r.domElement.ownerDocument.documentElement;r.screen.left=e.left+window.pageXOffset-t.clientLeft,r.screen.top=e.top+window.pageYOffset-t.clientTop,r.screen.width=e.width,r.screen.height=e.height};const E=function(){const e=new t.Vector2;return function(t,n){return e.set((t-r.screen.left)/r.screen.width,(n-r.screen.top)/r.screen.height),e}}(),T=function(){const e=new t.Vector2;return function(t,n){return e.set((t-.5*r.screen.width-r.screen.left)/(.5*r.screen.width),(r.screen.height+2*(r.screen.top-n))/r.screen.width),e}}();function S(e){if(!1!==r.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(e.preventDefault(),-1===s)switch(e.button){case r.mouseButtons.LEFT:s=0;break;case r.mouseButtons.MIDDLE:s=1;break;case r.mouseButtons.RIGHT:s=2;break;default:s=-1}const t=-1!==a?a:s;0!==t||r.noRotate?1!==t||r.noZoom?2!==t||r.noPan||(w.copy(E(e.pageX,e.pageY)),b.copy(w)):(_.copy(E(e.pageX,e.pageY)),v.copy(_)):(g.copy(T(e.pageX,e.pageY)),p.copy(g)),r.domElement.ownerDocument.addEventListener("pointermove",x),r.domElement.ownerDocument.addEventListener("pointerup",M),r.dispatchEvent(m)}(e)}}function x(e){if(!1!==r.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===r.enabled)return;e.preventDefault();const t=-1!==a?a:s;0!==t||r.noRotate?1!==t||r.noZoom?2!==t||r.noPan||b.copy(E(e.pageX,e.pageY)):v.copy(E(e.pageX,e.pageY)):(p.copy(g),g.copy(T(e.pageX,e.pageY)))}(e)}}function M(e){if(!1!==r.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){!1!==r.enabled&&(e.preventDefault(),s=-1,r.domElement.ownerDocument.removeEventListener("pointermove",x),r.domElement.ownerDocument.removeEventListener("pointerup",M),r.dispatchEvent(f))}(e)}}function L(e){!1!==r.enabled&&(window.removeEventListener("keydown",L),-1===a&&(e.code!==r.keys[0]||r.noRotate?e.code!==r.keys[1]||r.noZoom?e.code!==r.keys[2]||r.noPan||(a=2):a=1:a=0))}function A(){!1!==r.enabled&&(a=-1,window.addEventListener("keydown",L))}function P(e){if(!1!==r.enabled&&!0!==r.noZoom){switch(e.preventDefault(),e.deltaMode){case 2:_.y-=.025*e.deltaY;break;case 1:_.y-=.01*e.deltaY;break;default:_.y-=25e-5*e.deltaY}r.dispatchEvent(m),r.dispatchEvent(f)}}function R(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:s=3,g.copy(T(e.touches[0].pageX,e.touches[0].pageY)),p.copy(g);break;default:s=4;const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;l=c=Math.sqrt(t*t+n*n),w.copy(E((e.touches[0].pageX+e.touches[1].pageX)/2,(e.touches[0].pageY+e.touches[1].pageY)/2)),b.copy(w)}r.dispatchEvent(m)}}function O(e){if(!1!==r.enabled)switch(e.preventDefault(),e.touches.length){case 1:p.copy(g),g.copy(T(e.touches[0].pageX,e.touches[0].pageY));break;default:const t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY;l=Math.sqrt(t*t+n*n),b.copy(E((e.touches[0].pageX+e.touches[1].pageX)/2,(e.touches[0].pageY+e.touches[1].pageY)/2))}}function I(e){if(!1!==r.enabled){switch(e.touches.length){case 0:s=-1;break;case 1:s=3,g.copy(T(e.touches[0].pageX,e.touches[0].pageY)),p.copy(g)}r.dispatchEvent(f)}}function C(e){!1!==r.enabled&&e.preventDefault()}this.rotateCamera=function(){const e=new t.Vector3,n=new t.Quaternion,o=new t.Vector3,i=new t.Vector3,s=new t.Vector3,a=new t.Vector3;return function(){a.set(g.x-p.x,g.y-p.y,0);let t=a.length();t?(h.copy(r.object.position).sub(r.target),o.copy(h).normalize(),i.copy(r.object.up).normalize(),s.crossVectors(i,o).normalize(),i.setLength(g.y-p.y),s.setLength(g.x-p.x),a.copy(i.add(s)),e.crossVectors(a,h).normalize(),t*=r.rotateSpeed,n.setFromAxisAngle(e,t),h.applyQuaternion(n),r.object.up.applyQuaternion(n),y.copy(e),u=t):!r.staticMoving&&u&&(u*=Math.sqrt(1-r.dynamicDampingFactor),h.copy(r.object.position).sub(r.target),n.setFromAxisAngle(y,u),h.applyQuaternion(n),r.object.up.applyQuaternion(n)),p.copy(g)}}(),this.zoomCamera=function(){let e;4===s?(e=c/l,c=l,r.object.isPerspectiveCamera?h.multiplyScalar(e):r.object.isOrthographicCamera?(r.object.zoom*=e,r.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(e=1+(v.y-_.y)*r.zoomSpeed,1!==e&&e>0&&(r.object.isPerspectiveCamera?h.multiplyScalar(e):r.object.isOrthographicCamera?(r.object.zoom/=e,r.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),r.staticMoving?_.copy(v):_.y+=(v.y-_.y)*this.dynamicDampingFactor)},this.panCamera=function(){const e=new t.Vector2,n=new t.Vector3,o=new t.Vector3;return function(){if(e.copy(b).sub(w),e.lengthSq()){if(r.object.isOrthographicCamera){const t=(r.object.top-r.object.bottom)/r.object.zoom/r.domElement.clientWidth;e.x*=(r.object.right-r.object.left)/r.object.zoom/r.domElement.clientWidth,e.y*=t}e.multiplyScalar(h.length()*r.panSpeed),o.copy(h).cross(r.object.up).setLength(e.x),o.add(n.copy(r.object.up).setLength(e.y)),r.object.position.add(o),r.target.add(o),r.staticMoving?w.copy(b):w.add(e.subVectors(b,w).multiplyScalar(r.dynamicDampingFactor))}}}(),this.checkDistances=function(){r.noZoom&&r.noPan||(h.lengthSq()>r.maxDistance*r.maxDistance&&(r.object.position.addVectors(r.target,h.setLength(r.maxDistance)),_.copy(v)),h.lengthSq()<r.minDistance*r.minDistance&&(r.object.position.addVectors(r.target,h.setLength(r.minDistance)),_.copy(v)))},this.update=function(){h.subVectors(r.object.position,r.target),r.noRotate||r.rotateCamera(),r.noZoom||r.zoomCamera(),r.noPan||r.panCamera(),r.object.position.addVectors(r.target,h),r.object.isPerspectiveCamera?(r.checkDistances(),r.object.lookAt(r.target),o.distanceToSquared(r.object.position)>1e-6&&(r.dispatchEvent(d),o.copy(r.object.position))):r.object.isOrthographicCamera?(r.object.lookAt(r.target),(o.distanceToSquared(r.object.position)>1e-6||i!==r.object.zoom)&&(r.dispatchEvent(d),o.copy(r.object.position),i=r.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){s=-1,a=-1,r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.up.copy(r.up0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),h.subVectors(r.object.position,r.target),r.object.lookAt(r.target),r.dispatchEvent(d),o.copy(r.object.position),i=r.object.zoom},this.dispose=function(){r.domElement.removeEventListener("contextmenu",C),r.domElement.removeEventListener("pointerdown",S),r.domElement.removeEventListener("wheel",P),r.domElement.removeEventListener("touchstart",R),r.domElement.removeEventListener("touchend",I),r.domElement.removeEventListener("touchmove",O),r.domElement.ownerDocument.removeEventListener("pointermove",x),r.domElement.ownerDocument.removeEventListener("pointerup",M),window.removeEventListener("keydown",L),window.removeEventListener("keyup",A)},this.domElement.addEventListener("contextmenu",C),this.domElement.addEventListener("pointerdown",S),this.domElement.addEventListener("wheel",P,{passive:!1}),this.domElement.addEventListener("touchstart",R,{passive:!1}),this.domElement.addEventListener("touchend",I),this.domElement.addEventListener("touchmove",O,{passive:!1}),this.domElement.ownerDocument.addEventListener("pointermove",x),this.domElement.ownerDocument.addEventListener("pointerup",M),window.addEventListener("keydown",L),window.addEventListener("keyup",A),this.handleResize(),this.update()}}function y(e){return console.clear(),"\n\n   ______________________________    . \\  | / .\n  /                            / \\     \\ \\ / /\n |                            | ==========  - -\n  \\____________________________\\_/     / / \\ \\\n  ______________________________      \\  | / | \\\n /                            / \\     \\ \\ / /.   .\n|                            | ==========  - -\n \\____________________________\\_/     / / \\ \\    /\n   ______________________________   / |\\  | /  .\n  /                            / \\     \\ \\ / /\n |                            | ==========  -  - -\n  \\____________________________\\_/     / / \\ \\\n                                     .  / | \\  .\n\n  Are you trying to wreak havoc!?!\n\n  "+e+"\n\n  Idiot.\n\n  "}function _(e){return 149597870700*e}var v,w={aspectRatio:2,fieldOfView:60,nearPlane:_(1e-5),farPlane:_(3e3)},b=function(){function e(e,n){var r=this;void 0===n&&(n=!1),this._containerId=e,this._isWorldFlippable=n,this._scene=new t.Scene,this._canvas=document.createElement("canvas"),this._clock=new t.Clock(!1),this._initialViewingVector=new t.Vector3(10,10,10),this._isSceneReady=!1,this._isRendering=!1,this._isHelpersShown=!1,this._isInit=!1,this._container=null,this._fps=60,this._camera=new t.PerspectiveCamera(w.fieldOfView,w.aspectRatio,w.nearPlane,w.farPlane),this._sceneEntities=[],this._preInitHook=function(){},this._postInitHook=function(){},this._destroyHook=function(){},this._updateCamera=function(){},this.registerSceneEntities=function(e){e.forEach((function(e){return r._sceneEntities.push(e)}))},this.setHelpersVisibility=function(e){r._isHelpersShown=!!e,r._scene.traverse((function(e){return e.userData.isHelper&&(e.visible=r._isHelpersShown)}))},this.toggleHelpersVisibility=function(){r._isHelpersShown=!r._isHelpersShown,r.setHelpersVisibility(r._isHelpersShown)},this._updateCameraAspect=function(){r._canvas.style.width="100%",r._canvas.style.height="100%";var e=r._canvas.offsetWidth||1,t=r._canvas.offsetHeight||1;r._camera.aspect=e/t,r._camera.updateProjectionMatrix(),r._renderer.setSize(e,t)},this.destroy=function(){window.removeEventListener("resize",r._updateCameraAspect),r._stopRendering(),r._destroyHook()},this._render=function(){r._isRendering&&setTimeout((function(){r._requestAnimationFrameId=requestAnimationFrame(r._render),r._update()}),1e3/r._fps)},this._startRendering=function(){console.log("Starting animation..."),r._isRendering=!0,r._clock.start(),r._render()},this._stopRendering=function(){console.log("Stopping animation..."),r._isRendering=!1,r._clock.stop()}}var n=e.prototype;return n.init=function(){var e=i(c.mark((function e(){var n,r,o,s=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInit){e.next=2;break}return e.abrupt("return");case 2:if(this._isInit=!0,n=new Date,this._preInitHook(),this._container=document.getElementById(this._containerId),this._container){e.next=8;break}throw new Error("No container found with id: "+this._containerId);case 8:if(this._canvas.style.width="100%",this._canvas.style.height="100%",this._container.append(this._canvas),this._container.style.setProperty("position","relative"),window.addEventListener("resize",this._updateCameraAspect),r=window.devicePixelRatio?window.devicePixelRatio:1,this._renderer=new t.WebGLRenderer({canvas:this._canvas,antialias:!0,alpha:!0}),this._renderer.setPixelRatio(r),this._renderer.sortObjects=!1,this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=t.PCFSoftShadowMap,this._renderer.outputEncoding=t.GammaEncoding,this._camera.position.copy(this._initialViewingVector),this._camera.up=new t.Vector3(0,0,1),this._camera.lookAt(0,0,0),this._controls=this._isWorldFlippable?new g(this._camera,this._renderer.domElement):new p(this._camera,this._renderer.domElement),!(this._controls instanceof p)){e.next=29;break}this._controls.enableDamping=!0,this._controls.dampingFactor=.25,e.next=37;break;case 29:if(!(this._controls instanceof g)){e.next=36;break}this._controls.rotateSpeed=10,this._controls.zoomSpeed=1.2,this._controls.panSpeed=.8,this._controls.keys=["65","83","68"],e.next=37;break;case 36:throw Error("Poor Logic");case 37:if(this._sceneEntities.length){e.next=39;break}throw new Error(y("You have no scene entities!"));case 39:return e.next=41,Promise.all(this._sceneEntities.map(function(){var e=i(c.mark((function e(t){var n;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:if((n=e.sent)&&n.children.length){e.next=5;break}throw new Error(y('\n            -----------------------------------------------------------------------------\n            The scene entity "'+t.constructor.name+'" has empty sceneEntityGroup\n            after initialization!!!\n            -----------------------------------------------------------------------------\n            '));case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 41:e.sent.forEach((function(e){return s._scene.add(e)})),this.setHelpersVisibility(!1),this._updateCameraAspect(),this._startRendering(),this._postInitHook(),o=+new Date-+n,console.log("Finished initiating",o);case 49:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setFramesPerSecond=function(e){e<=0||e>100||(this._fps=e)},n._update=function(){var e,t=this._clock.getElapsedTime();if(this._sceneEntities.forEach((function(e){return e.update(t)})),this._updateCamera(t),null==(e=this._controls)||e.update(),!this._camera||!this._renderer)throw new Error("Poor Logic");this._requestAnimationFrameId&&this._renderer.render(this._scene,this._camera)},e}(),E="https://sbn-solar-system-viewer.s3.amazonaws.com",T=function(e,t,n){var r;(r=document.createElement("style")).innerHTML="\n    @keyframes global-fade-in {\n      from { opacity: 0; }\n      to   { opacity: 1; }\n    }\n  ",document.head.append(r);var o=document.createElement("link");function i(){e.style.position="absolute",e.style.setProperty("padding","10px"),e.style.setProperty("color","rgba(255,255,255,0.8)"),e.style.setProperty("background-color","rgba(255,255,255,0.2)"),e.style.setProperty("font-family","'Odibee Sans', cursive"),e.style.setProperty("font-size","20px"),e.style.setProperty("animation","global-fade-in 1s ease-in-out"),e.style.setProperty("cursor","pointer"),e.style.setProperty("-webkit-touch-callout","none"),e.style.setProperty("-webkit-user-select","none"),e.style.setProperty("-khtml-user-select","none"),e.style.setProperty("-moz-user-select","none"),e.style.setProperty("-ms-user-select","none"),e.style.setProperty("user-select","none"),e.style.setProperty("transition","background-color 50ms ease-in-out"),e.addEventListener("click",(function(){e.style.setProperty("background-color","rgba(255,255,255,0.4)"),setTimeout((function(){e.style.setProperty("background-color","rgba(255,255,255,0.2)"),n()}),200)})),t.append(e)}o.rel="stylesheet",o.onload=function(){i()},o.onerror=function(){console.log("Failed to load css url for fonts; continuing anyway..."),i()},o.href="https://fonts.googleapis.com/css2?family=Odibee+Sans",document.head.append(o)},S=function(e,n){return new Promise((function(n){(new t.TextureLoader).load(e,(function(e){e.encoding=t.GammaEncoding,n(e)}),(function(e){console.log("^^^>",e.loaded/e.total*100+"% loaded")}),(function(){n(null)}))}))},x={SUN:{radiusMeters:696342e3,periodDays:void 0},MERCURY:{radiusMeters:2439700,periodDays:87.9691},VENUS:{radiusMeters:6051800,periodDays:224.701},EARTH:{radiusMeters:6378e3,periodDays:365.256},MARS:{radiusMeters:3389500,periodDays:686.971},CERES:{radiusMeters:47e4,periodDays:1683.14570801},JUPITER:{radiusMeters:71492e3,periodDays:4332.59},SATURN:{radiusMeters:60268e3,periodDays:10759.22},URANUS:{radiusMeters:25362e3,periodDays:30688.5},NEPTUNE:{radiusMeters:24764e3,periodDays:60182},PLUTO:{radiusMeters:1188300,periodDays:90560},HAUMEA:{radiusMeters:62e4,periodDays:103410},MOON:{radiusMeters:35e4,periodDays:29.5}},M=function(){var e=this;this._sceneEntityGroup=new t.Group,this.getSceneEntityGroup=function(){return e._sceneEntityGroup}},L=function(e){function n(n,r,o){var i;(i=e.call(this)||this)._name=n,i._radius=r,i._isToyScale=!1;var a=s({sphereSegments:32,toyScale:3e3,realScale:1},o),c=a.sphereSegments,l=a.toyScale;return i._realScale=a.realScale,i._toyScale=l,i._geometry=new t.SphereGeometry(i._radius,c,c),i._geometry.rotateX(Math.PI/2),i._wires=new t.LineSegments(new t.EdgesGeometry(i._geometry),new t.LineBasicMaterial),i._wires.userData.isHelper=!0,i._material=new t.MeshPhongMaterial,i._model=new t.Mesh(i._geometry,i._material),i._model.receiveShadow=!0,i._model.castShadow=!0,i._model.name=i._name,i._sceneEntityGroup.name=i._name,i._sceneEntityGroup.add(i._model),i._sceneEntityGroup.add(i._wires),i}a(n,e);var r=n.prototype;return r.setIsToyScale=function(e){this._isToyScale=e},r._setToToyScale=function(){this._isToyScale=!0;var e=this._toyScale;this._model&&this._model.scale.set(e,e,e),this._wires&&this._wires.scale.set(e,e,e),this._clouds&&this._clouds.scale.set(e,e,e)},r._updateMeshScale=function(){var e=this._isToyScale?this._toyScale:this._realScale,t=this._model.scale,n=t.x,r=t.y,o=t.z;if(n!==e){var i=this._toyScale/50;n<e&&(this._model.scale.set(n+i,r+i,o+i),this._wires&&this._wires.scale.set(n+i,r+i,o+i),this._clouds&&this._clouds.scale.set(n+i,r+i,o+i)),n>e&&(this._model.scale.set(n-i,r-i,o-i),this._wires&&this._wires.scale.set(n-i,r-i,o-i),this._clouds&&this._clouds.scale.set(n-i,r-i,o-i)),Math.abs(n-e)<i&&(this._model.scale.set(e,e,e),this._wires&&this._wires.scale.set(e,e,e),this._clouds&&this._clouds.scale.set(e,e,e))}},r._updateToyScale=function(e){this._updateMeshScale()},n}(M),A=x.SUN.radiusMeters,P=10*A*40,R=10*A,O=function(e){function n(){var t;return(t=e.call(this,"SUN",A,{toyScale:P,realScale:R})||this).name="SUN",t}a(n,e);var r=n.prototype;return r.init=function(){var e=i(c.mark((function e(){var n=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(c.mark((function e(r){var o;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(E+"/stars/sun-sprite-512.png");case 2:(o=new t.Sprite(new t.SpriteMaterial({blending:t.AdditiveBlending,depthWrite:!1,map:e.sent}))).updateMatrix(),o.matrixAutoUpdate=!0,n._model.visible=!1,n._model=o,n._sceneEntityGroup.name=n.name,n._sceneEntityGroup.add(n._model),r(n._sceneEntityGroup);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.update=function(e){this._updateMeshScale()},n}(L);function I(e){return new Promise(function(){var n=i(c.mark((function n(r){var o,i,s,a,l,u;return c.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(o=document.createElement("canvas")).width=1024,o.height=512,i=o.getContext("2d"),(s=new Image).crossOrigin="Anonymous",a=new t.SphereGeometry(e,32,32,Math.PI/2),l=new t.MeshPhongMaterial({map:new t.Texture(o),side:t.DoubleSide,transparent:!0,opacity:.8}),u=new t.Mesh(a,l),document.body.append(o),s.addEventListener("load",(function(){var e=document.createElement("canvas");e.width=s.width,e.height=s.height;var t=e.getContext("2d");t.drawImage(s,0,0);var n=t.getImageData(0,0,e.width,e.height),o=new Image;o.crossOrigin="Anonymous",o.addEventListener("load",(function(){var a=document.createElement("canvas");a.width=o.width,a.height=o.height;var c=a.getContext("2d");c.drawImage(o,0,0);try{for(var h=c.getImageData(0,0,a.width,a.height),p=t.createImageData(e.width,e.height),d=0,m=0;d<s.height;d++)for(var f=0;f<s.width;f++,m+=4)p.data[m+0]=n.data[m+0],p.data[m+1]=n.data[m+1],p.data[m+2]=n.data[m+2],p.data[m+3]=255-h.data[m+0];i.putImageData(p,0,0),l&&l.map&&(l.map.needsUpdate=!0)}catch(e){console.log("Error: ",e),r(void 0)}r(u)})),o.src=E+"/planets/earth/earth-clouds-trans-1024.png"}),!1),s.src=E+"/planets/earth/earth-clouds-color-1024.png";case 12:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}!function(e){e.PLANET="PLANET",e.SUN="SUN",e.ASTEROID="ASTEROID"}(v||(v={}));var C=new Set(["a","e","i","q","epoch","period","tp","ma","n","L","om","w","wBar","GM"]),N=new Set(["i","ma","n","L","om","w","wBar"]);function k(e){return void 0!==e}var D=function(){function e(e,t,n){var r=this;void 0===t&&(t="rad"),void 0===n&&(n=!1),this._locked=!1,this._attrs=s({},e),this._locked=!1,e&&Object.keys(e).forEach((function(n){var o=N.has(n)?t:void 0,i=e[n];i&&r.set(n,i,o)})),void 0===this._attrs.GM&&(this._attrs.GM=U.SUN),this.fill(),this.get("e")>.9&&void 0===this.get("tp")&&console.warn('You must specify "tp" (time of perihelion) for highly eccentric orbits'),this._locked=n}var t=e.prototype;return t.set=function(e,t,n){if(void 0===n&&(n="rad"),this._locked)throw new Error("Attempted to modify locked (immutable) Ephem object");return C.has(e)?(this._attrs[e]="deg"===n?t*Math.PI/180:t,!0):(console.warn("Invalid ephem attr: "+e),!1)},t.get=function(e,t){void 0===t&&(t="rad");var n=this._attrs[e];return"deg"===t?180*n/Math.PI:n},t.fill=function(){var e=this.get("e");if(!k(e))throw new Error('Must define eccentricity "e" in an orbit');var t=this.get("a"),n=this.get("q");if(k(t)){if(!k(n)){if(e>=1)throw new Error('Must provide perihelion distance "q" if eccentricity "e" is greater than 1');this.set("q",n=t*(1-e))}}else{if(!k(n))throw new Error('Must define semimajor axis "a" or perihelion distance "q" in an orbit');this.set("a",t=n/(1-e))}var r=this.get("w"),o=this.get("wBar"),i=this.get("om");k(r)&&k(i)&&!k(o)?this.set("wBar",o=r+i):k(o)&&k(i)&&!k(r)?this.set("w",r=o-i):k(r)&&k(o)&&!k(i)&&this.set("om",i=o-r);var s=149597870700*t,a=this.get("n"),c=this.get("GM"),l=this.get("period");if(!k(l)&&k(t)&&(l=2*Math.PI*Math.sqrt(s*s*s/c)/86400,this.set("period",l)),e<1)if(k(l)&&!k(a)){var u=2*Math.PI/l;this.set("n",u)}else k(a)&&!k(l)&&this.set("period",2*Math.PI/a);var h=this.get("ma"),p=this.get("L");!k(p)&&k(i)&&k(r)&&k(h)&&this.set("L",p=i+r+h),k(h)||this.set("ma",p-o)},t.lock=function(){this._locked=!0},t.copy=function(){return new e({GM:this.get("GM"),epoch:this.get("epoch"),a:this.get("a"),e:this.get("e"),i:this.get("i"),om:this.get("om"),ma:this.get("ma"),w:this.get("w")},"rad")},e}(),U={SUN:0x731c14d13d71fc000,MERCURY:22031780000000.02,VENUS:324858592000000.06,EARTH_MOON:403503235502259.8,MARS:42828375214000.02,JUPITER:0x1c22c96966960d0,SATURN:379405852e8,URANUS:5794548600000008,NEPTUNE:6836527100580024,PLUTO_CHARON:977000000000.0007},H={MERCURY:new D({epoch:2458426.5,a:.3870968969437096,e:.2056515875393916,i:7.003891682749818,om:48.30774804443502,w:29.17940253442659,ma:256.190975209273},"deg",!0),VENUS:new D({epoch:2458426.5,a:.7233458663591554,e:.006762510759617694,i:3.394567787211735,om:76.62534150657346,w:54.74567447560867,ma:275.6687596099721},"deg",!0),EARTH:new D({epoch:2451545,a:1.00000261,e:.01671123,i:-1531e-8,om:0,wBar:102.93768193,L:100.46457166},"deg",!0),MOON:new D({GM:398600,epoch:2458621.5,a:.002582517063772124,e:.04582543645168888,i:5.102060246928811,om:108.5916732144811,w:61.80561793729225,ma:50.53270083636792},"deg",!0),MARS:new D({epoch:2458426.5,a:1.52371401537107,e:.09336741335309606,i:1.848141099825311,om:49.50420572080223,w:286.6965847685386,ma:25.38237617924876},"deg",!0),CERES:new D({epoch:2458600.5,a:2.7658,e:.078,i:10.607,om:80.7,w:73.1,ma:77.37209589},"deg",!0),JUPITER:new D({epoch:2458426.5,a:5.20180355911023,e:.0489912558249006,i:1.303560894624275,om:100.5203828847816,w:273.736301845404,ma:231.939544389401},"deg",!0),SATURN:new D({epoch:2458426.5,a:9.577177295536776,e:.05101889921719987,i:2.482782449972317,om:113.6154964073247,w:339.4422648650336,ma:187.0970898012944},"deg",!0),URANUS:new D({epoch:2458426.5,a:19.14496966635462,e:.04832662948112808,i:.7697511134483724,om:74.14239045667875,w:99.42704504702185,ma:220.2603033874267},"deg",!0),NEPTUNE:new D({epoch:2458426.5,a:30.0962226342805,e:.00736257118719377,i:1.774569249829094,om:131.8695882492132,w:258.6226409499831,ma:315.2804988924479},"deg",!0),PLUTO:new D({epoch:2454000.5,a:39.4450697257,e:.250248713478,i:17.0890009196,om:110.376957955,w:112.597141677,ma:25.2471897122},"deg",!0),HAUMEA:new D({epoch:2454000.5,a:39.4450697257,e:.250248713478,i:17.0890009196,om:110.376957955,w:112.597141677,ma:25.2471897122},"deg",!0)};function j(e,t,n){return[1*e,1*t,1*n]}function F(e,t,n,r,o,i){if(void 0===e)throw"data object is undefined";if(!Array.isArray(e))throw"data object must be an array";if(n>=r)throw"first row must be greater than last row";if(n<0)throw"first row must be greater than zero";if(r>e.length-1)throw"last row must be ";if(!Array.isArray(e[n]))throw"data in rows must be array data";var s=e[0].length-1;if(o<0||o>s)throw"xIndex has to be between 0 and "+s+": "+o;if(i<0||i>s)throw"yIndex has to be between 0 and "+s+": "+i;for(var a=0,c=n;c<=r;c++){for(var l=1,u=n;u<=r;u++)u!==c&&(l*=(t-e[u][o])/(e[c][o]-e[u][o]));a+=l*e[c][i]}return a}var G,V=function(e,t){return e-t},B=function(e,t){return e[0]-t},Y={distance:"au",time:"day"},z=new Set(["km","au"]),K=new Set(["cartesianposvel"]),X=new Set(["lagrange"]),q=new Set(["day","sec"]),Z=function(){function e(e){if(this._units=s({},Y),this._ephemType="cartesianposvel",this._interpolationType="lagrange",this._interpolationOrder=5,!e)throw"EphemerisTable must be initialized with an ephemeris data structure";if(!e.data||!Array.isArray(e.data)||0===e.data.length||!Array.isArray(e.data[0]))throw"EphemerisTable must be initialized with a structure containing an array of arrays of ephemeris data";if(this._data=[].concat(e.data),e.distanceUnits){if(!z.has(e.distanceUnits))throw"Unknown distance units: "+e.distanceUnits;this._units.distance=e.distanceUnits}if(e.timeUnits){if(!q.has(e.timeUnits))throw"Unknown time units: "+e.timeUnits;this._units.time=e.timeUnits}if(e.ephemerisType){if(!K.has(e.ephemerisType))throw"Unknown ephemeris type: "+e.ephemerisType;this._ephemType=e.ephemerisType}if(e.interpolationType){if(!X.has(e.interpolationType))throw"Unknown interpolation type: "+e.interpolationType;this._interpolationType=e.interpolationType}if(void 0!==e.interpolationOrder){if(e.interpolationOrder<1||e.interpolationOrder>20)throw"Interpolation order must be >0 and <20: "+e.interpolationOrder;this._interpolationOrder=e.interpolationOrder}if(this._units.distance!==Y.distance||this._units.time!==Y.time){var t=this.calcDistanceMultiplier(this._units.distance),n=this.calcTimeMultiplier(this._units.time);this._data.forEach((function(e){e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t*n,e[5]*=t*n,e[6]*=t*n}))}}var t=e.prototype;return t.getPositionAtTime=function(e){if(e<=this._data[0][0])return[this._data[0][1],this._data[0][2],this._data[0][3]];var t=this._data[this._data.length-1];if(e>=t[0])return[t[1],t[2],t[3]];var n=this.calcBoundingIndices(e),r=n.startIndex,o=n.stopIndex;return[F(this._data,e,r,o,0,1),F(this._data,e,r,o,0,2),F(this._data,e,r,o,0,3)]},t.getPositions=function(e,t,n){if(e>t)throw"Requested start needs to be after requested stop";if(n<=0)throw"Step days needs to be greater than zero";for(var r=[],o=e;o<=t;o+=n)r.push(this.getPositionAtTime(o));return r},t.calcDistanceMultiplier=function(e){switch(e){case"au":return 1;case"km":return 1/149597870.7;default:throw new Error("Unknown distance unit type: "+e)}},t.calcTimeMultiplier=function(e){switch(e){case"day":return 1;case"sec":return 1/86400;default:throw new Error("Unknown time unit type: "+e)}},t.calcBoundingIndices=function(e){var t=Math.floor(this._interpolationOrder/2),n=function(e,t,n){if(void 0===n&&(n=V),void 0===e)throw"data object is undefined";if(!Array.isArray(e))throw"data object must be an array";if(void 0===t)throw"value object must be defined";if(void 0===n)throw"comparer must be defined";for(var r=0,o=e.length;r<=o;){var i=Math.floor((r+o)/2);if(i===e.length)return i;var s=n(e[i],t);if(s<0)r=i+1;else{if(!(s>0))return i;o=i-1}}return~r}(this._data,e,B);n<0&&(n=~n-1);var r=n-t;r<0&&(r=0);var o=r+Number(this._interpolationOrder);return o>=this._data.length&&(o=this._data.length-1,this._data.length>t&&(r=o-t)),{startIndex:r,stopIndex:o}},e}(),W=Math.sin,Q=Math.cos,J=Math.sqrt;function $(e){return Math.exp(Math.log(e)/3)}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.PARABOLIC=1]="PARABOLIC",e[e.HYPERBOLIC=2]="HYPERBOLIC",e[e.ELLIPTICAL=3]="ELLIPTICAL",e[e.TABLE=4]="TABLE"}(G||(G={}));var ee=function(){function e(e,t){this._ephem=e,this._orbitStart=0,this._orbitStop=0,this._options=s({color:"white",eclipticLineColor:"cyan"},t,{orbitPathSettings:s({leadDurationYears:10,trailDurationYears:10,numberSamplePoints:360},t.orbitPathSettings)}),this._orbitType=function(e){if(e instanceof Z)return G.TABLE;var t=e.get("e");return t>.9&&t<1.2?G.PARABOLIC:t>1.2?G.HYPERBOLIC:G.ELLIPTICAL}(this._ephem)}var r=e.prototype;return r.getPositionAtTime=function(e,t){switch(void 0===t&&(t=!1),this._orbitType){case G.PARABOLIC:return this.getPositionAtTimeNearParabolic(e,t);case G.HYPERBOLIC:return this.getPositionAtTimeHyperbolic(e,t);case G.ELLIPTICAL:return this.getPositionAtTimeElliptical(e,t);case G.TABLE:return this.getPositionAtTimeTable(e,t)}throw new Error("No handler for this type of orbit")},r.getPositionAtTimeParabolic=function(e,t){var n=this._ephem;if(n instanceof Z)throw new Error("Poor logic allowing table type here");var r=n.get("q"),o=(e-n.get("tp"))*(.01720209895/J(2))/J(r*r*r)*1.5,i=J(1+o*o),s=$(i+o)-$(i-o),a=2*Math.atan(s);return this.vectorToHeliocentric(a,r*(1+s*s))},r.getPositionAtTimeNearParabolic=function(e,t){var n=this._ephem;if(n instanceof Z)throw new Error("Poor logic allowing table type here");var r=n.get("e"),o=n.get("q"),i=.75*(e-n.get("tp"))*.01720209895*J((1+r)/(o*o*o)),s=J(1+i*i),a=$(s+i)-$(s-i),c=(1-r)/(1+r),l=a*a/(1+a*a),u=c*l*l,h=a*(1+c*l*(2/3+.4*a*a+(1.4+33/35*a*a+37/175*Math.pow(a,4))*u+a*a*(432/175+956/1125*a*a+84/1575*Math.pow(a,4))*u*u)),p=2*Math.atan(h);return this.vectorToHeliocentric(p,o*(1+h*h)/(1+h*h*c))},r.getPositionAtTimeHyperbolic=function(e,t){var n=this._ephem;if(n instanceof Z)throw new Error("Poor logic allowing table type here");for(var r=n.get("e"),o=n.get("a"),i=n.get("ma")+n.get("n","rad")*(e-n.get("epoch")),s=i,a=0;a<100;a++){var c=(i+r*(s*Math.cosh(s)-Math.sinh(s)))/(r*Math.cosh(s)-1),l=Math.abs(c-s);if(s=c,l<1e-7)break}var u=s,h=2*Math.atan(J((r+1)/(r-1)))*Math.tanh(u/2),p=o*(1-r*r)/(1+r*Q(h));return this.vectorToHeliocentric(h,p)},r.getPositionAtTimeElliptical=function(e,t){void 0===t&&(t=!1);var n=this._ephem;if(n instanceof Z)throw new Error("Poor logic allowing table type here");var r=n.get("e"),o=n.get("ma","rad"),i=n.get("n","rad"),s=e-n.get("epoch"),a=o+i*s;t&&(console.info("period=",n.get("period")),console.info("n=",i),console.info("ma=",o),console.info("d=",s),console.info("M=",a));for(var c=a,l=0;l<100;l++){var u=a+r*W(c),h=Math.abs(u-c);if(c=u,h<1e-7)break}var p=c,d=2*Math.atan(J((1+r)/(1-r))*Math.tan(p/2)),m=n.get("a")*(1-r*r)/(1+r*Q(d));return this.vectorToHeliocentric(d,m)},r.getPositionAtTimeTable=function(e,t){if(this._ephem instanceof D)throw new Error("Poor logic allowing non-table type here");var n=this._ephem.getPositionAtTime(e);return j(n[0],n[1],n[2])},r.vectorToHeliocentric=function(e,t){var n=this._ephem;if(n instanceof Z)throw new Error("Poor logic allowing table type here");var r=n.get("i","rad"),o=n.get("om","rad"),i=n.get("wBar","rad");return j(t*(Q(o)*Q(e+i-o)-W(o)*W(e+i-o)*Q(r)),t*(W(o)*Q(e+i-o)+Q(o)*W(e+i-o)*Q(r)),t*(W(e+i-o)*W(r)))},r.needsUpdateForTime=function(e){return this._orbitType===G.TABLE&&(e<this._orbitStart||e>this._orbitStop)},r.getOrbitShape=function(e,t){if(void 0===t&&(t=!1),t&&(this._orbitShape&&(this._orbitShape.geometry.dispose(),this._orbitShape.material.dispose()),this._orbitShape=void 0,this._orbitPoints&&this._orbitPoints.dispose(),this._orbitPoints=void 0,this._eclipticDropLines&&(this._eclipticDropLines.geometry.dispose(),this._eclipticDropLines.material.dispose()),this._eclipticDropLines=void 0),this._orbitShape)return this._orbitShape;if(this._orbitType===G.ELLIPTICAL)return this.getEllipse();var r=(this._orbitType===G.TABLE?e:this._ephem.get("tp"))||n.toJulianDay(new Date),o=r-365.25*this._options.orbitPathSettings.trailDurationYears,i=r+365.25*this._options.orbitPathSettings.leadDurationYears,s=(i-o)/this._options.orbitPathSettings.numberSamplePoints;switch(this._orbitStart=o,this._orbitStop=i,this._orbitType){case G.HYPERBOLIC:return this.getLine(this.getPositionAtTimeHyperbolic.bind(this),o,i,s);case G.PARABOLIC:return this.getLine(this.getPositionAtTimeNearParabolic.bind(this),o,i,s);case G.TABLE:return this.getTableOrbit(o,i,s)}throw new Error("Unknown orbit shape")},r.getLine=function(e,n,r,o){for(var i=[],s=n;s<=r;s+=o){var a=e(s);a[0]=_(a[0]),a[1]=_(a[1]),a[2]=_(a[2]),i.push(new t.Vector3(a[0],a[1],a[2]))}var c=new t.BufferGeometry;return c.setFromPoints(i),this.generateAndCacheOrbitShape(c)},r.getTableOrbit=function(e,n,r){if(this._ephem instanceof D)throw new Error("Poor logic allowing non-table type here");var o=this._ephem.getPositions(e,n,r).map((function(e){return[1*(t=e)[0],1*t[1],1*t[2]];var t})).map((function(e){return new t.Vector3(e[0],e[1],e[2])})),i=new t.BufferGeometry;return i.setFromPoints(o),this.generateAndCacheOrbitShape(i)},r.getEllipse=function(){var e=this.getEllipseGeometry();return this.generateAndCacheOrbitShape(e)},r.getEllipseGeometry=function(){var e=this._ephem;if(e instanceof Z)throw new Error("Poor logic allowing table type here");e.get("period");for(var n=e.get("a"),r=e.get("e"),o=2*Math.PI,i=o/90,s=[],a=0;a<o;a+=i){var c=2*Math.atan(J((1+r)/(1-r))*Math.tan(a/2)),l=n*(1-r*r)/(1+r*Q(c)),u=this.vectorToHeliocentric(c,l);(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))&&(console.error("NaN position value - you may have bad or incomplete data in the following ephemeris:"),console.error(e)),s.push(new t.Vector3(_(u[0]),_(u[1]),_(u[2])))}s.push(s[0]);var h=new t.BufferGeometry;return h.setFromPoints(s),h},r.generateAndCacheOrbitShape=function(e){return this._orbitPoints=e,this._orbitShape=new t.Line(e,new t.LineBasicMaterial({color:new t.Color(this._options.color||4473924)})),this._orbitShape},r.getLinesToEcliptic=function(){if(this._eclipticDropLines)return this._eclipticDropLines;this._orbitPoints||this.getOrbitShape();var e=this._orbitPoints,n=new t.BufferGeometry;if(!e)throw new Error("Poor logic letting point be undefined here");return this._eclipticDropLines=new t.LineSegments(n,new t.LineBasicMaterial({color:this._options.eclipticLineColor||3355443,blending:t.AdditiveBlending})),this._eclipticDropLines},r.getHexColor=function(){var e;return null==(e=this._orbitShape)?void 0:e.material.color.getHex()},r.setHexColor=function(e){var n,r;null!=(n=this._orbitShape)&&null!=(r=n.material)&&r.color&&(this._orbitShape.material.color=new t.Color(e))},r.getVisibility=function(){var e;return null==(e=this._orbitShape)?void 0:e.visible},r.setVisibility=function(e){this._orbitShape&&(this._orbitShape.visible=e)},e}(),te=function(){function e(e,t){var n=this;switch(void 0===t&&(t=v.PLANET),this.name=e,this.orbitalType=t,this.loadPlanet=function(){n.SKEph=H[n.name],n.SKOrbit=new ee(n.SKEph,{color:"white",eclipticLineColor:void 0,orbitPathSettings:void 0}),n.SKprojectedOrbitLine=n.SKOrbit.getOrbitShape()},this.loadAsteroid=function(){n.SKEph=new D({epoch:2458600.5,a:5.38533,e:.19893,i:22.11137,om:294.42992,w:314.2889,ma:229.14238},"deg"),n.SKOrbit=new ee(n.SKEph,{color:"cyan",eclipticLineColor:void 0,orbitPathSettings:void 0}),n.SKprojectedOrbitLine=n.SKOrbit.getOrbitShape()},this.getProjectedOrbitLine=function(){return n.SKprojectedOrbitLine},this.orbitalType){case v.ASTEROID:this.loadAsteroid();break;case v.PLANET:default:this.loadPlanet()}}return e.prototype.getXyzMeters=function(e){var t;void 0===e&&(e=0);var n=null==(t=this.SKOrbit)?void 0:t.getPositionAtTime(e);return n?{x:_(n[0]),y:_(n[1]),z:_(n[2])}:{x:0,y:0,z:0}},e}(),ne=function(e){function t(t,n,r,o){var i,s;return(i=e.call(this,t,r,{toyScale:o,realScale:1,sphereSegments:(s=n,s===v.ASTEROID?8:32)})||this)._name=t,i._orbitalType=n,i.getOrbit=function(){return i._orbit},i._orbit=new te(i._name,n),i._sceneEntityGroup.name=i._name,i._sceneEntityGroup.add(i._orbit.getProjectedOrbitLine()),i}a(t,e);var n=t.prototype;return n._getOrbitXyz=function(){return{x:this._model.position.x,y:this._model.position.y,z:this._model.position.z}},n._updateOrbitalPosition=function(e){var t=this._orbit.getXyzMeters(e),n=t.x,r=t.y,o=t.z;this._model.position.set(n,r,o),this._wires.position.set(n,r,o),this._clouds&&this._clouds.position.set(n,r,o)},t}(L);class re extends t.Loader{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new ce(e)})),this.register((function(e){return new ue(e)})),this.register((function(e){return new he(e)})),this.register((function(e){return new le(e)})),this.register((function(e){return new se(e)})),this.register((function(e){return new pe(e)}))}load(e,n,r,o){const i=this;let s;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:t.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);const a=function(t){o?o(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},c=new t.FileLoader(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,(function(t){try{i.parse(t,s,(function(t){n(t),i.manager.itemEnd(e)}),a)}catch(e){a(e)}}),r,a)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,n,r,o){let i;const s={},a={};if("string"==typeof e)i=e;else if(t.LoaderUtils.decodeText(new Uint8Array(e,0,4))===de){try{s[ie.KHR_BINARY_GLTF]=new me(e)}catch(e){return void(o&&o(e))}i=s[ie.KHR_BINARY_GLTF].content}else i=t.LoaderUtils.decodeText(new Uint8Array(e));const c=JSON.parse(i);if(void 0===c.asset||c.asset.version[0]<2)return void(o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new ke(c,{path:n||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](l);a[t.name]=t,s[t.name]=!0}if(c.extensionsUsed)for(let e=0;e<c.extensionsUsed.length;++e){const t=c.extensionsUsed[e],n=c.extensionsRequired||[];switch(t){case ie.KHR_MATERIALS_UNLIT:s[t]=new ae;break;case ie.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:s[t]=new _e;break;case ie.KHR_DRACO_MESH_COMPRESSION:s[t]=new fe(c,this.dracoLoader);break;case ie.KHR_TEXTURE_TRANSFORM:s[t]=new ge;break;case ie.KHR_MESH_QUANTIZATION:s[t]=new ve;break;default:n.indexOf(t)>=0&&void 0===a[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(s),l.setPlugins(a),l.parse(r,o)}}function oe(){let e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const ie={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class se{constructor(e){this.parser=e,this.name=ie.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n];r.extensions&&r.extensions[this.name]&&void 0!==r.extensions[this.name].light&&e._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(e){const n=this.parser,r="light:"+e;let o=n.cache.get(r);if(o)return o;const i=n.json,s=((i.extensions&&i.extensions[this.name]||{}).lights||[])[e];let a;const c=new t.Color(16777215);void 0!==s.color&&c.fromArray(s.color);const l=void 0!==s.range?s.range:0;switch(s.type){case"directional":a=new t.DirectionalLight(c),a.target.position.set(0,0,-1),a.add(a.target);break;case"point":a=new t.PointLight(c),a.distance=l;break;case"spot":a=new t.SpotLight(c),a.distance=l,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,a.angle=s.spot.outerConeAngle,a.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return a.position.set(0,0,0),a.decay=2,void 0!==s.intensity&&(a.intensity=s.intensity),a.name=n.createUniqueName(s.name||"light_"+e),o=Promise.resolve(a),n.cache.add(r,o),o}createNodeAttachment(e){const t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))}}class ae{constructor(){this.name=ie.KHR_MATERIALS_UNLIT}getMaterialType(){return t.MeshBasicMaterial}extendParams(e,n,r){const o=[];e.color=new t.Color(1,1,1),e.opacity=1;const i=n.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){const t=i.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==i.baseColorTexture&&o.push(r.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(o)}}class ce{constructor(e){this.parser=e,this.name=ie.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?t.MeshPhysicalMaterial:null}extendMaterialParams(e,n){const r=this.parser,o=r.json.materials[e];if(!o.extensions||!o.extensions[this.name])return Promise.resolve();const i=[],s=o.extensions[this.name];if(void 0!==s.clearcoatFactor&&(n.clearcoat=s.clearcoatFactor),void 0!==s.clearcoatTexture&&i.push(r.assignTexture(n,"clearcoatMap",s.clearcoatTexture)),void 0!==s.clearcoatRoughnessFactor&&(n.clearcoatRoughness=s.clearcoatRoughnessFactor),void 0!==s.clearcoatRoughnessTexture&&i.push(r.assignTexture(n,"clearcoatRoughnessMap",s.clearcoatRoughnessTexture)),void 0!==s.clearcoatNormalTexture&&(i.push(r.assignTexture(n,"clearcoatNormalMap",s.clearcoatNormalTexture)),void 0!==s.clearcoatNormalTexture.scale)){const e=s.clearcoatNormalTexture.scale;n.clearcoatNormalScale=new t.Vector2(e,-e)}return Promise.all(i)}}class le{constructor(e){this.parser=e,this.name=ie.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const n=this.parser.json.materials[e];return n.extensions&&n.extensions[this.name]?t.MeshPhysicalMaterial:null}extendMaterialParams(e,t){const n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const o=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(o)}}class ue{constructor(e){this.parser=e,this.name=ie.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;const o=n.images[r.extensions[this.name].source],i=t.options.ktx2Loader;if(!i){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,o,i)}}class he{constructor(e){this.parser=e,this.name=ie.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;const i=r.images[o.extensions[t].source];let s=n.textureLoader;if(i.uri){const e=n.options.manager.getHandler(i.uri);null!==e&&(s=e)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,i,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class pe{constructor(e){this.name=ie.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){const e=n.extensions[this.name],r=this.parser.getDependency("buffer",e.buffer),o=this.parser.options.meshoptDecoder;if(!o||!o.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([r,o.ready]).then((function(t){const n=e.byteOffset||0,r=e.byteLength||0,i=e.count,s=e.byteStride,a=new ArrayBuffer(i*s),c=new Uint8Array(t[0],n,r);return o.decodeGltfBuffer(new Uint8Array(a),i,s,c,e.mode,e.filter),a}))}return null}}const de="glTF";class me{constructor(e){this.name=ie.KHR_BINARY_GLTF,this.content=null,this.body=null;const n=new DataView(e,0,12);if(this.header={magic:t.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==de)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const r=this.header.length-12,o=new DataView(e,12);let i=0;for(;i<r;){const n=o.getUint32(i,!0);i+=4;const r=o.getUint32(i,!0);if(i+=4,1313821514===r){const r=new Uint8Array(e,12+i,n);this.content=t.LoaderUtils.decodeText(r)}else if(5130562===r){const t=12+i;this.body=e.slice(t,t+n)}i+=n}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class fe{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=ie.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,s={},a={},c={};for(const e in i){const t=xe[e]||e.toLowerCase();s[t]=i[e]}for(const t in e.attributes){const r=xe[t]||t.toLowerCase();if(void 0!==i[t]){const o=n.accessors[e.attributes[t]];c[r]=be[o.componentType],a[r]=!0===o.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(const t in e.attributes){const n=e.attributes[t],r=a[t];void 0!==r&&(n.normalized=r)}t(e)}),s,c)}))}))}}class ge{constructor(){this.name=ie.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e}}class ye extends t.MeshStandardMaterial{constructor(e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const n=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),o=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),s=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new t.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=a,this.onBeforeCompile=function(e){for(const t in a)e.uniforms[t]=a[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",n).replace("#include <metalnessmap_pars_fragment>",r).replace("#include <roughnessmap_fragment>",o).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",s)},Object.defineProperties(this,{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}copy(e){return super.copy(e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class _e{constructor(){this.name=ie.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return ye}extendParams(e,n,r){const o=n.extensions[this.name];e.color=new t.Color(1,1,1),e.opacity=1;const i=[];if(Array.isArray(o.diffuseFactor)){const t=o.diffuseFactor;e.color.fromArray(t),e.opacity=t[3]}if(void 0!==o.diffuseTexture&&i.push(r.assignTexture(e,"map",o.diffuseTexture)),e.emissive=new t.Color(0,0,0),e.glossiness=void 0!==o.glossinessFactor?o.glossinessFactor:1,e.specular=new t.Color(1,1,1),Array.isArray(o.specularFactor)&&e.specular.fromArray(o.specularFactor),void 0!==o.specularGlossinessTexture){const t=o.specularGlossinessTexture;i.push(r.assignTexture(e,"glossinessMap",t)),i.push(r.assignTexture(e,"specularMap",t))}return Promise.all(i)}createMaterial(e){const n=new ye(e);return n.fog=!0,n.color=e.color,n.map=void 0===e.map?null:e.map,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=void 0===e.aoMap?null:e.aoMap,n.aoMapIntensity=1,n.emissive=e.emissive,n.emissiveIntensity=1,n.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,n.bumpMap=void 0===e.bumpMap?null:e.bumpMap,n.bumpScale=1,n.normalMap=void 0===e.normalMap?null:e.normalMap,n.normalMapType=t.TangentSpaceNormalMap,e.normalScale&&(n.normalScale=e.normalScale),n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.specularMap=void 0===e.specularMap?null:e.specularMap,n.specular=e.specular,n.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,n.glossiness=e.glossiness,n.alphaMap=null,n.envMap=void 0===e.envMap?null:e.envMap,n.envMapIntensity=1,n.refractionRatio=.98,n}}class ve{constructor(){this.name=ie.KHR_MESH_QUANTIZATION}}class we extends t.Interpolant{constructor(e,t,n,r){super(e,t,n,r)}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r;for(let e=0;e!==r;e++)t[e]=n[o+e];return t}}we.prototype.beforeStart_=we.prototype.copySampleValue_,we.prototype.afterEnd_=we.prototype.copySampleValue_,we.prototype.interpolate_=function(e,t,n,r){const o=this.resultBuffer,i=this.sampleValues,s=this.valueSize,a=2*s,c=3*s,l=r-t,u=(n-t)/l,h=u*u,p=h*u,d=e*c,m=d-c,f=-2*p+3*h,g=p-h,y=1-f,_=g-h+u;for(let e=0;e!==s;e++)o[e]=y*i[m+e+s]+_*(i[m+e+a]*l)+f*i[d+e+s]+g*(i[d+e]*l);return o};const be={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ee={9728:t.NearestFilter,9729:t.LinearFilter,9984:t.NearestMipmapNearestFilter,9985:t.LinearMipmapNearestFilter,9986:t.NearestMipmapLinearFilter,9987:t.LinearMipmapLinearFilter},Te={33071:t.ClampToEdgeWrapping,33648:t.MirroredRepeatWrapping,10497:t.RepeatWrapping},Se={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},xe={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Me={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Le={CUBICSPLINE:void 0,LINEAR:t.InterpolateLinear,STEP:t.InterpolateDiscrete};function Ae(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function Pe(e,t,n){for(const r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function Re(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function Oe(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){const n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(let t=0,r=n.length;t<r;t++)e.morphTargetDictionary[n[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ie(e){const t=e.extensions&&e.extensions[ie.KHR_DRACO_MESH_COMPRESSION];let n;return n=t?"draco:"+t.bufferView+":"+t.indices+":"+Ce(t.attributes):e.indices+":"+Ce(e.attributes)+":"+e.mode,n}function Ce(e){let t="";const n=Object.keys(e).sort();for(let r=0,o=n.length;r<o;r++)t+=n[r]+":"+e[n[r]]+";";return t}function Ne(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class ke{constructor(e={},n={}){this.json=e,this.extensions={},this.plugins={},this.options=n,this.cache=new oe,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},this.textureLoader="undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?new t.ImageBitmapLoader(this.options.manager):new t.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new t.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){const i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};Pe(o,i,r),Re(i,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(i)}))).then((function(){e(i)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[];for(let n=0,r=t.length;n<r;n++){const r=t[n].joints;for(let t=0,n=r.length;t<n;t++)e[r[t]].isBone=!0}for(let t=0,r=e.length;t<r;t++){const r=e[t];void 0!==r.mesh&&(this._addNodeRef(this.meshCache,r.mesh),void 0!==r.skin&&(n[r.mesh].isSkinnedMesh=!0)),void 0!==r.camera&&this._addNodeRef(this.cameraCache,r.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,n){if(e.refs[t]<=1)return n;const r=n.clone();return r.name+="_instance_"+e.uses[t]++,r}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let n=0;n<t.length;n++){const r=e(t[n]);if(r)return r}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const n=[];for(let r=0;r<t.length;r++){const o=e(t[r]);o&&n.push(o)}return n}getDependency(e,t){const n=e+":"+t;let r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r}getDependencies(e){let t=this.cache.get(e);if(!t){const n=this;t=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[ie.KHR_BINARY_GLTF].body);const r=this.options;return new Promise((function(e,o){n.load(Ae(t.uri,r.path),e,void 0,(function(){o(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const n=t.byteOffset||0;return e.slice(n,n+(t.byteLength||0))}))}loadAccessor(e){const n=this,r=this.json,o=this.json.accessors[e];if(void 0===o.bufferView&&void 0===o.sparse)return Promise.resolve(null);const i=[];return i.push(void 0!==o.bufferView?this.getDependency("bufferView",o.bufferView):null),void 0!==o.sparse&&(i.push(this.getDependency("bufferView",o.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",o.sparse.values.bufferView))),Promise.all(i).then((function(e){const i=e[0],s=Se[o.type],a=be[o.componentType],c=a.BYTES_PER_ELEMENT,l=o.byteOffset||0,u=void 0!==o.bufferView?r.bufferViews[o.bufferView].byteStride:void 0,h=!0===o.normalized;let p,d;if(u&&u!==c*s){const e=Math.floor(l/u),r="InterleavedBuffer:"+o.bufferView+":"+o.componentType+":"+e+":"+o.count;let m=n.cache.get(r);m||(p=new a(i,e*u,o.count*u/c),m=new t.InterleavedBuffer(p,u/c),n.cache.add(r,m)),d=new t.InterleavedBufferAttribute(m,s,l%u/c,h)}else p=null===i?new a(o.count*s):new a(i,l,o.count*s),d=new t.BufferAttribute(p,s,h);if(void 0!==o.sparse){const n=o.sparse.values.byteOffset||0,r=new(0,be[o.sparse.indices.componentType])(e[1],o.sparse.indices.byteOffset||0,o.sparse.count*Se.SCALAR),c=new a(e[2],n,o.sparse.count*s);null!==i&&(d=new t.BufferAttribute(d.array.slice(),d.itemSize,d.normalized));for(let e=0,t=r.length;e<t;e++){const t=r[e];if(d.setX(t,c[e*s]),s>=2&&d.setY(t,c[e*s+1]),s>=3&&d.setZ(t,c[e*s+2]),s>=4&&d.setW(t,c[e*s+3]),s>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return d}))}loadTexture(e){const t=this.json,n=t.images[t.textures[e].source];let r=this.textureLoader;if(n.uri){const e=this.options.manager.getHandler(n.uri);null!==e&&(r=e)}return this.loadTextureImage(e,n,r)}loadTextureImage(e,n,r){const o=this,i=this.json,s=this.options,a=i.textures[e],c=self.URL||self.webkitURL;let l=n.uri,u=!1,h=!0;if("image/jpeg"===n.mimeType&&(h=!1),void 0!==n.bufferView)l=o.getDependency("bufferView",n.bufferView).then((function(e){if("image/png"===n.mimeType){const t=new DataView(e,25,1).getUint8(0,!1);h=6===t||4===t||3===t}u=!0;const t=new Blob([e],{type:n.mimeType});return l=c.createObjectURL(t),l}));else if(void 0===n.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(l).then((function(e){return new Promise((function(n,o){let i=n;!0===r.isImageBitmapLoader&&(i=function(e){n(new t.CanvasTexture(e))}),r.load(Ae(e,s.path),i,void 0,o)}))})).then((function(n){!0===u&&c.revokeObjectURL(l),n.flipY=!1,a.name&&(n.name=a.name),h||(n.format=t.RGBFormat);const r=(i.samplers||{})[a.sampler]||{};return n.magFilter=Ee[r.magFilter]||t.LinearFilter,n.minFilter=Ee[r.minFilter]||t.LinearMipmapLinearFilter,n.wrapS=Te[r.wrapS]||t.RepeatWrapping,n.wrapT=Te[r.wrapT]||t.RepeatWrapping,o.associations.set(n,{type:"textures",index:e}),n}))}assignTexture(e,t,n){const r=this;return this.getDependency("texture",n.index).then((function(o){if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),r.extensions[ie.KHR_TEXTURE_TRANSFORM]){const e=void 0!==n.extensions?n.extensions[ie.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=r.associations.get(o);o=r.extensions[ie.KHR_TEXTURE_TRANSFORM].extendTexture(o,e),r.associations.set(o,t)}}e[t]=o}))}assignFinalMaterial(e){const n=e.geometry;let r=e.material;const o=void 0!==n.attributes.tangent,i=void 0!==n.attributes.color,s=void 0===n.attributes.normal,a=!0===e.isSkinnedMesh,c=Object.keys(n.morphAttributes).length>0,l=c&&void 0!==n.morphAttributes.normal;if(e.isPoints){const e="PointsMaterial:"+r.uuid;let n=this.cache.get(e);n||(n=new t.PointsMaterial,t.Material.prototype.copy.call(n,r),n.color.copy(r.color),n.map=r.map,n.sizeAttenuation=!1,this.cache.add(e,n)),r=n}else if(e.isLine){const e="LineBasicMaterial:"+r.uuid;let n=this.cache.get(e);n||(n=new t.LineBasicMaterial,t.Material.prototype.copy.call(n,r),n.color.copy(r.color),this.cache.add(e,n)),r=n}if(o||i||s||a||c){let e="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(e+="specular-glossiness:"),a&&(e+="skinning:"),o&&(e+="vertex-tangents:"),i&&(e+="vertex-colors:"),s&&(e+="flat-shading:"),c&&(e+="morph-targets:"),l&&(e+="morph-normals:");let t=this.cache.get(e);t||(t=r.clone(),a&&(t.skinning=!0),i&&(t.vertexColors=!0),s&&(t.flatShading=!0),c&&(t.morphTargets=!0),l&&(t.morphNormals=!0),o&&(t.vertexTangents=!0,t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(r))),r=t}r.aoMap&&void 0===n.attributes.uv2&&void 0!==n.attributes.uv&&n.setAttribute("uv2",n.attributes.uv),e.material=r}getMaterialType(){return t.MeshStandardMaterial}loadMaterial(e){const n=this,r=this.extensions,o=this.json.materials[e];let i;const s={},a=o.extensions||{},c=[];if(a[ie.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const e=r[ie.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];i=e.getMaterialType(),c.push(e.extendParams(s,o,n))}else if(a[ie.KHR_MATERIALS_UNLIT]){const e=r[ie.KHR_MATERIALS_UNLIT];i=e.getMaterialType(),c.push(e.extendParams(s,o,n))}else{const r=o.pbrMetallicRoughness||{};if(s.color=new t.Color(1,1,1),s.opacity=1,Array.isArray(r.baseColorFactor)){const e=r.baseColorFactor;s.color.fromArray(e),s.opacity=e[3]}void 0!==r.baseColorTexture&&c.push(n.assignTexture(s,"map",r.baseColorTexture)),s.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,s.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(c.push(n.assignTexture(s,"metalnessMap",r.metallicRoughnessTexture)),c.push(n.assignTexture(s,"roughnessMap",r.metallicRoughnessTexture))),i=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,s)}))))}!0===o.doubleSided&&(s.side=t.DoubleSide);const l=o.alphaMode||"OPAQUE";return"BLEND"===l?(s.transparent=!0,s.depthWrite=!1):(s.transparent=!1,"MASK"===l&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&i!==t.MeshBasicMaterial&&(c.push(n.assignTexture(s,"normalMap",o.normalTexture)),s.normalScale=new t.Vector2(1,-1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,-o.normalTexture.scale)),void 0!==o.occlusionTexture&&i!==t.MeshBasicMaterial&&(c.push(n.assignTexture(s,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&i!==t.MeshBasicMaterial&&(s.emissive=(new t.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&i!==t.MeshBasicMaterial&&c.push(n.assignTexture(s,"emissiveMap",o.emissiveTexture)),Promise.all(c).then((function(){let a;return a=i===ye?r[ie.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new i(s),o.name&&(a.name=o.name),a.map&&(a.map.encoding=t.sRGBEncoding),a.emissiveMap&&(a.emissiveMap.encoding=t.sRGBEncoding),Re(a,o),n.associations.set(a,{type:"materials",index:e}),o.extensions&&Pe(r,a,o),a}))}createUniqueName(e){const n=t.PropertyBinding.sanitizeNodeName(e||"");let r=n;for(let e=1;this.nodeNamesUsed[r];++e)r=n+"_"+e;return this.nodeNamesUsed[r]=!0,r}loadGeometries(e){const n=this,r=this.extensions,o=this.primitiveCache;function i(e){return r[ie.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,n).then((function(t){return Ue(t,e,n)}))}const s=[];for(let r=0,a=e.length;r<a;r++){const a=e[r],c=Ie(a),l=o[c];if(l)s.push(l.promise);else{let e;e=a.extensions&&a.extensions[ie.KHR_DRACO_MESH_COMPRESSION]?i(a):Ue(new t.BufferGeometry,a,n),o[c]={primitive:a,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){const n=this,r=this.extensions,o=this.json.meshes[e],i=o.primitives,s=[];for(let e=0,n=i.length;e<n;e++){const n=void 0===i[e].material?(void 0===(a=this.cache).DefaultMaterial&&(a.DefaultMaterial=new t.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:t.FrontSide})),a.DefaultMaterial):this.getDependency("material",i[e].material);s.push(n)}var a;return s.push(n.loadGeometries(i)),Promise.all(s).then((function(s){const a=s.slice(0,s.length-1),c=s[s.length-1],l=[];for(let s=0,u=c.length;s<u;s++){const u=c[s],h=i[s];let p;const d=a[s];if(4===h.mode||5===h.mode||6===h.mode||void 0===h.mode)p=!0===o.isSkinnedMesh?new t.SkinnedMesh(u,d):new t.Mesh(u,d),!0!==p.isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),5===h.mode?p.geometry=He(p.geometry,t.TriangleStripDrawMode):6===h.mode&&(p.geometry=He(p.geometry,t.TriangleFanDrawMode));else if(1===h.mode)p=new t.LineSegments(u,d);else if(3===h.mode)p=new t.Line(u,d);else if(2===h.mode)p=new t.LineLoop(u,d);else{if(0!==h.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+h.mode);p=new t.Points(u,d)}Object.keys(p.geometry.morphAttributes).length>0&&Oe(p,o),p.name=n.createUniqueName(o.name||"mesh_"+e),Re(p,o),h.extensions&&Pe(r,p,h),n.assignFinalMaterial(p),l.push(p)}if(1===l.length)return l[0];const u=new t.Group;for(let e=0,t=l.length;e<t;e++)u.add(l[e]);return u}))}loadCamera(e){let n;const r=this.json.cameras[e],o=r[r.type];if(o)return"perspective"===r.type?n=new t.PerspectiveCamera(t.MathUtils.radToDeg(o.yfov),o.aspectRatio||1,o.znear||1,o.zfar||2e6):"orthographic"===r.type&&(n=new t.OrthographicCamera(-o.xmag,o.xmag,o.ymag,-o.ymag,o.znear,o.zfar)),r.name&&(n.name=this.createUniqueName(r.name)),Re(n,r),Promise.resolve(n);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))}loadAnimation(e){const n=this.json.animations[e],r=[],o=[],i=[],s=[],a=[];for(let e=0,t=n.channels.length;e<t;e++){const t=n.channels[e],c=n.samplers[t.sampler],l=t.target,u=void 0!==n.parameters?n.parameters[c.input]:c.input,h=void 0!==n.parameters?n.parameters[c.output]:c.output;r.push(this.getDependency("node",void 0!==l.node?l.node:l.id)),o.push(this.getDependency("accessor",u)),i.push(this.getDependency("accessor",h)),s.push(c),a.push(l)}return Promise.all([Promise.all(r),Promise.all(o),Promise.all(i),Promise.all(s),Promise.all(a)]).then((function(r){const o=r[0],i=r[1],s=r[2],a=r[3],c=r[4],l=[];for(let e=0,n=o.length;e<n;e++){const n=o[e],r=i[e],u=s[e],h=a[e],p=c[e];if(void 0===n)continue;let d;switch(n.updateMatrix(),n.matrixAutoUpdate=!0,Me[p.path]){case Me.weights:d=t.NumberKeyframeTrack;break;case Me.rotation:d=t.QuaternionKeyframeTrack;break;case Me.position:case Me.scale:default:d=t.VectorKeyframeTrack}const m=n.name?n.name:n.uuid,f=void 0!==h.interpolation?Le[h.interpolation]:t.InterpolateLinear,g=[];Me[p.path]===Me.weights?n.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(m);let y=u.array;if(u.normalized){const e=Ne(y.constructor),t=new Float32Array(y.length);for(let n=0,r=y.length;n<r;n++)t[n]=y[n]*e;y=t}for(let e=0,t=g.length;e<t;e++){const t=new d(g[e]+"."+Me[p.path],r.array,y,f);"CUBICSPLINE"===h.interpolation&&(t.createInterpolant=function(e){return new we(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(t)}}return new t.AnimationClip(n.name?n.name:"animation_"+e,void 0,l)}))}createNodeMesh(e){const t=this,n=this.json.nodes[e];return void 0===n.mesh?null:t.getDependency("mesh",n.mesh).then((function(e){const r=t._getNodeRef(t.meshCache,n.mesh,e);return void 0!==n.weights&&r.traverse((function(e){if(e.isMesh)for(let t=0,r=n.weights.length;t<r;t++)e.morphTargetInfluences[t]=n.weights[t]})),r}))}loadNode(e){const n=this.extensions,r=this,o=this.json.nodes[e],i=o.name?r.createUniqueName(o.name):"";return function(){const t=[],n=r._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return n&&t.push(n),void 0!==o.camera&&t.push(r.getDependency("camera",o.camera).then((function(e){return r._getNodeRef(r.cameraCache,o.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(s){let a;if(a=!0===o.isBone?new t.Bone:s.length>1?new t.Group:1===s.length?s[0]:new t.Object3D,a!==s[0])for(let e=0,t=s.length;e<t;e++)a.add(s[e]);if(o.name&&(a.userData.name=o.name,a.name=i),Re(a,o),o.extensions&&Pe(n,a,o),void 0!==o.matrix){const e=new t.Matrix4;e.fromArray(o.matrix),a.applyMatrix4(e)}else void 0!==o.translation&&a.position.fromArray(o.translation),void 0!==o.rotation&&a.quaternion.fromArray(o.rotation),void 0!==o.scale&&a.scale.fromArray(o.scale);return r.associations.set(a,{type:"nodes",index:e}),a}))}loadScene(e){const n=this.json,r=this.extensions,o=this.json.scenes[e],i=this,s=new t.Group;o.name&&(s.name=i.createUniqueName(o.name)),Re(s,o),o.extensions&&Pe(r,s,o);const a=o.nodes||[],c=[];for(let e=0,t=a.length;e<t;e++)c.push(De(a[e],s,n,i));return Promise.all(c).then((function(){return s}))}}function De(e,n,r,o){const i=r.nodes[e];return o.getDependency("node",e).then((function(e){if(void 0===i.skin)return e;let n;return o.getDependency("skin",i.skin).then((function(e){n=e;const t=[];for(let e=0,r=n.joints.length;e<r;e++)t.push(o.getDependency("node",n.joints[e]));return Promise.all(t)})).then((function(r){return e.traverse((function(e){if(!e.isMesh)return;const o=[],i=[];for(let e=0,s=r.length;e<s;e++){const s=r[e];if(s){o.push(s);const r=new t.Matrix4;void 0!==n.inverseBindMatrices&&r.fromArray(n.inverseBindMatrices.array,16*e),i.push(r)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',n.joints[e])}e.bind(new t.Skeleton(o,i),e.matrixWorld)})),e}))})).then((function(e){n.add(e);const t=[];if(i.children){const n=i.children;for(let i=0,s=n.length;i<s;i++)t.push(De(n[i],e,r,o))}return Promise.all(t)}))}function Ue(e,n,r){const o=n.attributes,i=[];function s(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(const t in o){const n=xe[t]||t.toLowerCase();n in e.attributes||i.push(s(o[t],n))}if(void 0!==n.indices&&!e.index){const t=r.getDependency("accessor",n.indices).then((function(t){e.setIndex(t)}));i.push(t)}return Re(e,n),function(e,n,r){const o=n.attributes,i=new t.Box3;if(void 0===o.POSITION)return;{const e=r.json.accessors[o.POSITION],n=e.min,s=e.max;if(void 0===n||void 0===s)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(i.set(new t.Vector3(n[0],n[1],n[2]),new t.Vector3(s[0],s[1],s[2])),e.normalized){const t=Ne(be[e.componentType]);i.min.multiplyScalar(t),i.max.multiplyScalar(t)}}const s=n.targets;if(void 0!==s){const e=new t.Vector3,n=new t.Vector3;for(let t=0,o=s.length;t<o;t++){const o=s[t];if(void 0!==o.POSITION){const t=r.json.accessors[o.POSITION],i=t.min,s=t.max;if(void 0!==i&&void 0!==s){if(n.setX(Math.max(Math.abs(i[0]),Math.abs(s[0]))),n.setY(Math.max(Math.abs(i[1]),Math.abs(s[1]))),n.setZ(Math.max(Math.abs(i[2]),Math.abs(s[2]))),t.normalized){const e=Ne(be[t.componentType]);n.multiplyScalar(e)}e.max(n)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}i.expandByVector(e)}e.boundingBox=i;const a=new t.Sphere;i.getCenter(a.center),a.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=a}(e,n,r),Promise.all(i).then((function(){return void 0!==n.targets?function(e,t,n){let r=!1,o=!1;for(let e=0,n=t.length;e<n;e++){const n=t[e];if(void 0!==n.POSITION&&(r=!0),void 0!==n.NORMAL&&(o=!0),r&&o)break}if(!r&&!o)return Promise.resolve(e);const i=[],s=[];for(let a=0,c=t.length;a<c;a++){const c=t[a];if(r){const t=void 0!==c.POSITION?n.getDependency("accessor",c.POSITION):e.attributes.position;i.push(t)}if(o){const t=void 0!==c.NORMAL?n.getDependency("accessor",c.NORMAL):e.attributes.normal;s.push(t)}}return Promise.all([Promise.all(i),Promise.all(s)]).then((function(t){const n=t[1];return r&&(e.morphAttributes.position=t[0]),o&&(e.morphAttributes.normal=n),e.morphTargetsRelative=!0,e}))}(e,n.targets,r):e}))}function He(e,n){let r=e.getIndex();if(null===r){const t=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)t.push(e);e.setIndex(t),r=e.getIndex()}const o=r.count-2,i=[];if(n===t.TriangleFanDrawMode)for(let e=1;e<=o;e++)i.push(r.getX(0)),i.push(r.getX(e)),i.push(r.getX(e+1));else for(let e=0;e<o;e++)e%2==0?(i.push(r.getX(e)),i.push(r.getX(e+1)),i.push(r.getX(e+2))):(i.push(r.getX(e+2)),i.push(r.getX(e+1)),i.push(r.getX(e)));i.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=e.clone();return s.setIndex(i),s}function je(e,n,r,o){return new Promise((function(i){(new re).load(e,(function(e){var s=e.scene;n&&function(e,n){var r=Math.pow(10,-10);e.traverse((function(e){e instanceof t.Mesh&&(e.geometry.computeBoundingSphere(),e.geometry&&e.geometry.boundingSphere&&e.geometry.boundingSphere.radius>r&&(r=e.geometry.boundingSphere.radius))}));var o=n/r;e.scale.set(o,o,o)}(s,n),r&&function(e){var n=(new t.Box3).setFromObject(e).getCenter(new t.Vector3).toArray(),r=n[0],o=n[1],i=n[2],s=e.position.clone().toArray();e.position.set(s[0]-r,s[1]-o,s[2]-i)}(s),o&&function(e){e.traverse((function(e){"Mesh"===e.type&&(e.castShadow=!0,e.receiveShadow=!0)}))}(s),i(s)}),(function(e){console.log(e.loaded/e.total*100+"% loaded")}),(function(e){console.log("Loading error occurred:",e.message)}))}))}var Fe,Ge=["MERCURY","VENUS","EARTH","MARS","CERES","PLUTO"],Ve=["HAUMEA"],Be=function(e){function n(t){var n;return(n=e.call(this,t,v.PLANET,function(e){return x[e].radiusMeters}(t),function(e){return"PLUTO"===e||"CERES"===e?1e4:"HAUMEA"===e?15e3:3e3}(t))||this).name=t,n}a(n,e);var r=n.prototype;return r.init=function(){var e=i(c.mark((function e(){var n=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(c.mark((function e(r){var o;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n._name.toLowerCase(),Ve.includes(n.name)){e.next=6;break}return e.next=4,S(E+"/planets/"+o+"/"+o+"-map-1024.jpg");case 4:n._material.map=e.sent,n._material.shininess=2;case 6:if(!Ge.includes(n.name)){e.next=12;break}return e.next=9,S(E+"/planets/"+o+"/"+o+"-bump-1024.png");case 9:n._material.bumpMap=e.sent,n._material.bumpScale=50*n._radius,n._model instanceof t.Mesh&&(n._model.material=n._material);case 12:if("EARTH"!==n.name){e.next=21;break}return e.next=15,S(E+"/planets/earth/earth-specular-1024.png");case 15:return n._material.specularMap=e.sent,n._material.shininess=25,e.next=19,I(1.025*n._radius);case 19:n._clouds=e.sent,n._clouds&&n._sceneEntityGroup.add(n._clouds);case 21:Ve.includes(n.name)&&function(){var e=i(c.mark((function e(){var r,i;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je(E+"/planets/"+o+"/"+o+".glb",n._radius);case 2:r=e.sent,(i=new t.Group).add(r),n._model=i,n._sceneEntityGroup.add(n._model);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),r(n._sceneEntityGroup);case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.update=function(e){this._updateOrbitalPosition(e),this._updateMeshScale(),this._model.rotateZ(.0015),this._clouds&&this._clouds.rotateZ(.0012)},n}(ne),Ye=function(e){function n(n){var r;return(r=e.call(this)||this).radius=n,r.name="STARFIELD",r.texture=null,r.invertColor=function(){r.texture&&(r.texture=function(e,n){void 0===n&&(n=!1);var r=e.image,o=document.createElement("canvas"),i=r.width,s=r.height;o.width=i,o.height=s;var a=o.getContext("2d");a.drawImage(r,0,0);for(var c=a.getImageData(0,0,i,s),l=0,u=0;l<s;l++)for(var h=0;h<i;h++,u+=4)c.data[u+0]=255-c.data[u+0],c.data[u+1]=255-c.data[u+1],c.data[u+2]=255-c.data[u+2],n&&(c.data[u+3]=255-c.data[u+3]);return a.putImageData(c,0,0),new t.CanvasTexture(o)}(r.texture),r.material.map=r.texture,r.material.needsUpdate=!0)},r.material=new t.MeshPhongMaterial({side:t.DoubleSide,transparent:!0}),r.mesh=new t.Mesh(new t.SphereGeometry(n,32,32),r.material),r.mesh.rotation.y=Math.PI/2,r._sceneEntityGroup.add(r.mesh),r._sceneEntityGroup.name="STARFIELD",r}a(n,e);var r=n.prototype;return r.init=function(){var e=i(c.mark((function e(){var t=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(c.mark((function e(n){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(E+"/stars/galaxy_starfield3.jpg");case 2:t.texture=e.sent,t.material.map=t.texture,t._sceneEntityGroup.add(t.mesh),n(t._sceneEntityGroup),setTimeout((function(){console.log("invert!!!"),t.invertColor()}),2e3);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.update=function(e){},n}(M),ze=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).update=function(e){t._sceneEntityGroup.position.x+=0*e},t}return a(n,e),n.prototype.init=function(){var e=i(c.mark((function e(){var n=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var r=new t.AxesHelper(500);r.userData.isHelper=!0,n._sceneEntityGroup.add(r),e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n}(M),Ke=function(e){function n(t){var n;return void 0===t&&(t=.3),(n=e.call(this)||this)._defaultIntensity=t,n.update=function(e){n._sceneEntityGroup.position.x+=0*e},n.setPower=function(e){n._light.intensity=e||n._defaultIntensity},n}a(n,e);var r=n.prototype;return r.init=function(){var e=i(c.mark((function e(){var n=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n._light=new t.AmbientLight(3355443,n._defaultIntensity),n._light.userData.isAmbientLight=!0,n._sceneEntityGroup.add(n._light),e(n._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r.setIsOn=function(e){this._light.visible=e},n}(M),Xe=function(e){function t(t,n){return void 0===n&&(n=1e4),e.call(this,t,v.ASTEROID,n,3e4)||this}a(t,e);var n=t.prototype;return n.init=function(){var e=i(c.mark((function e(){var t=this;return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=i(c.mark((function e(n){return c.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._sceneEntityGroup.add(t._orbit.getProjectedOrbitLine()),n(t._sceneEntityGroup);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.update=function(e){this._updateOrbitalPosition(e),this._updateMeshScale(),this._model.rotateY(.01)},t}(ne),qe=function(e){function n(n){var r;return(r=e.call(this,n)||this).isToyScale=!0,r.tCenturiesSinceJ2000=((new Date).getTime()/1e3-946727935.816+5)/3155692597.474,r.toggleIsToyScale=function(){r.isToyScale=!r.isToyScale,r.setIsToyScale(r.isToyScale)},r.setIsToyScale=function(e){r.isToyScale=!!e,r.sun.setIsToyScale(r.isToyScale),r.planets.forEach((function(e){return e.setIsToyScale(r.isToyScale)})),r.asteroids.forEach((function(e){return e.setIsToyScale(r.isToyScale)}))},r._updateCamera=function(e){var t,n=r._clock.getDelta();r.tCenturiesSinceJ2000+=.13689546324816237*n,r._sceneEntities.forEach((function(e){return e.update(r.tCenturiesSinceJ2000)})),r._controls instanceof g&&(null==(t=r._controls)||t.update())},r.sun=new O,r.starField=new Ye(_(999)),r.planets=[new Be("MERCURY"),new Be("VENUS"),new Be("EARTH"),new Be("MARS"),new Be("CERES"),new Be("JUPITER"),new Be("SATURN"),new Be("URANUS"),new Be("NEPTUNE"),new Be("HAUMEA")],r.asteroids=[new Xe("65P")],r.registerSceneEntities([new ze,new Ke(3)].concat(r.planets,r.asteroids,[r.starField,r.sun])),r._preInitHook=function(){var e=_(4);r._initialViewingVector=new t.Vector3(0,0,e)},r._postInitHook=function(){!function(e,t){if(!e)throw new Error("Canvas Container is Falsy!");var n=document.createElement("div");n.innerText="Toggle Lights",n.style.setProperty("top","10px"),n.style.setProperty("left","10px"),T(n,e,(function(){}))}(r._container),function(e,t){if(!e)throw new Error("Canvas Container is Falsy!");var n=document.createElement("div");n.innerText="Toggle Toy Scale",n.style.setProperty("top","10px"),n.style.setProperty("left","50%"),n.style.setProperty("transform","translateX(-50%)"),T(n,e,t)}(r._container,r.toggleIsToyScale),function(e,t){if(!e)throw new Error("Canvas Container is Falsy!");var n=document.createElement("div");n.innerText="Toggle Helpers",n.style.setProperty("top","10px"),n.style.setProperty("right","10px"),T(n,e,t)}(r._container,r.toggleHelpersVisibility),r._controls.maxDistance=_(100),r.setIsToyScale(!0),r.setHelpersVisibility(!1),r._camera.position.set(-4514678652999.103,-996799575287.2986,1431642047889.7205)},r._destroyHook=function(){},r}return a(n,e),n}(b);function Ze(e){if(void 0===e&&(e="threejs-canvas-container"),!document.getElementById(e))throw new Error("Can't find div of id "+e);(Fe=new qe(e)).init(),new D({epoch:2458426.5,a:.3870968969437096,e:.2056515875393916,i:7.003891682749818,om:48.30774804443502,w:29.17940253442659,ma:256.190975209273},"deg",!0)}function We(){Fe.destroy()}e.SbnSolarSystemViewer=function(e){var t=s({width:"100%",height:"100%",backgroundColor:"grey"},e),n=t.width,o=t.height,i=t.backgroundColor,a="this-id-will-never-be-duplicated-says-007";return r.useEffect((function(){return Ze(a),function(){We(),console.log("Widget app removed!!!")}}),[]),r.createElement("div",{id:a,style:{width:n,height:o,backgroundColor:i}})},e.destroy=We,e.init=Ze,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=sbnsolarsystemviewer.umd.production.min.js.map
