"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("three"),n=require("three/examples/jsm/controls/OrbitControls"),r=require("uuid"),i=t(require("julian")),o=require("three/examples/jsm/utils/BufferGeometryUtils"),a=require("react-icons/fi"),s=require("react-icons/ai"),c=require("react-icons/io"),l=t(require("react"));function u(t,e,n,r,i,o,a){try{var s=t[o](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(t){u(o,r,i,a,s,"next",t)}function s(t){u(o,r,i,a,s,"throw",t)}a(void 0)}))}}function p(){return(p=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function d(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f,_=(function(t){var e=function(t){var e=Object.prototype,n=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=Object.create((e&&e.prototype instanceof h?e:h).prototype),o=new P(r||[]);return i._invoke=function(t,e,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return{value:void 0,done:!0}}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===u)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=l(t,e,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}(t,n,o),i}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var u={};function h(){}function p(){}function d(){}var f={};f[i]=function(){return this};var _=Object.getPrototypeOf,y=_&&_(_(S([])));y&&y!==e&&n.call(y,i)&&(f=y);var g=d.prototype=h.prototype=Object.create(f);function m(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function v(t,e){var r;this._invoke=function(i,o){function a(){return new e((function(r,a){!function r(i,o,a,s){var c=l(t[i],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,s)}),(function(t){r("throw",t,a,s)})):e.resolve(h).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,s)}))}s(c.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function w(t,e){var n=t.iterator[e.method];if(void 0===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return u;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var r=l(n,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,u;var i=r.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,u):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,u)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:T}}function T(){return{value:void 0,done:!0}}return p.prototype=g.constructor=d,d.constructor=p,p.displayName=s(d,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,s(t,a,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},m(v.prototype),v.prototype[o]=function(){return this},t.AsyncIterator=v,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new v(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},m(g),s(g,a,"Generator"),g[i]=function(){return this},g.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=S,P.prototype={constructor:P,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),u},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),u}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:S(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}(f={exports:{}}),f.exports);function y(t){return"\n\n   ______________________________    . \\  | / .\n  /                            / \\     \\ \\ / /\n |                            | ==========  - -\n  \\____________________________\\_/     / / \\ \\\n  ______________________________      \\  | / | \\\n /                            / \\     \\ \\ / /.   .\n|                            | ==========  - -\n \\____________________________\\_/     / / \\ \\    /\n   ______________________________   / |\\  | /  .\n  /                            / \\     \\ \\ / /\n |                            | ==========  -  - -\n  \\____________________________\\_/     / / \\ \\\n                                     .  / | \\  .\n\n  Are you trying to wreak havoc on the Universe!?!\n\n  "+t+"\n\n  Idiot.\n\n  "}function g(t){return 149597870700*t}var m,v,w,b=function(){var t=document.createElement("style");t.innerHTML='\n    @keyframes sbn-solar-system-viewer-fade-in {\n      from { opacity: 0; }\n      to   { opacity: 1; }\n    }\n\n    @keyframes sbn-solar-system-viewer-loader-spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n\n    .sbn-solar-system-viewer-input:focus{\n        outline-width: 0;\n    }\n\n    /**\n     *\n     * This is for styling the switches\n     *\n     */\n    .switch-text-container {\n      width: 100%;\n      height: 34px;\n      display: flex;\n      white-space: nowrap;\n    }\n\n    .switch-text-container > * {\n        flex: 1;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n    }\n\n    .switch-text-container .switch {\n      position: relative;\n      display: inline-block;\n      width: 60px;\n      height: 34px;\n    }\n\n    /* Hide default HTML checkbox */\n    .switch-text-container .switch input {\n      opacity: 0;\n      width: 0;\n      height: 0;\n    }\n\n    /* The slider */\n    .switch-text-container .slider {\n      position: absolute;\n      cursor: pointer;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: #ccc;\n      background-color: red;\n      -webkit-transition: .4s;\n      transition: .4s;\n    }\n\n    .switch-text-container .slider:before {\n      position: absolute;\n      content: "";\n      height: 26px;\n      width: 26px;\n      left: 4px;\n      bottom: 4px;\n      background-color: white;\n      -webkit-transition: .4s;\n      transition: .4s;\n    }\n\n    .switch-text-container input:checked + .slider {\n      background-color: #2196F3;\n      background-color: blue;\n    }\n\n    .switch-text-container input:focus + .slider {\n      box-shadow: 0 0 1px #2196F3;\n    }\n\n    .switch-text-container input:checked + .slider:before {\n      -webkit-transform: translateX(26px);\n      -ms-transform: translateX(26px);\n      transform: translateX(26px);\n    }\n  ',document.head.append(t)},E="loader-div-id"+r.v4(),P=!1,S=function(){for(var t,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];(t=console).log.apply(t,[" >>> ",+new Date-+At()," >>> "].concat(n))},T=g(1e-5),L=g(3e3),x=function(){function t(t){var n=this;if(this._containerId=t,this._scene=new e.Scene,this._canvas=document.createElement("canvas"),this._clock=new e.Clock(!1),this._initialViewingVector=new e.Vector3,this._isSceneReady=!1,this._isRendering=!1,this._isHelpersShown=!1,this._isInit=!1,this._isLoaderVisible=!0,this._fps=60,this._camera=new e.PerspectiveCamera(60,2,T,L),this._sceneEntities=[],this._preInitHook=function(){},this._postInitHook=function(){},this._destroyHook=function(){},this.updateCamera=function(){},this.registerSceneEntities=function(t){t.forEach((function(t){return n._sceneEntities.push(t)}))},this.setHelpersVisibility=function(t){n._isHelpersShown=!!t,n._scene.traverse((function(t){return t.userData.isHelper&&(t.visible=n._isHelpersShown)}))},this.toggleHelpersVisibility=function(){n._isHelpersShown=!n._isHelpersShown,n.setHelpersVisibility(n._isHelpersShown)},this._updateCameraAspect=function(){n._canvas.style.width="100%",n._canvas.style.height="100%";var t=n._canvas.offsetWidth||1,e=n._canvas.offsetHeight||1;n._camera.aspect=t/e,n._camera.updateProjectionMatrix(),n._renderer.setSize(t,e)},this.destroy=function(){window.removeEventListener("resize",n._updateCameraAspect),n._stopRendering(),n._destroyHook()},this._render=function(){n._isRendering&&setTimeout((function(){n._requestAnimationFrameId=requestAnimationFrame(n._render),n._update()}),1e3/n._fps)},this._startRendering=function(){S("Starting animation..."),n._isRendering=!0,n._clock.start(),n._render()},this._stopRendering=function(){S("Stopping animation..."),n._isRendering=!1,n._clock.stop()},this._container=document.getElementById(this._containerId),!this._container)throw new Error("No container found with id: "+this._containerId);this._canvas.style.width="100%",this._canvas.style.height="100%",this._container.append(this._canvas),this._container.style.setProperty("position","relative"),this._container.style.setProperty("background-color","black"),function(t){if(!P){P=!0,b();var e=document.createElement("div"),n=document.createElement("div");t.append(e),e.append(n),e.id=E,e.style.setProperty("position","absolute"),e.style.setProperty("top","0px"),e.style.setProperty("left","0px"),e.style.setProperty("bottom","0px"),e.style.setProperty("right","0px"),e.style.setProperty("display","flex"),e.style.setProperty("align-items","center"),e.style.setProperty("justify-content","center"),e.style.setProperty("pointer-events","none");var r=e.offsetWidth,i=e.offsetHeight,o=r<i?r:i;n.style.setProperty("width",.25*o+"px"),n.style.setProperty("height",.25*o+"px"),n.style.setProperty("border","5px solid #f3f3f3"),n.style.setProperty("border-top","5px solid #3498db"),n.style.setProperty("border-radius","100px"),n.style.setProperty("animation","sbn-solar-system-viewer-loader-spin 2000ms linear infinite")}}(this._container)}var r=t.prototype;return r.init=function(){var t=h(_.mark((function t(){var r,i=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._isInit){t.next=2;break}return t.abrupt("return");case 2:if(this._isInit=!0,xt(new Date),this._preInitHook(),window.addEventListener("resize",this._updateCameraAspect),r=window.devicePixelRatio?window.devicePixelRatio:1,this._renderer=new e.WebGLRenderer({canvas:this._canvas,antialias:!0,alpha:!0}),this._renderer.setPixelRatio(r),this._renderer.sortObjects=!1,this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=e.PCFSoftShadowMap,this._renderer.outputEncoding=e.GammaEncoding,this._camera.position.copy(this._initialViewingVector),this._camera.up=new e.Vector3(0,0,1),this._camera.lookAt(0,0,0),this._controls=new n.OrbitControls(this._camera,this._renderer.domElement),this._controls.enableDamping=!0,this._controls.dampingFactor=.25,this._controls.target=new e.Vector3,this._sceneEntities.length){t.next=22;break}throw new Error(y("You have no scene entities!"));case 22:return t.next=24,Promise.all(this._sceneEntities.map(function(){var t=h(_.mark((function t(e){var n;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:if((n=t.sent)&&n.children.length){t.next=5;break}throw new Error(y('\n            -----------------------------------------------------------------------------\n            The scene entity "'+e.constructor.name+'" has empty sceneEntityGroup\n            after initialization!!!\n            -----------------------------------------------------------------------------\n            '));case 5:return t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())).then((function(t){return new Promise((function(e){return setTimeout((function(){return e(t)}),100)}))})).then((function(t){return t}));case 24:t.sent.forEach((function(t){return i._scene.add(t)})),this.setHelpersVisibility(!1),this._updateCameraAspect(),this._startRendering(),this._postInitHook(),this.setIsLoaderDivVisible(!1),S("Finished initiating scene.");case 32:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.setIsLoaderDivVisible=function(t,e){void 0===e&&(e=3e3),this._isLoaderVisible=t,function(t,e){void 0===e&&(e=3e3);var n=document.getElementById(E);null==n||n.style.setProperty("transition","opacity "+e+"ms ease-in-out"),null==n||n.style.setProperty("opacity",""+(t?1:0))}(this._isLoaderVisible,e)},r.setFramesPerSecond=function(t){t<=0||t>100||(this._fps=t)},r._update=function(){var t=this;if(this._sceneEntities.forEach((function(e){return e.update(t._camera,t._clock.elapsedTime)})),this.updateCamera(),!this._camera||!this._renderer)throw new Error("Poor Logic");this._requestAnimationFrameId&&this._renderer.render(this._scene,this._camera)},t}(),A=function(t,n){return new Promise((function(r,i){(new e.TextureLoader).load(t,(function(t){t.encoding=e.GammaEncoding,setTimeout((function(){return r(t)}),5)}),(function(t){return console.log(n+" "+t.loaded/t.total*100+"%")}),(function(){console.log("Failed to load: ",t),i(new Error("Failed to load: "+t))}))}))};!function(t){t[t.BEFORE_ANIMATION=0]="BEFORE_ANIMATION",t[t.INTERRUPT_ANIMATION=1]="INTERRUPT_ANIMATION",t[t.__LENGTH__=2]="__LENGTH__"}(m||(m={})),function(t){t[t.TOY_REPRESENTATION=0]="TOY_REPRESENTATION",t[t.REAL_WORLD=1]="REAL_WORLD",t[t.__LENGTH__=2]="__LENGTH__"}(v||(v={})),function(t){t[t.WAIT_TILL_LOADED_THEN_START_ANIMATION=0]="WAIT_TILL_LOADED_THEN_START_ANIMATION",t[t.START_ANIMATION_THEN_LOAD_PLANET_ASYNC=1]="START_ANIMATION_THEN_LOAD_PLANET_ASYNC",t[t.__LENGTH__=2]="__LENGTH__"}(w||(w={}));var I,O,M={__sbnViewer__planetLoadingMode:w.WAIT_TILL_LOADED_THEN_START_ANIMATION,__sbnViewer__cometAsteroidLoadingMode:m.BEFORE_ANIMATION,__sbnViewer__cometAsteroidAbundanceRepresentationMode:v.TOY_REPRESENTATION};I=Object.keys(M),O=p({},localStorage),Object.keys(O).forEach((function(t){I.includes(t)||localStorage.removeItem(t)})),I.forEach((function(t){var e=localStorage.getItem(t);if(e)try{typeof JSON.parse(e)!=typeof M[t]&&localStorage.setItem(t,JSON.stringify(M[t]))}catch(t){return void console.log("Local-storage mishap")}else localStorage.setItem(t,JSON.stringify(M[t]))}));var k=function(){var t=Object.keys(M),e={};return t.forEach((function(t){var n=localStorage.getItem(t);if(console.log("key, val",t,n),n)try{var r=JSON.parse(n);console.log("key, parsedVal",t,r),e[t]=r}catch(t){return}})),console.log("optionsFromLocalStorage",e),p({},M,e)},N=function t(){var n=this;this._isAsyncLoad=function(){return t._isAsyncLoad},this._sceneEntityGroup=new e.Group,this.getSceneEntityGroup=function(){return n._sceneEntityGroup}};N._isAsyncLoad=k().__sbnViewer__planetLoadingMode===w.START_ANIMATION_THEN_LOAD_PLANET_ASYNC;var R=function(t){function n(n){var r;return(r=t.call(this)||this)._toyScale=n,r._toyGroup=[],r._realScale=1,r._isZoomToToyScale=!1,r.isLogScale=!1,r.logTransitionClock=new e.Clock,r}d(n,t);var r=n.prototype;return r.setIsZoomToToyScale=function(t){this._isZoomToToyScale=t},r.setToyScale=function(t){this._toyScale=t},r.getScale=function(){return this._isZoomToToyScale?this._toyScale:this._realScale},r._setToToyScale=function(){var t=this;this._isZoomToToyScale=!0,this._toyGroup.forEach((function(e){var n=t._toyScale;e.scale.set(n,n,n)}))},r.setIsLogScale=function(t){this.isLogScale=t,this.logTransitionClock=new e.Clock(!0),this.logTransitionClock.start(),this.setToyScale(this.isLogScale?1e3:3e3)},r.toggleIsLogScale=function(){this.setIsLogScale(!this.isLogScale)},r.getLogInterpolationParam=function(){var t=this.logTransitionClock.getElapsedTime()/2,e=t<1?t:1;return this.isLogScale?e:1-e},r._updateModelScale=function(){var t=this;this._toyGroup.forEach((function(e){var n=t._isZoomToToyScale?t._toyScale:t._realScale,r=e.scale,i=r.x,o=r.y,a=r.z;if(i!==n){var s=t._toyScale/20;i<n&&e.scale.set(i+s,o+s,a+s),i>n&&e.scale.set(i-s,o-s,a-s),Math.abs(i-n)<s&&e.scale.set(n,n,n)}}))},n}(N),G=C();function C(){return"https://sbn-solar-system-viewer.s3.amazonaws.com"}var V,H=g(1),D=function(t){function n(){var n;return(n=t.call(this,30)||this).NAME="SUN",n.position=new e.Vector3(0,0,0),n.sunRadiusMeters=696342e3,n.model=new e.Group,n.sprite=new e.Sprite(new e.SpriteMaterial({blending:e.AdditiveBlending,transparent:!0,visible:!1})),n.getRadius=function(){return n.sunRadiusMeters},n.getPosition=function(){return n.position},n.sprite.scale.multiplyScalar(20*n.sunRadiusMeters),n.model.add(n.sprite),n.helper=new e.LineSegments(new e.EdgesGeometry(new e.SphereGeometry(n.sunRadiusMeters,32)),new e.LineBasicMaterial({color:new e.Color("cyan")})),n.helper.userData.isHelper=!0,n.helper.rotateX(Math.PI/2),n.model.add(n.helper),n}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var e=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=h(_.mark((function t(n){var r,i;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=G+"/stars/sun3-sprite-512.png",i=function(t){e.sprite.material.map=t,e.sprite.material.needsUpdate=!0,e.sprite.material.visible=!0},!e._isAsyncLoad()){t.next=6;break}A(r,"SUN SPRITE IMAGE").then(i).catch((function(t){return null})),t.next=11;break;case 6:return t.t0=i,t.next=9,A(r).catch((function(t){return null}));case 9:t.t1=t.sent,(0,t.t0)(t.t1);case 11:e._toyGroup.push(e.model),e._sceneEntityGroup.name=e.NAME,e._sceneEntityGroup.add(e.model),S("RESOLVED SUN"),n(e._sceneEntityGroup);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.update=function(){this._updateModelScale()},n}(R),z=function(t){function n(n){var r;return(r=t.call(this)||this).NAME="STARFIELD",r.texture=null,r.invertColor=function(){r.texture&&(r.texture=function(t,n){void 0===n&&(n=!1);var r=t.image,i=document.createElement("canvas"),o=r.width,a=r.height;i.width=o,i.height=a;var s=i.getContext("2d");s.drawImage(r,0,0);for(var c=s.getImageData(0,0,o,a),l=0,u=0;l<a;l++)for(var h=0;h<o;h++,u+=4)c.data[u+0]=255-c.data[u+0],c.data[u+1]=255-c.data[u+1],c.data[u+2]=255-c.data[u+2],n&&(c.data[u+3]=255-c.data[u+3]);return s.putImageData(c,0,0),new e.CanvasTexture(i)}(r.texture),r.material.map=r.texture,r.material.needsUpdate=!0)},r.material=new e.MeshPhongMaterial({side:e.DoubleSide,transparent:!0,color:"black",opacity:1,shininess:0}),r.mesh=new e.Mesh(new e.SphereGeometry(n,32,32),r.material),r.mesh.rotation.y=Math.PI/2,r._sceneEntityGroup.name="STARFIELD",r}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var n=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=h(_.mark((function t(r){var i;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=G+"/stars/galaxy-starfield-4096.jpg",!n._isAsyncLoad()){t.next=5;break}A(i,"star-field").then((function(t){n.texture=t,t.encoding=e.GammaEncoding,n.material.map=t,n.material.needsUpdate=!0})),t.next=11;break;case 5:return t.next=7,A(i,"star-field");case 7:n.texture=t.sent,n.material.map=n.texture,n.material.color=new e.Color,n.material.needsUpdate=!0;case 11:n._sceneEntityGroup.add(n.mesh),console.log("Starfield resolved",+new Date-+At()),r(n._sceneEntityGroup);case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.update=function(){},n}(N),B=function(t){function n(){var e;return(e=t.apply(this,arguments)||this).NAME="Misc Helpers",e.update=function(){},e}return d(n,t),n.prototype.init=function(){var t=h(_.mark((function t(){var n=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){var r=new e.AxesHelper(g(100));r.userData.isHelper=!0,n._sceneEntityGroup.add(r),t(n._sceneEntityGroup)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),n}(N),j=function(t){function n(e){var n;return void 0===e&&(e=.3),(n=t.call(this)||this)._defaultIntensity=e,n.NAME="Simple Light",n.setPower=function(t){n._light.intensity=t||n._defaultIntensity},n.update=function(){},n}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var n=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){n._light=new e.AmbientLight(3355443,n._defaultIntensity),n._light.userData.isAmbientLight=!0,n._sceneEntityGroup.add(n._light),t(n._sceneEntityGroup)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.setIsOn=function(t){this._light.visible=t},n}(N);!function(t){t.PLANET="PLANET",t.DWARF_PLANET="DWARF_PLANET",t.SUN="SUN",t.ASTEROID="ASTEROID"}(V||(V={}));var X=new Set(["a","e","i","q","epoch","period","tp","ma","n","L","om","w","wBar","GM"]),U=new Set(["i","ma","n","L","om","w","wBar"]);function F(t){return void 0!==t}var K=function(){function t(t,e,n){var r=this;void 0===e&&(e="rad"),void 0===n&&(n=!1),this._locked=!1,this._attrs=p({},t),this._locked=!1,t&&Object.keys(t).forEach((function(n){var i=U.has(n)?e:void 0,o=t[n];o&&r.set(n,o,i)})),void 0===this._attrs.GM&&(this._attrs.GM=Y.SUN),this.fill(),this.get("e")>.9&&void 0===this.get("tp")&&console.warn('You must specify "tp" (time of perihelion) for highly eccentric orbits'),this._locked=n}var e=t.prototype;return e.set=function(t,e,n){if(void 0===n&&(n="rad"),this._locked)throw new Error("Attempted to modify locked (immutable) Ephem object");return X.has(t)?(this._attrs[t]="deg"===n?e*Math.PI/180:e,!0):(console.warn("Invalid ephem attr: "+t),!1)},e.get=function(t,e){void 0===e&&(e="rad");var n=this._attrs[t];return"deg"===e?180*n/Math.PI:n},e.fill=function(){var t=this.get("e");if(!F(t))throw new Error('Must define eccentricity "e" in an orbit');var e=this.get("a"),n=this.get("q");if(F(e)){if(!F(n)){if(t>=1)throw new Error('Must provide perihelion distance "q" if eccentricity "e" is greater than 1');this.set("q",n=e*(1-t))}}else{if(!F(n))throw new Error('Must define semimajor axis "a" or perihelion distance "q" in an orbit');this.set("a",e=n/(1-t))}var r=this.get("w"),i=this.get("wBar"),o=this.get("om");F(r)&&F(o)&&!F(i)?this.set("wBar",i=r+o):F(i)&&F(o)&&!F(r)?this.set("w",r=i-o):F(r)&&F(i)&&!F(o)&&this.set("om",o=i-r);var a=149597870700*e,s=this.get("n"),c=this.get("GM"),l=this.get("period");if(!F(l)&&F(e)&&(l=2*Math.PI*Math.sqrt(a*a*a/c)/86400,this.set("period",l)),t<1)if(F(l)&&!F(s)){var u=2*Math.PI/l;this.set("n",u)}else F(s)&&!F(l)&&this.set("period",2*Math.PI/s);var h=this.get("ma"),p=this.get("L");!F(p)&&F(o)&&F(r)&&F(h)&&this.set("L",p=o+r+h),F(h)||this.set("ma",p-i)},e.lock=function(){this._locked=!0},e.copy=function(){return new t({GM:this.get("GM"),epoch:this.get("epoch"),a:this.get("a"),e:this.get("e"),i:this.get("i"),om:this.get("om"),ma:this.get("ma"),w:this.get("w")},"rad")},t}(),Y={SUN:0x731c14d13d71fc000,MERCURY:22031780000000.02,VENUS:324858592000000.06,EARTH_MOON:403503235502259.8,MARS:42828375214000.02,JUPITER:0x1c22c96966960d0,SATURN:379405852e8,URANUS:5794548600000008,NEPTUNE:6836527100580024,PLUTO_CHARON:977000000000.0007},Z={MERCURY:new K({epoch:2458426.5,a:.3870968969437096,e:.2056515875393916,i:7.003891682749818,om:48.30774804443502,w:29.17940253442659,ma:256.190975209273},"deg",!0),VENUS:new K({epoch:2458426.5,a:.7233458663591554,e:.006762510759617694,i:3.394567787211735,om:76.62534150657346,w:54.74567447560867,ma:275.6687596099721},"deg",!0),EARTH:new K({epoch:2451545,a:1.00000261,e:.01671123,i:-1531e-8,om:0,wBar:102.93768193,L:100.46457166},"deg",!0),MOON:new K({GM:398600,epoch:2458621.5,a:.002582517063772124,e:.04582543645168888,i:5.102060246928811,om:108.5916732144811,w:61.80561793729225,ma:50.53270083636792},"deg",!0),MARS:new K({epoch:2458426.5,a:1.52371401537107,e:.09336741335309606,i:1.848141099825311,om:49.50420572080223,w:286.6965847685386,ma:25.38237617924876},"deg",!0),CERES:new K({epoch:2459200.5,a:2.7660891,e:.0781685,i:10.5879,om:80.27236,w:73.72487,ma:205.54542},"deg",!0),JUPITER:new K({epoch:2458426.5,a:5.20180355911023,e:.0489912558249006,i:1.303560894624275,om:100.5203828847816,w:273.736301845404,ma:231.939544389401},"deg",!0),SATURN:new K({epoch:2458426.5,a:9.577177295536776,e:.05101889921719987,i:2.482782449972317,om:113.6154964073247,w:339.4422648650336,ma:187.0970898012944},"deg",!0),URANUS:new K({epoch:2458426.5,a:19.14496966635462,e:.04832662948112808,i:.7697511134483724,om:74.14239045667875,w:99.42704504702185,ma:220.2603033874267},"deg",!0),NEPTUNE:new K({epoch:2458426.5,a:30.0962226342805,e:.00736257118719377,i:1.774569249829094,om:131.8695882492132,w:258.6226409499831,ma:315.2804988924479},"deg",!0),PLUTO:new K({epoch:2454000.5,a:39.4450697257,e:.250248713478,i:17.0890009196,om:110.376957955,w:112.597141677,ma:25.2471897122},"deg",!0),HAUMEA:new K({epoch:2459200.5,a:43.116,e:.19642,i:28.2137,om:122.167,w:239.041,ma:218.205},"deg",!0),MAKEMAKE:new K({epoch:2458900.5,a:45.43,e:.16126,i:28.9835,om:79.62,w:294.834,ma:165.514},"deg",!0),ERIS:new K({epoch:2459000.5,a:67.864,e:.43607,i:44.04,om:35.951,w:151.639,ma:205.989},"deg",!0)};function q(t,e,n){return[1*t,1*e,1*n]}function W(t,e,n,r,i,o){if(void 0===t)throw"data object is undefined";if(!Array.isArray(t))throw"data object must be an array";if(n>=r)throw"first row must be greater than last row";if(n<0)throw"first row must be greater than zero";if(r>t.length-1)throw"last row must be ";if(!Array.isArray(t[n]))throw"data in rows must be array data";var a=t[0].length-1;if(i<0||i>a)throw"xIndex has to be between 0 and "+a+": "+i;if(o<0||o>a)throw"yIndex has to be between 0 and "+a+": "+o;for(var s=0,c=n;c<=r;c++){for(var l=1,u=n;u<=r;u++)u!==c&&(l*=(e-t[u][i])/(t[c][i]-t[u][i]));s+=l*t[c][o]}return s}var J,Q=function(t,e){return t-e},$=function(t,e){return t[0]-e},tt={distance:"au",time:"day"},et=new Set(["km","au"]),nt=new Set(["cartesianposvel"]),rt=new Set(["lagrange"]),it=new Set(["day","sec"]),ot=function(){function t(t){if(this._units=p({},tt),this._ephemType="cartesianposvel",this._interpolationType="lagrange",this._interpolationOrder=5,!t)throw"EphemerisTable must be initialized with an ephemeris data structure";if(!t.data||!Array.isArray(t.data)||0===t.data.length||!Array.isArray(t.data[0]))throw"EphemerisTable must be initialized with a structure containing an array of arrays of ephemeris data";if(this._data=[].concat(t.data),t.distanceUnits){if(!et.has(t.distanceUnits))throw"Unknown distance units: "+t.distanceUnits;this._units.distance=t.distanceUnits}if(t.timeUnits){if(!it.has(t.timeUnits))throw"Unknown time units: "+t.timeUnits;this._units.time=t.timeUnits}if(t.ephemerisType){if(!nt.has(t.ephemerisType))throw"Unknown ephemeris type: "+t.ephemerisType;this._ephemType=t.ephemerisType}if(t.interpolationType){if(!rt.has(t.interpolationType))throw"Unknown interpolation type: "+t.interpolationType;this._interpolationType=t.interpolationType}if(void 0!==t.interpolationOrder){if(t.interpolationOrder<1||t.interpolationOrder>20)throw"Interpolation order must be >0 and <20: "+t.interpolationOrder;this._interpolationOrder=t.interpolationOrder}if(this._units.distance!==tt.distance||this._units.time!==tt.time){var e=this.calcDistanceMultiplier(this._units.distance),n=this.calcTimeMultiplier(this._units.time);this._data.forEach((function(t){t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e*n,t[5]*=e*n,t[6]*=e*n}))}}var e=t.prototype;return e.getPositionAtTime=function(t){if(t<=this._data[0][0])return[this._data[0][1],this._data[0][2],this._data[0][3]];var e=this._data[this._data.length-1];if(t>=e[0])return[e[1],e[2],e[3]];var n=this.calcBoundingIndices(t),r=n.startIndex,i=n.stopIndex;return[W(this._data,t,r,i,0,1),W(this._data,t,r,i,0,2),W(this._data,t,r,i,0,3)]},e.getPositions=function(t,e,n){if(t>e)throw"Requested start needs to be after requested stop";if(n<=0)throw"Step days needs to be greater than zero";for(var r=[],i=t;i<=e;i+=n)r.push(this.getPositionAtTime(i));return r},e.calcDistanceMultiplier=function(t){switch(t){case"au":return 1;case"km":return 1/149597870.7;default:throw new Error("Unknown distance unit type: "+t)}},e.calcTimeMultiplier=function(t){switch(t){case"day":return 1;case"sec":return 1/86400;default:throw new Error("Unknown time unit type: "+t)}},e.calcBoundingIndices=function(t){var e=Math.floor(this._interpolationOrder/2),n=function(t,e,n){if(void 0===n&&(n=Q),void 0===t)throw"data object is undefined";if(!Array.isArray(t))throw"data object must be an array";if(void 0===e)throw"value object must be defined";if(void 0===n)throw"comparer must be defined";for(var r=0,i=t.length;r<=i;){var o=Math.floor((r+i)/2);if(o===t.length)return o;var a=n(t[o],e);if(a<0)r=o+1;else{if(!(a>0))return o;i=o-1}}return~r}(this._data,t,$);n<0&&(n=~n-1);var r=n-e;r<0&&(r=0);var i=r+Number(this._interpolationOrder);return i>=this._data.length&&(i=this._data.length-1,this._data.length>e&&(r=i-e)),{startIndex:r,stopIndex:i}},t}(),at=Math.sin,st=Math.cos,ct=Math.sqrt;function lt(t){return Math.exp(Math.log(t)/3)}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.PARABOLIC=1]="PARABOLIC",t[t.HYPERBOLIC=2]="HYPERBOLIC",t[t.ELLIPTICAL=3]="ELLIPTICAL",t[t.TABLE=4]="TABLE"}(J||(J={}));var ut=function(){function t(t,e){this._ephem=t,this._orbitStart=0,this._orbitStop=0,this._options=p({color:"white",eclipticLineColor:"cyan"},e,{orbitPathSettings:p({leadDurationYears:10,trailDurationYears:10,numberSamplePoints:360},e.orbitPathSettings)}),this._orbitType=function(t){if(t instanceof ot)return J.TABLE;var e=t.get("e");return e>.9&&e<1.2?J.PARABOLIC:e>1.2?J.HYPERBOLIC:J.ELLIPTICAL}(this._ephem)}var n=t.prototype;return n.getPositionAtTime=function(t,e){switch(void 0===e&&(e=!1),this._orbitType){case J.PARABOLIC:return this.getPositionAtTimeNearParabolic(t,e);case J.HYPERBOLIC:return this.getPositionAtTimeHyperbolic(t,e);case J.ELLIPTICAL:return this.getPositionAtTimeElliptical(t,e);case J.TABLE:return this.getPositionAtTimeTable(t,e)}throw new Error("No handler for this type of orbit")},n.getPositionAtTimeParabolic=function(t,e){var n=this._ephem;if(n instanceof ot)throw new Error("Poor logic allowing table type here");var r=n.get("q"),i=(t-n.get("tp"))*(.01720209895/ct(2))/ct(r*r*r)*1.5,o=ct(1+i*i),a=lt(o+i)-lt(o-i),s=2*Math.atan(a);return this.vectorToHeliocentric(s,r*(1+a*a))},n.getPositionAtTimeNearParabolic=function(t,e){var n=this._ephem;if(n instanceof ot)throw new Error("Poor logic allowing table type here");var r=n.get("e"),i=n.get("q"),o=.75*(t-n.get("tp"))*.01720209895*ct((1+r)/(i*i*i)),a=ct(1+o*o),s=lt(a+o)-lt(a-o),c=(1-r)/(1+r),l=s*s/(1+s*s),u=c*l*l,h=s*(1+c*l*(2/3+.4*s*s+(1.4+33/35*s*s+37/175*Math.pow(s,4))*u+s*s*(432/175+956/1125*s*s+84/1575*Math.pow(s,4))*u*u)),p=2*Math.atan(h);return this.vectorToHeliocentric(p,i*(1+h*h)/(1+h*h*c))},n.getPositionAtTimeHyperbolic=function(t,e){var n=this._ephem;if(n instanceof ot)throw new Error("Poor logic allowing table type here");for(var r=n.get("e"),i=n.get("a"),o=n.get("ma")+n.get("n","rad")*(t-n.get("epoch")),a=o,s=0;s<100;s++){var c=(o+r*(a*Math.cosh(a)-Math.sinh(a)))/(r*Math.cosh(a)-1),l=Math.abs(c-a);if(a=c,l<1e-7)break}var u=a,h=2*Math.atan(ct((r+1)/(r-1)))*Math.tanh(u/2),p=i*(1-r*r)/(1+r*st(h));return this.vectorToHeliocentric(h,p)},n.getPositionAtTimeElliptical=function(t,e){void 0===e&&(e=!1);var n=this._ephem;if(n instanceof ot)throw new Error("Poor logic allowing table type here");var r=n.get("e"),i=n.get("ma","rad"),o=n.get("n","rad"),a=t-n.get("epoch"),s=i+o*a;e&&(console.info("period=",n.get("period")),console.info("n=",o),console.info("ma=",i),console.info("d=",a),console.info("M=",s));for(var c=s,l=0;l<100;l++){var u=s+r*at(c),h=Math.abs(u-c);if(c=u,h<1e-7)break}var p=c,d=2*Math.atan(ct((1+r)/(1-r))*Math.tan(p/2)),f=n.get("a")*(1-r*r)/(1+r*st(d));return this.vectorToHeliocentric(d,f)},n.getPositionAtTimeTable=function(t,e){if(this._ephem instanceof K)throw new Error("Poor logic allowing non-table type here");var n=this._ephem.getPositionAtTime(t);return q(n[0],n[1],n[2])},n.vectorToHeliocentric=function(t,e){var n=this._ephem;if(n instanceof ot)throw new Error("Poor logic allowing table type here");var r=n.get("i","rad"),i=n.get("om","rad"),o=n.get("wBar","rad");return q(e*(st(i)*st(t+o-i)-at(i)*at(t+o-i)*st(r)),e*(at(i)*st(t+o-i)+st(i)*at(t+o-i)*st(r)),e*(at(t+o-i)*at(r)))},n.needsUpdateForTime=function(t){return this._orbitType===J.TABLE&&(t<this._orbitStart||t>this._orbitStop)},n.getOrbitShape=function(t,e){if(void 0===e&&(e=!1),e&&(this._orbitShape&&(this._orbitShape.geometry.dispose(),this._orbitShape.material.dispose()),this._orbitShape=void 0,this._orbitPoints&&this._orbitPoints.dispose(),this._orbitPoints=void 0,this._eclipticDropLines&&(this._eclipticDropLines.geometry.dispose(),this._eclipticDropLines.material.dispose()),this._eclipticDropLines=void 0),this._orbitShape)return this._orbitShape;if(this._orbitType===J.ELLIPTICAL)return this.getEllipse();var n=(this._orbitType===J.TABLE?t:this._ephem.get("tp"))||i.toJulianDay(new Date),r=n-365.25*this._options.orbitPathSettings.trailDurationYears,o=n+365.25*this._options.orbitPathSettings.leadDurationYears,a=(o-r)/this._options.orbitPathSettings.numberSamplePoints;switch(this._orbitStart=r,this._orbitStop=o,this._orbitType){case J.HYPERBOLIC:return this.getLine(this.getPositionAtTimeHyperbolic.bind(this),r,o,a);case J.PARABOLIC:return this.getLine(this.getPositionAtTimeNearParabolic.bind(this),r,o,a);case J.TABLE:return this.getTableOrbit(r,o,a)}throw new Error("Unknown orbit shape")},n.getLine=function(t,n,r,i){for(var o=[],a=n;a<=r;a+=i){var s=t(a);s[0]=g(s[0]),s[1]=g(s[1]),s[2]=g(s[2]),o.push(new e.Vector3(s[0],s[1],s[2]))}var c=new e.BufferGeometry;return c.setFromPoints(o),this.generateAndCacheOrbitShape(c)},n.getTableOrbit=function(t,n,r){if(this._ephem instanceof K)throw new Error("Poor logic allowing non-table type here");var i=this._ephem.getPositions(t,n,r).map((function(t){return[1*(e=t)[0],1*e[1],1*e[2]];var e})).map((function(t){return new e.Vector3(t[0],t[1],t[2])})),o=new e.BufferGeometry;return o.setFromPoints(i),this.generateAndCacheOrbitShape(o)},n.getEllipse=function(){var t=this.getEllipseGeometry();return this.generateAndCacheOrbitShape(t)},n.getEllipseGeometry=function(){var t=this._ephem;if(t instanceof ot)throw new Error("Poor logic allowing table type here");t.get("period");for(var n=t.get("a"),r=t.get("e"),i=2*Math.PI,o=i/90,a=[],s=0;s<i;s+=o){var c=2*Math.atan(ct((1+r)/(1-r))*Math.tan(s/2)),l=n*(1-r*r)/(1+r*st(c)),u=this.vectorToHeliocentric(c,l);(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))&&(console.error("NaN position value - you may have bad or incomplete data in the following ephemeris:"),console.error(t)),a.push(new e.Vector3(g(u[0]),g(u[1]),g(u[2])))}a.push(a[0]);var h=new e.BufferGeometry;return h.setFromPoints(a),h},n.generateAndCacheOrbitShape=function(t){return this._orbitPoints=t,this._orbitShape=new e.Line(t,new e.LineBasicMaterial({color:new e.Color(this._options.color||4473924)})),this._orbitShape},n.getLinesToEcliptic=function(){if(this._eclipticDropLines)return this._eclipticDropLines;this._orbitPoints||this.getOrbitShape();var t=this._orbitPoints,n=new e.BufferGeometry;if(!t)throw new Error("Poor logic letting point be undefined here");return this._eclipticDropLines=new e.LineSegments(n,new e.LineBasicMaterial({color:this._options.eclipticLineColor||3355443,blending:e.AdditiveBlending})),this._eclipticDropLines},n.getHexColor=function(){var t;return null==(t=this._orbitShape)?void 0:t.material.color.getHex()},n.setHexColor=function(t){var n,r;null!=(n=this._orbitShape)&&null!=(r=n.material)&&r.color&&(this._orbitShape.material.color=new e.Color(t))},n.getVisibility=function(){var t;return null==(t=this._orbitShape)?void 0:t.visible},n.setVisibility=function(t){this._orbitShape&&(this._orbitShape.visible=t)},t}();function ht(t){var e=t.length()/H,n=(Math.log10(e)+1)/e,r=t.clone();return r.multiplyScalar(n),r}var pt,dt=g(1),ft=function(){function t(t,n,r,i,o){var a=this;switch(void 0===n&&(n=V.PLANET),void 0===i&&(i="white"),void 0===o&&(o=.7),this.name=t,this.orbitalType=n,this.skephem=r,this.color=i,this.opacity=o,this.loadPlanet=function(){a.SKEph=Z[a.name],a.SKOrbit=new ut(a.SKEph,{color:a.orbitalType===V.PLANET?"white":"pink",eclipticLineColor:void 0,orbitPathSettings:void 0}),a.SKprojectedOrbitLine=a.getMorphedOrbitLine(),a.SKprojectedOrbitLine.material.transparent=!0,a.SKprojectedOrbitLine.material.opacity=a.opacity||1,a.SKprojectedOrbitLine.material.needsUpdate=!0},this.loadAsteroid=function(){a.SKEph=a.skephem||new K({epoch:2458600.5,a:5.38533,e:.19893,i:22.11137,om:294.42992,w:314.2889,ma:229.14238},"deg"),a.SKOrbit=new ut(a.SKEph,{color:"cyan",eclipticLineColor:void 0,orbitPathSettings:void 0}),a.SKprojectedOrbitLine=a.getMorphedOrbitLine(),a.SKprojectedOrbitLine.material.color=new e.Color("cyan"),a.SKprojectedOrbitLine.material.transparent=!0,a.SKprojectedOrbitLine.material.opacity=a.opacity||1,a.SKprojectedOrbitLine.material.needsUpdate=!0},this.getProjectedOrbitLine=function(){return a.SKprojectedOrbitLine},this.orbitalType){case V.ASTEROID:this.loadAsteroid();break;case V.PLANET:case V.DWARF_PLANET:default:this.loadPlanet()}}var n=t.prototype;return n.getMorphedOrbitLine=function(){if(this.orbitLine)return this.orbitLine;if(!this.SKOrbit)throw new Error("Poor logic mi amigo");var t=this.SKOrbit.getEllipseGeometry();t.morphAttributes.position=[];for(var n=t.attributes.position,r=[],i=0;i<n.count;i++){var o=n.getX(i),a=n.getY(i),s=n.getZ(i),c=ht(new e.Vector3(o,a,s));r.push(c.x,c.y,c.z)}return t.morphAttributes.position[0]=new e.Float32BufferAttribute(r,3),this.orbitLine=new e.Line(t,new e.LineBasicMaterial({color:new e.Color(this.color||4473924),morphTargets:!0})),this.orbitLine},n.getXyzMeters=function(t){var e;void 0===t&&(t=0);var n=null==(e=this.SKOrbit)?void 0:e.getPositionAtTime(t);return n?{x:g(n[0]),y:g(n[1]),z:g(n[2])}:{x:0,y:0,z:0}},n.getPosition=function(t){void 0===t&&(t=0);var n=this.getXyzMeters(t);return new e.Vector3(n.x,n.y,n.z)},n.getTail=function(t,n,r){void 0===n&&(n=.3*dt),void 0===r&&(r=0);for(var i=this.getPosition(r),a=ht(i),s=r,c=r,l=0,u=0,h=!0,p=!0;h||p;)p=u<n,(h=l<n)&&(l=i.distanceTo(this.getPosition(s+=.5))),p&&(u=a.distanceTo(ht(this.getPosition(c+=.5))));for(var d=(s-r)/5,f=(c-r)/5,_=t/5,y=[],g=i.clone(),m=a.clone(),v=i.clone(),w=a.clone(),b=t,E=1;E<=5;E++){var P=r+E*f;v=this.getPosition(r+E*d),w=ht(this.getPosition(P));var S=b-_,T=g.distanceTo(v),L=m.distanceTo(w),x=new e.CylinderGeometry(b,S,T,3,1,!1),A=new e.CylinderGeometry(b,S,L,3,1,!1),I=g.x,O=g.y,M=g.z,k=new e.Matrix4;k.makeTranslation(I,O,M),k.lookAt(g,v,new e.Vector3(0,0,1)),x.translate(0,-T/2,0),x.rotateX(Math.PI/2),x.applyMatrix4(k);var N=m.x,R=m.y,G=m.z,C=new e.Matrix4;C.makeTranslation(N,R,G),C.lookAt(m,w,new e.Vector3(0,0,1)),A.translate(0,-L/2,0),A.rotateX(Math.PI/2),A.applyMatrix4(C),y.push({realSegmentGeometry:x,loggedSegmentGeometry:A}),g=v,m=w,b=S}return{realGeometry:o.BufferGeometryUtils.mergeBufferGeometries(y.map((function(t){return t.realSegmentGeometry})),!0),loggedGeometry:o.BufferGeometryUtils.mergeBufferGeometries(y.map((function(t){return t.loggedSegmentGeometry})),!0)}},t}(),_t=function(t,n,r){void 0===n&&(n=.25),void 0===r&&(r=new e.Vector3);for(var i=new e.DodecahedronGeometry(t,1),o=i.getAttribute("position"),a=new e.Vector3,s={},c=0;c<o.count;c++){a.fromBufferAttribute(o,c);var l=[a.x,a.y,a.z].join(",");s[l]||(s[l]={x:a.x+=Math.random()*t*n,y:a.y+=Math.random()*t*n,z:a.z+=Math.random()*t*n});var u=s[l];o.setXYZ(c,u.x,u.y,u.z)}var h=.5+Math.random(),p=.5+Math.random(),d=.5+Math.random();i.scale(h,p,d);var f=i.clone(),_=ht(r);return i.translate(r.x,r.y,r.z),f.translate(_.x,_.y,_.z),{realGeometry:i,loggedGeometry:f}},yt=function(t){function n(n,r){var i;return void 0===r&&(r=1e4),(i=t.call(this,3e6)||this).NAME=n,i.radius=r,i.model=new e.Group,i.getPosition=function(){var t=i.orbit.getXyzMeters();return new e.Vector3(t.x,t.y,t.z)},i.getRadius=function(){return i.radius},i.getOrbit=function(){return i.orbit},i.setIsOrbitVisible=function(t){i.SKprojectedOrbitLine.visible=t},i.orbit=new ft(n,V.ASTEROID),i.SKprojectedOrbitLine=i.orbit.getMorphedOrbitLine(),i._sceneEntityGroup.add(i.SKprojectedOrbitLine),i}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var n=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=h(_.mark((function t(r){var i,o,a;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=G+"/misc/asteroid-texture-1024.jpg",o=_t(n.radius),t.t0=e.Mesh,t.t1=o.realGeometry,t.t2=e.MeshPhongMaterial,t.next=7,A(i);case 7:t.t3=t.sent,t.t4={map:t.t3,shininess:0},t.t5=new t.t2(t.t4),a=new t.t0(t.t1,t.t5),n.model.add(a),n._toyGroup.push(n.model),n._sceneEntityGroup.add(n.model),r(n._sceneEntityGroup);case 15:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.updateOrbitLine=function(){var t=this.getLogInterpolationParam();this.SKprojectedOrbitLine.morphTargetInfluences[0]=t},r.getDestinationPosition=function(t){void 0===t&&(t=0);var e=this.getLogInterpolationParam(),n=this.orbit.getPosition(t),r=ht(n);return n.lerp(r,e)},r.update=function(){var t=this.getDestinationPosition();this.model.position.set(t.x,t.y,t.z),this.updateOrbitLine(),this._updateModelScale()},n}(R),gt=function(t){function n(e,n){var r;return void 0===e&&(e=.3),void 0===n&&(n=1),(r=t.call(this)||this)._defaultIntensity=e,r._radius=n,r.NAME="Point Light",r.setPower=function(t){r._light.intensity=t||r._defaultIntensity},r.update=function(){},r}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var n=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){n._light=new e.PointLight(3355443,n._defaultIntensity);var r=new e.PointLightHelper(n._light,n._radius,new e.Color("red"));r.userData.isHelper=!0,n._sceneEntityGroup.add(n._light),n._sceneEntityGroup.add(r),t(n._sceneEntityGroup)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.setIsOn=function(t){this._light.visible=t},n}(N),mt=.1*H,vt=function(t){function n(n,r){var i;void 0===n&&(n="BIRDSEYE"),void 0===r&&(r=30),(i=t.call(this,1)||this).NAME=n,i.token=new e.Object3D,i.position=new e.Vector3(mt,mt,30*H),i.getPosition=function(){return i.token.position},i.getRadius=function(){return 1},i.position.setZ(r*H);var o=i.position;return i.token.position.set(o.x,o.y,o.z),i._sceneEntityGroup.add(i.token),i}d(n,t);var r=n.prototype;return r.init=function(){var t=h(_.mark((function t(){var e=this;return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=h(_.mark((function t(n){return _.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n(e._sceneEntityGroup);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),r.update=function(){},n}(R),wt=function(t){return t instanceof vt?new e.Vector3(0,0,0):t.getPosition()},bt={FiPhone:a.FiPhone,AiOutlineSetting:s.AiOutlineSetting,IoIosSettings:c.IoIosSettings},Et=function(t,e,n,r,i){void 0===i&&(i=("switch_created_"+(new Date).toISOString()).replace(/\s+/g,"")),b();var o=document.createElement("div");o.classList.add("switch-text-container"),o.style.setProperty("overflow-x","scroll"),o.id=i;var a=document.createElement("div");a.classList.add("title-text"),a.style.setProperty("justify-content","right"),a.style.setProperty("flex","1 0 220px"),a.style.setProperty("margin-right","10px"),a.style.setProperty("overflow-x","scroll"),a.innerHTML="<span>"+t+"</span>",o.append(a);var s=document.createElement("div");s.classList.add("switch-container"),s.style.setProperty("flex","0 0 70px"),o.append(s);var c=document.createElement("div");c.classList.add("on-off-text"),c.style.setProperty("justify-content","left"),c.style.setProperty("flex","1 0 calc(100% - 70px - 220px - 5px)"),c.style.setProperty("margin-left","10px"),c.innerHTML=" "+e+" ",o.append(c);var l=document.createElement("label");l.classList.add("switch"),s.append(l);var u=document.createElement("input");u.type="checkbox",u.checked=!1,l.append(u);var h=document.createElement("span");return h.classList.add("slider"),l.append(h),u.addEventListener("click",(function(){setTimeout((function(){r(),c.innerHTML=""+(u.checked?e:n)}),0)})),o},Pt=function(t){Object.keys(t).forEach((function(e){console.log("Key Value:",e,t[e]),localStorage.setItem(e,JSON.stringify(t[e]))}))},St="settings-panel-id-"+r.v4(),Tt=!1,Lt=function(t){function n(n){var r;return(r=t.call(this,n)||this).sun=new D,r.isToyScale=!0,r.isOrbitsVisible=!0,r.isLogScale=!1,r.logScalables=[],r.zoomables=[],r.zoomableOrbitals=[],r.zoomTarget=r.sun,r.isZoomingPosition=!1,r.isZoomingAngle=!1,r.zoomTraversalFraction=0,r.zoomClock=new e.Clock,r.isScenePaused=!1,r.updateMessageField=function(){console.log("denied!")},r.setIsToyScale=function(t){r.isToyScale=!!t,r.toyScalables.forEach((function(t){return t.setIsZoomToToyScale(r.isToyScale)}))},r.toggleIsToyScale=function(){r.isToyScale=!r.isToyScale,r.setIsToyScale(r.isToyScale)},r.setIsOrbitsVisible=function(t){r.isOrbitsVisible=!!t,r.zoomableOrbitals.forEach((function(t){return t instanceof yt||t.setIsOrbitVisible(r.isOrbitsVisible)}))},r.toggleIsOrbitsVisible=function(){r.isOrbitsVisible=!r.isOrbitsVisible,r.setIsOrbitsVisible(r.isOrbitsVisible)},r.toggleAsteroids=function(){r.asteroidBelts.forEach((function(t){return t.toggleIsBeltVisible()}))},r.setIsLogScale=function(t){r.isLogScale=!!t,r.logScalables.forEach((function(t){return t.toggleIsLogScale()})),r.tryToStartZooming(r.isLogScale?"BIRDSEYELOG":"BIRDSEYE")},r.toggleIsLogScale=function(){r.isLogScale=!r.isLogScale,r.setIsLogScale(r.isLogScale)},r.tryToStartZooming=function(t){var n=t.toUpperCase(),i=r.zoomables.find((function(t){return t.NAME===n}));i&&(r.isZoomingPosition=!0,r.isZoomingAngle=!0,r.zoomTarget=i,r.zoomClock=new e.Clock(!0),r._controls.enabled=!0)},r.tryToStopZooming=function(){r.isZoomingAngle||r.isZoomingPosition||(r._controls.target=r.zoomTarget instanceof vt?new e.Vector3(0,0,0):r.zoomTarget.getPosition(),r._controls.enabled=!0)},r.updateCamera=function(){var t,n,i,o,a,s,c,l,u,h,p,d,f,_;if(r._clock.getElapsedTime(),r.isZoomingPosition||r.isZoomingAngle){if(r.zoomTraversalFraction=((n=(t=r.zoomClock.getElapsedTime())*t*t*.01)<0&&(n=0),n>1&&(n=1),n),r.isZoomingPosition&&(r.isZoomingPosition=(a=r._camera,s=r.zoomTraversalFraction,c=function(t){var n=t.getScale(),r=t.getRadius();if("SUN"===t.NAME){var i=t.getPosition();return new e.Vector3(i.x+3*r*n,i.y+3*r*n,i.z)}if(t instanceof vt)return t.getPosition();var o=t.getPosition().clone(),a=2*r*n/o.length(),s=Math.asin(a);o.applyAxisAngle(new e.Vector3(0,0,1),s);var c=(o.length()+4*r*n)/o.length();return o.multiplyScalar(c),o}(r.zoomTarget),d=new e.Vector3((l=c.x)-(p=a.position).x,(u=c.y)-p.y,(h=c.z)-p.z),_=!0,(i=f=new e.Vector3(p.x+d.x*s,p.y+d.y*s,p.z+d.z*s),o=new e.Vector3(l,u,h),new e.Vector3(o.x-i.x,o.y-i.y,o.z-i.z)).length()<1e-4*H&&(_=!1,f=new e.Vector3(l,u,h)),a.position.set(f.x,f.y,f.z),_)),r.isZoomingAngle)r.isZoomingAngle=function(t,n,r){var i=t.position,o=wt(n),a=new e.Vector3(o.x-i.x,o.y-i.y,o.z-i.z),s=t.getWorldDirection(new e.Vector3);s.multiplyScalar(a.length());var c=new e.Vector3(a.x-s.x,a.y-s.y,a.z-s.z),l=new e.Vector3(t.position.x+s.x+c.x*r,t.position.y+s.y+c.y*r,t.position.z+s.z+c.z*r),u=!0;return a.angleTo(s)<.0025&&(u=!1,l=o),t.lookAt(l.x,l.y,l.z),u}(r._camera,r.zoomTarget,r.zoomTraversalFraction);else{var y=wt(r.zoomTarget);r._camera.lookAt(y.x,y.y,y.z)}r.tryToStopZooming()}else r._controls.update()},r.updateMessageField=function(t){b();var e=document.createElement("div");return e.id="message-field",e.style.setProperty("position","absolute"),e.style.setProperty("left","50%"),e.style.setProperty("right","0px"),e.style.setProperty("bottom","0px"),e.style.setProperty("height","40px"),e.style.setProperty("display","flex"),e.style.setProperty("justify-content","flex-end"),e.style.setProperty("align-items","center"),e.style.setProperty("background-color","green"),t.append(e),function(t){e.innerHTML=t}}(r._container),r.updateMessageField("Working?"),function(t,e){b();var n=document.createElement("div"),r=document.createElement("input");n.style.setProperty("position","absolute"),n.style.setProperty("top","10px"),n.style.setProperty("left","10px"),n.style.setProperty("width","120px"),n.style.setProperty("height","40px"),n.style.setProperty("background-color","green"),r.value="Ceres",r.style.setProperty("width","100%"),r.style.setProperty("height","100%"),r.style.setProperty("font-size","20px"),r.style.setProperty("font-family","'Odibee Sans', cursive"),r.style.setProperty("font-size","20px"),r.classList.add("sbn-solar-system-viewer-input"),r.addEventListener("keypress",(function(t){"Enter"===t.key&&e(r.value)})),n.append(r),t.append(n)}(r._container,r.tryToStartZooming),function(t){if(!t)throw new Error("Canvas Container is Falsy!");var e=document.createElement("div");e.style.setProperty("position","absolute"),e.style.setProperty("top","0px"),e.style.setProperty("right","0px"),e.style.setProperty("height","70px"),e.style.setProperty("width","70px"),e.style.setProperty("display","flex"),e.style.setProperty("justify-content","center"),e.style.setProperty("align-items","center"),e.style.setProperty("z-index","2"),e.innerHTML=function(t,e){void 0===e&&(e={});var n=bt.IoIosSettings({}),r=e.size||20;return'\n    <svg\n      stroke="'+(e.strokeColor||"white")+'"\n      fill="'+(e.fillColor||"none")+'"\n      stroke-width="'+(e.strokeWidth||2)+'"\n      viewBox="'+n.props.attr.viewBox+'"\n      stroke-linecap="round"\n      stroke-linejoin="round"\n      height="'+r+'"\n      width="'+r+'"\n      xmlns="http://www.w3.org/2000/svg"\n    >\n      <path\n        d="'+n.props.children[0].props.d+'"\n      </path>\n    </svg>'}(0,{fillColor:"white",size:70}),e.addEventListener("click",(function(){console.log("Hmmm");var t=document.getElementById(St);t&&(console.log("objecHmmm 2t"),t.style.setProperty("right",(Tt=!Tt)?"100%":"0%"))})),t.append(e)}(r._container),function(t){if(console.log("Adding settings panel?"),b(),!t)throw new Error("Canvas Container is Falsy!");var e=document.createElement("div");e.id=St,e.style.setProperty("position","absolute"),e.style.setProperty("top","0px"),e.style.setProperty("right","100%"),e.style.setProperty("right","0%"),e.style.setProperty("left","0px"),e.style.setProperty("bottom","0px"),e.style.setProperty("transition","right 1s ease-in-out"),e.style.setProperty("overflow","hidden"),e.style.setProperty("background-color","pink"),e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),e.style.setProperty("gap","5px"),e.style.setProperty("justify-content","center"),e.style.setProperty("align-items","center");var n=Et("Planet Loading Mode?","Async (Start Animation Before Planets Are Loaded) XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX  XXX ","Sync (Wait Till Planets Are Loaded)",(function(){Pt({__sbnViewer__planetLoadingMode:(k().__sbnViewer__planetLoadingMode+1)%w.__LENGTH__})}));e.append(n);var r=Et("Comet-Asteroid Loading Mode?","Async (Start Before Loaded)","Sync (Wait Till Loaded)",(function(){Pt({__sbnViewer__cometAsteroidLoadingMode:(k().__sbnViewer__cometAsteroidLoadingMode+1)%m.__LENGTH__})}),"planet-sync");e.append(r);var i=Et("Comet-Asteroid Abundance Representation Mode?","Toy Model","Real World Proportions",(function(){Pt({__sbnViewer__cometAsteroidAbundanceRepresentationMode:(k().__sbnViewer__cometAsteroidAbundanceRepresentationMode+1)%v.__LENGTH__})}),"planet-sync");e.append(i),t.append(e)}(r._container),r.birdsEyes=[new vt,new vt("BIRDSEYELOG",5)],r.planets=[],r.asteroids=[],r.asteroidBelts=[],r.starField=new z(g(999)),r.zoomables=[].concat(r.planets,r.asteroids,r.birdsEyes,[r.sun]),r.zoomableOrbitals=[].concat(r.planets,r.asteroids),r.toyScalables=[].concat(r.planets,r.asteroids,r.asteroidBelts,[r.sun]),r.logScalables=[].concat(r.planets,r.asteroids,r.asteroidBelts),S("Begin registering entities"),r.registerSceneEntities([new B,new j(.4),new gt(5,696342e3)].concat(r.planets,r.asteroids,r.asteroidBelts,[r.sun])),S("Finish registering entities"),r._preInitHook=function(){var t=g(4);r._initialViewingVector=new e.Vector3(0,0,t)},r._postInitHook=function(){r._controls.maxDistance=g(100),r.setHelpersVisibility(!1),r._camera.position.set(35426284497.8745,-725267146538.4939,-111665855099.58893)},setTimeout((function(){r.setIsToyScale(!0),r.tryToStartZooming("BIRDSEYE")}),3500),r._camera.up.set(1,1,1),r._destroyHook=function(){},r}return d(n,t),n.prototype.setIsScenePaused=function(t){this.isScenePaused=t,this.isScenePaused?(this._clock.stop(),this.setIsLoaderDivVisible(!0,0)):(this._clock.start(),this.setIsLoaderDivVisible(!1,0))},n}(x);exports.initDate=new Date;var xt=function(t){return exports.initDate=t},At=function(){return exports.initDate};function It(t){if(void 0===t&&(t="threejs-canvas-container"),!document.getElementById(t))throw new Error("Can't find div of id "+t);(pt=new Lt(t)).init()}function Ot(){pt.destroy()}exports.SbnSolarSystemViewer=function(t){var e=p({width:"100%",height:"100%",backgroundColor:"grey"},t),n=e.width,r=e.height,i=e.backgroundColor,o="this-id-will-never-be-duplicated-says-007";return l.useEffect((function(){return It(o),function(){Ot(),console.log("Widget app removed!!!")}}),[]),l.createElement("div",{id:o,style:{width:n,height:r,backgroundColor:i}})},exports.destroy=Ot,exports.getInitDate=At,exports.init=It,exports.setInitDate=xt;
//# sourceMappingURL=sbnsolarsystemviewer.cjs.production.min.js.map
