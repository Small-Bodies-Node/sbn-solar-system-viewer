"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("three"),r=require("three/examples/jsm/controls/OrbitControls"),n=require("three/examples/jsm/loaders/GLTFLoader"),i=e(require("julian")),o=require("three/examples/jsm/utils/BufferGeometryUtils"),s=e(require("react"));function a(e,t,r,n,i,o,s){try{var a=e[o](s),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function c(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,c,"next",e)}function c(e){a(o,n,i,s,c,"throw",e)}s(void 0)}))}}function l(){return(l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var h,d=(function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=Object.create((t&&t.prototype instanceof p?t:p).prototype),o=new E(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=w(s,r);if(a){if(a===u)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=l(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,o),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var u={};function p(){}function h(){}function d(){}var f={};f[i]=function(){return this};var y=Object.getPrototypeOf,m=y&&y(y(S([])));m&&m!==t&&r.call(m,i)&&(f=m);var g=d.prototype=p.prototype=Object.create(f);function _(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function v(e,t){var n;this._invoke=function(i,o){function s(){return new t((function(n,s){!function n(i,o,s,a){var c=l(e[i],e,o);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(p).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}(i,o,n,s)}))}return n=n?n.then(s,s):s()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return u;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var n=l(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function b(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function P(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(b,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:x}}function x(){return{value:void 0,done:!0}}return h.prototype=g.constructor=d,d.constructor=h,h.displayName=a(d,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,s,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},_(v.prototype),v.prototype[o]=function(){return this},e.AsyncIterator=v,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new v(c(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},_(g),a(g,s,"Generator"),g[i]=function(){return this},g.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(P),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),P(r),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;P(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(h={exports:{}}),h.exports);function f(e){return"\n\n   ______________________________    . \\  | / .\n  /                            / \\     \\ \\ / /\n |                            | ==========  - -\n  \\____________________________\\_/     / / \\ \\\n  ______________________________      \\  | / | \\\n /                            / \\     \\ \\ / /.   .\n|                            | ==========  - -\n \\____________________________\\_/     / / \\ \\    /\n   ______________________________   / |\\  | /  .\n  /                            / \\     \\ \\ / /\n |                            | ==========  -  - -\n  \\____________________________\\_/     / / \\ \\\n                                     .  / | \\  .\n\n  Are you trying to wreak havoc on the Universe!?!\n\n  "+e+"\n\n  Idiot.\n\n  "}function y(e){return 149597870700*e}var m,g,_=0,v=function(){return"sbn-solar-system-viewer-"+ ++_},w="loader-div-id-"+v(),b=!1,P=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];(e=console).log.apply(e,[" >>> ",+new Date-+We()," >>> "].concat(r))},E=y(1e-5),S=y(3e3),x=function(){function e(e){var r=this;if(this._containerId=e,this._scene=new t.Scene,this._canvas=document.createElement("canvas"),this._clock=new t.Clock(!1),this._initialViewingVector=new t.Vector3,this._isSceneReady=!1,this._isRendering=!1,this._isHelpersShown=!1,this._isInit=!1,this._isLoaderVisible=!0,this._fps=60,this._camera=new t.PerspectiveCamera(60,2,E,S),this._sceneEntities=[],this._preInitHook=function(){},this._postInitHook=function(){},this._destroyHook=function(){},this.updateCamera=function(){},this.registerSceneEntities=function(e){e.forEach((function(e){return r._sceneEntities.push(e)}))},this.setHelpersVisibility=function(e){r._isHelpersShown=!!e,r._scene.traverse((function(e){return e.userData.isHelper&&(e.visible=r._isHelpersShown)}))},this.toggleHelpersVisibility=function(){r._isHelpersShown=!r._isHelpersShown,r.setHelpersVisibility(r._isHelpersShown)},this._updateCameraAspect=function(){r._canvas.style.width="100%",r._canvas.style.height="100%";var e=r._canvas.offsetWidth||1,t=r._canvas.offsetHeight||1;r._camera.aspect=e/t,r._camera.updateProjectionMatrix(),r._renderer.setSize(e,t)},this.destroy=function(){window.removeEventListener("resize",r._updateCameraAspect),r._stopRendering(),r._destroyHook()},this._render=function(){r._isRendering&&setTimeout((function(){r._requestAnimationFrameId=requestAnimationFrame(r._render),r._update()}),1e3/r._fps)},this._startRendering=function(){P("Starting animation..."),r._isRendering=!0,r._clock.start(),r._render()},this._stopRendering=function(){P("Stopping animation..."),r._isRendering=!1,r._clock.stop()},this._container=document.getElementById(this._containerId),!this._container)throw new Error("No container found with id: "+this._containerId);this._canvas.style.width="100%",this._canvas.style.height="100%",this._container.append(this._canvas),this._container.style.setProperty("position","relative"),this._container.style.setProperty("font-family",'"Odibee Sans", cursive'),this._container.style.setProperty("background-color","black"),function(e){if(!b){b=!0;var t=document.createElement("div"),r=document.createElement("div");e.append(t),t.append(r),t.id=w,t.style.setProperty("position","absolute"),t.style.setProperty("top","0px"),t.style.setProperty("left","0px"),t.style.setProperty("bottom","0px"),t.style.setProperty("right","0px"),t.style.setProperty("display","flex"),t.style.setProperty("align-items","center"),t.style.setProperty("justify-content","center"),t.style.setProperty("pointer-events","none");var n=t.offsetWidth,i=t.offsetHeight,o=n<i?n:i;r.style.setProperty("width",.25*o+"px"),r.style.setProperty("height",.25*o+"px"),r.style.setProperty("border","5px solid #f3f3f3"),r.style.setProperty("border-top","5px solid #3498db"),r.style.setProperty("border-radius","100px"),r.style.setProperty("animation","sbn-solar-system-viewer-loader-spin 2000ms linear infinite")}}(this._container)}var n=e.prototype;return n.init=function(){var e=c(d.mark((function e(){var n,i=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInit){e.next=2;break}return e.abrupt("return");case 2:if(this._isInit=!0,qe(new Date),this._preInitHook(),window.addEventListener("resize",this._updateCameraAspect),n=window.devicePixelRatio?window.devicePixelRatio:1,this._renderer=new t.WebGLRenderer({canvas:this._canvas,antialias:!0,alpha:!0}),this._renderer.setPixelRatio(n),this._renderer.sortObjects=!1,this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=t.PCFSoftShadowMap,this._renderer.outputEncoding=t.GammaEncoding,this._camera.position.copy(this._initialViewingVector),this._camera.up=new t.Vector3(0,0,1),this._camera.lookAt(0,0,0),this._controls=new r.OrbitControls(this._camera,this._renderer.domElement),this._controls.enableDamping=!0,this._controls.dampingFactor=.25,this._controls.target=new t.Vector3,this._sceneEntities.length){e.next=22;break}throw new Error(f("You have no scene entities!"));case 22:return e.next=24,Promise.all(this._sceneEntities.map(function(){var e=c(d.mark((function e(t){var r;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.init();case 2:if((r=e.sent)&&r.children.length){e.next=5;break}throw new Error(f('\n            -----------------------------------------------------------------------------\n            The scene entity "'+t.constructor.name+'" has empty sceneEntityGroup\n            after initialization!!!\n            -----------------------------------------------------------------------------\n            '));case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(e){return new Promise((function(t){return setTimeout((function(){return t(e)}),100)}))})).then((function(e){return e}));case 24:e.sent.forEach((function(e){return i._scene.add(e)})),this.setHelpersVisibility(!1),this._updateCameraAspect(),this._startRendering(),this._postInitHook(),this.setIsLoaderDivVisible(!1),P("Finished initiating scene.");case 32:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.setIsLoaderDivVisible=function(e,t){void 0===t&&(t=3e3),this._isLoaderVisible=e,function(e,t){void 0===t&&(t=3e3);var r=document.getElementById(w);null==r||r.style.setProperty("transition","opacity "+t+"ms ease-in-out"),null==r||r.style.setProperty("opacity",""+(e?1:0))}(this._isLoaderVisible,t)},n.setFramesPerSecond=function(e){e<=0||e>100||(this._fps=e)},n._update=function(){var e=this;if(this._sceneEntities.forEach((function(t){return t.update(e._camera,e._clock.elapsedTime)})),this.updateCamera(),!this._camera||!this._renderer)throw new Error("Poor Logic");this._requestAnimationFrameId&&this._renderer.render(this._scene,this._camera)},e}(),M=function(e,r){return new Promise((function(n,i){(new t.TextureLoader).load(e,(function(e){e.encoding=t.GammaEncoding,setTimeout((function(){return n(e)}),5)}),(function(e){return console.log(r+" "+e.loaded/e.total*100+"%")}),(function(){console.log("Failed to load: ",e),i(new Error("Failed to load: "+e))}))}))},T={SUN:{radiusMeters:696342e3,periodDays:void 0},MERCURY:{radiusMeters:2439700,periodDays:87.9691},VENUS:{radiusMeters:6051800,periodDays:224.701},EARTH:{radiusMeters:6378e3,periodDays:365.256},MARS:{radiusMeters:3389500,periodDays:686.971},CERES:{radiusMeters:47e4,periodDays:1683.14570801},JUPITER:{radiusMeters:71492e3,periodDays:4332.59},SATURN:{radiusMeters:60268e3,periodDays:10759.22},URANUS:{radiusMeters:25362e3,periodDays:30688.5},NEPTUNE:{radiusMeters:24764e3,periodDays:60182},PLUTO:{radiusMeters:1188300,periodDays:90560},HAUMEA:{radiusMeters:62e4,periodDays:103410},MAKEMAKE:{radiusMeters:72e4,periodDays:111845},ERIS:{radiusMeters:1163e3,periodDays:204199},MOON:{radiusMeters:35e4,periodDays:29.5}},L={__sbnViewer__isPlanetsLoadedBeforeAnimationBegins:!0,__sbnViewer__isBeltLoadedBeforeAnimationBegins:!0,__sbnViewer__isBeltAbundanceToyModel:!0,__sbnViewer__beltAbundanceMaxObjects:100,__sbnViewer__beltAbundanceHThreshold:-10};m=Object.keys(L),g=l({},localStorage),Object.keys(g).forEach((function(e){m.includes(e)||localStorage.removeItem(e)})),m.forEach((function(e){var t=localStorage.getItem(e);if(t)try{typeof JSON.parse(t)!=typeof L[e]&&localStorage.setItem(e,JSON.stringify(L[e]))}catch(e){return void console.log("Local-storage mishap")}else localStorage.setItem(e,JSON.stringify(L[e]))}));var A=function(){var e={};return Object.keys(L).forEach((function(t){var r=localStorage.getItem(t);if(r)try{var n=JSON.parse(r);e[t]=n}catch(e){return}})),l({},L,e)},O=function e(){var r=this;this._isAsyncLoad=function(){return e._isAsyncLoad},this._sceneEntityGroup=new t.Group,this.getSceneEntityGroup=function(){return r._sceneEntityGroup}};O._isAsyncLoad=A().__sbnViewer__isPlanetsLoadedBeforeAnimationBegins;var I=function(e){function r(r){var n;return(n=e.call(this)||this)._toyScale=r,n._toyGroup=[],n._realScale=1,n._isZoomToToyScale=!1,n.isLogScale=!1,n.logTransitionClock=new t.Clock,n}u(r,e);var n=r.prototype;return n.setIsZoomToToyScale=function(e){this._isZoomToToyScale=e},n.setToyScale=function(e){this._toyScale=e},n.getScale=function(){return this._isZoomToToyScale?this._toyScale:this._realScale},n._setToToyScale=function(){var e=this;this._isZoomToToyScale=!0,this._toyGroup.forEach((function(t){var r=e._toyScale;t.scale.set(r,r,r)}))},n.setIsLogScale=function(e){this.isLogScale=e,this.logTransitionClock=new t.Clock(!0),this.logTransitionClock.start(),this.setToyScale(this.isLogScale?1e3:3e3)},n.toggleIsLogScale=function(){this.setIsLogScale(!this.isLogScale)},n.getLogInterpolationParam=function(){var e=this.logTransitionClock.getElapsedTime()/2,t=e<1?e:1;return this.isLogScale?t:1-t},n._updateModelScale=function(){var e=this;this._toyGroup.forEach((function(t){var r=e._isZoomToToyScale?e._toyScale:e._realScale,n=t.scale,i=n.x,o=n.y,s=n.z;if(i!==r){var a=e._toyScale/20;i<r&&t.scale.set(i+a,o+a,s+a),i>r&&t.scale.set(i-a,o-a,s-a),Math.abs(i-r)<a&&t.scale.set(r,r,r)}}))},r}(O),k=D();function D(){return"https://sbn-solar-system-viewer.s3.amazonaws.com"}var C,B=y(1),N=function(e){function r(){var r;return(r=e.call(this,30)||this).NAME="SUN",r.position=new t.Vector3(0,0,0),r.sunRadiusMeters=T.SUN.radiusMeters,r.model=new t.Group,r.sprite=new t.Sprite(new t.SpriteMaterial({blending:t.AdditiveBlending,transparent:!0,visible:!1})),r.getRadius=function(){return r.sunRadiusMeters},r.getPosition=function(){return r.position},r.sprite.scale.multiplyScalar(20*r.sunRadiusMeters),r.model.add(r.sprite),r.helper=new t.LineSegments(new t.EdgesGeometry(new t.SphereGeometry(r.sunRadiusMeters,32)),new t.LineBasicMaterial({color:new t.Color("cyan")})),r.helper.userData.isHelper=!0,r.helper.rotateX(Math.PI/2),r.model.add(r.helper),r}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var t=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(r){var n,i;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=k+"/stars/sun3-sprite-512.png",i=function(e){t.sprite.material.map=e,t.sprite.material.needsUpdate=!0,t.sprite.material.visible=!0},!t._isAsyncLoad()){e.next=6;break}M(n,"SUN SPRITE IMAGE").then(i).catch((function(e){return null})),e.next=11;break;case 6:return e.t0=i,e.next=9,M(n).catch((function(e){return null}));case 9:e.t1=e.sent,(0,e.t0)(e.t1);case 11:t._toyGroup.push(t.model),t._sceneEntityGroup.name=t.NAME,t._sceneEntityGroup.add(t.model),P("RESOLVED SUN"),r(t._sceneEntityGroup);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.update=function(){this._updateModelScale()},r}(I);function V(e,r,i,o){return new Promise((function(s,a){(new n.GLTFLoader).load(e,(function(e){var n=e.scene;r&&function(e,r){var n=Math.pow(10,-10);e.traverse((function(e){e instanceof t.Mesh&&(e.geometry.computeBoundingSphere(),e.geometry&&e.geometry.boundingSphere&&e.geometry.boundingSphere.radius>n&&(n=e.geometry.boundingSphere.radius))}));var i=r/n;e.scale.set(i,i,i)}(n,r),i&&function(e){var r=(new t.Box3).setFromObject(e).getCenter(new t.Vector3).toArray(),n=r[0],i=r[1],o=r[2],s=e.position.clone().toArray();e.position.set(s[0]-n,s[1]-i,s[2]-o)}(n),o&&function(e){e.traverse((function(e){"Mesh"===e.type&&(e.castShadow=!0,e.receiveShadow=!0)}))}(n),setTimeout((function(){return s(n)}),5)}),(function(e){return!1}),(function(e){console.log("Loading error occurred:",e.message),a()}))}))}!function(e){e.PLANET="PLANET",e.DWARF_PLANET="DWARF_PLANET",e.SUN="SUN",e.ASTEROID="ASTEROID"}(C||(C={}));var R=new Set(["a","e","i","q","epoch","period","tp","ma","n","L","om","w","wBar","GM"]),G=new Set(["i","ma","n","L","om","w","wBar"]);function U(e){return void 0!==e}var j=function(){function e(e,t,r){var n=this;void 0===t&&(t="rad"),void 0===r&&(r=!1),this._locked=!1,this._attrs=l({},e),this._locked=!1,e&&Object.keys(e).forEach((function(r){var i=G.has(r)?t:void 0,o=e[r];o&&n.set(r,o,i)})),void 0===this._attrs.GM&&(this._attrs.GM=H.SUN),this.fill(),this.get("e")>.9&&void 0===this.get("tp")&&console.warn('You must specify "tp" (time of perihelion) for highly eccentric orbits'),this._locked=r}var t=e.prototype;return t.set=function(e,t,r){if(void 0===r&&(r="rad"),this._locked)throw new Error("Attempted to modify locked (immutable) Ephem object");return R.has(e)?(this._attrs[e]="deg"===r?t*Math.PI/180:t,!0):(console.warn("Invalid ephem attr: "+e),!1)},t.get=function(e,t){void 0===t&&(t="rad");var r=this._attrs[e];return"deg"===t?180*r/Math.PI:r},t.fill=function(){var e=this.get("e");if(!U(e))throw new Error('Must define eccentricity "e" in an orbit');var t=this.get("a"),r=this.get("q");if(U(t)){if(!U(r)){if(e>=1)throw new Error('Must provide perihelion distance "q" if eccentricity "e" is greater than 1');this.set("q",r=t*(1-e))}}else{if(!U(r))throw new Error('Must define semimajor axis "a" or perihelion distance "q" in an orbit');this.set("a",t=r/(1-e))}var n=this.get("w"),i=this.get("wBar"),o=this.get("om");U(n)&&U(o)&&!U(i)?this.set("wBar",i=n+o):U(i)&&U(o)&&!U(n)?this.set("w",n=i-o):U(n)&&U(i)&&!U(o)&&this.set("om",o=i-n);var s=149597870700*t,a=this.get("n"),c=this.get("GM"),l=this.get("period");if(!U(l)&&U(t)&&(l=2*Math.PI*Math.sqrt(s*s*s/c)/86400,this.set("period",l)),e<1)if(U(l)&&!U(a)){var u=2*Math.PI/l;this.set("n",u)}else U(a)&&!U(l)&&this.set("period",2*Math.PI/a);var p=this.get("ma"),h=this.get("L");!U(h)&&U(o)&&U(n)&&U(p)&&this.set("L",h=o+n+p),U(p)||this.set("ma",h-i)},t.lock=function(){this._locked=!0},t.copy=function(){return new e({GM:this.get("GM"),epoch:this.get("epoch"),a:this.get("a"),e:this.get("e"),i:this.get("i"),om:this.get("om"),ma:this.get("ma"),w:this.get("w")},"rad")},e}(),H={SUN:0x731c14d13d71fc000,MERCURY:22031780000000.02,VENUS:324858592000000.06,EARTH_MOON:403503235502259.8,MARS:42828375214000.02,JUPITER:0x1c22c96966960d0,SATURN:379405852e8,URANUS:5794548600000008,NEPTUNE:6836527100580024,PLUTO_CHARON:977000000000.0007},z={MERCURY:new j({epoch:2458426.5,a:.3870968969437096,e:.2056515875393916,i:7.003891682749818,om:48.30774804443502,w:29.17940253442659,ma:256.190975209273},"deg",!0),VENUS:new j({epoch:2458426.5,a:.7233458663591554,e:.006762510759617694,i:3.394567787211735,om:76.62534150657346,w:54.74567447560867,ma:275.6687596099721},"deg",!0),EARTH:new j({epoch:2451545,a:1.00000261,e:.01671123,i:-1531e-8,om:0,wBar:102.93768193,L:100.46457166},"deg",!0),MOON:new j({GM:398600,epoch:2458621.5,a:.002582517063772124,e:.04582543645168888,i:5.102060246928811,om:108.5916732144811,w:61.80561793729225,ma:50.53270083636792},"deg",!0),MARS:new j({epoch:2458426.5,a:1.52371401537107,e:.09336741335309606,i:1.848141099825311,om:49.50420572080223,w:286.6965847685386,ma:25.38237617924876},"deg",!0),CERES:new j({epoch:2459200.5,a:2.7660891,e:.0781685,i:10.5879,om:80.27236,w:73.72487,ma:205.54542},"deg",!0),JUPITER:new j({epoch:2458426.5,a:5.20180355911023,e:.0489912558249006,i:1.303560894624275,om:100.5203828847816,w:273.736301845404,ma:231.939544389401},"deg",!0),SATURN:new j({epoch:2458426.5,a:9.577177295536776,e:.05101889921719987,i:2.482782449972317,om:113.6154964073247,w:339.4422648650336,ma:187.0970898012944},"deg",!0),URANUS:new j({epoch:2458426.5,a:19.14496966635462,e:.04832662948112808,i:.7697511134483724,om:74.14239045667875,w:99.42704504702185,ma:220.2603033874267},"deg",!0),NEPTUNE:new j({epoch:2458426.5,a:30.0962226342805,e:.00736257118719377,i:1.774569249829094,om:131.8695882492132,w:258.6226409499831,ma:315.2804988924479},"deg",!0),PLUTO:new j({epoch:2454000.5,a:39.4450697257,e:.250248713478,i:17.0890009196,om:110.376957955,w:112.597141677,ma:25.2471897122},"deg",!0),HAUMEA:new j({epoch:2459200.5,a:43.116,e:.19642,i:28.2137,om:122.167,w:239.041,ma:218.205},"deg",!0),MAKEMAKE:new j({epoch:2458900.5,a:45.43,e:.16126,i:28.9835,om:79.62,w:294.834,ma:165.514},"deg",!0),ERIS:new j({epoch:2459000.5,a:67.864,e:.43607,i:44.04,om:35.951,w:151.639,ma:205.989},"deg",!0)};function K(e,t,r){return[1*e,1*t,1*r]}function F(e,t,r,n,i,o){if(void 0===e)throw"data object is undefined";if(!Array.isArray(e))throw"data object must be an array";if(r>=n)throw"first row must be greater than last row";if(r<0)throw"first row must be greater than zero";if(n>e.length-1)throw"last row must be ";if(!Array.isArray(e[r]))throw"data in rows must be array data";var s=e[0].length-1;if(i<0||i>s)throw"xIndex has to be between 0 and "+s+": "+i;if(o<0||o>s)throw"yIndex has to be between 0 and "+s+": "+o;for(var a=0,c=r;c<=n;c++){for(var l=1,u=r;u<=n;u++)u!==c&&(l*=(t-e[u][i])/(e[c][i]-e[u][i]));a+=l*e[c][o]}return a}var Z,Y=function(e,t){return e-t},q=function(e,t){return e[0]-t},W={distance:"au",time:"day"},J=new Set(["km","au"]),X=new Set(["cartesianposvel"]),Q=new Set(["lagrange"]),$=new Set(["day","sec"]),ee=function(){function e(e){if(this._units=l({},W),this._ephemType="cartesianposvel",this._interpolationType="lagrange",this._interpolationOrder=5,!e)throw"EphemerisTable must be initialized with an ephemeris data structure";if(!e.data||!Array.isArray(e.data)||0===e.data.length||!Array.isArray(e.data[0]))throw"EphemerisTable must be initialized with a structure containing an array of arrays of ephemeris data";if(this._data=[].concat(e.data),e.distanceUnits){if(!J.has(e.distanceUnits))throw"Unknown distance units: "+e.distanceUnits;this._units.distance=e.distanceUnits}if(e.timeUnits){if(!$.has(e.timeUnits))throw"Unknown time units: "+e.timeUnits;this._units.time=e.timeUnits}if(e.ephemerisType){if(!X.has(e.ephemerisType))throw"Unknown ephemeris type: "+e.ephemerisType;this._ephemType=e.ephemerisType}if(e.interpolationType){if(!Q.has(e.interpolationType))throw"Unknown interpolation type: "+e.interpolationType;this._interpolationType=e.interpolationType}if(void 0!==e.interpolationOrder){if(e.interpolationOrder<1||e.interpolationOrder>20)throw"Interpolation order must be >0 and <20: "+e.interpolationOrder;this._interpolationOrder=e.interpolationOrder}if(this._units.distance!==W.distance||this._units.time!==W.time){var t=this.calcDistanceMultiplier(this._units.distance),r=this.calcTimeMultiplier(this._units.time);this._data.forEach((function(e){e[1]*=t,e[2]*=t,e[3]*=t,e[4]*=t*r,e[5]*=t*r,e[6]*=t*r}))}}var t=e.prototype;return t.getPositionAtTime=function(e){if(e<=this._data[0][0])return[this._data[0][1],this._data[0][2],this._data[0][3]];var t=this._data[this._data.length-1];if(e>=t[0])return[t[1],t[2],t[3]];var r=this.calcBoundingIndices(e),n=r.startIndex,i=r.stopIndex;return[F(this._data,e,n,i,0,1),F(this._data,e,n,i,0,2),F(this._data,e,n,i,0,3)]},t.getPositions=function(e,t,r){if(e>t)throw"Requested start needs to be after requested stop";if(r<=0)throw"Step days needs to be greater than zero";for(var n=[],i=e;i<=t;i+=r)n.push(this.getPositionAtTime(i));return n},t.calcDistanceMultiplier=function(e){switch(e){case"au":return 1;case"km":return 1/149597870.7;default:throw new Error("Unknown distance unit type: "+e)}},t.calcTimeMultiplier=function(e){switch(e){case"day":return 1;case"sec":return 1/86400;default:throw new Error("Unknown time unit type: "+e)}},t.calcBoundingIndices=function(e){var t=Math.floor(this._interpolationOrder/2),r=function(e,t,r){if(void 0===r&&(r=Y),void 0===e)throw"data object is undefined";if(!Array.isArray(e))throw"data object must be an array";if(void 0===t)throw"value object must be defined";if(void 0===r)throw"comparer must be defined";for(var n=0,i=e.length;n<=i;){var o=Math.floor((n+i)/2);if(o===e.length)return o;var s=r(e[o],t);if(s<0)n=o+1;else{if(!(s>0))return o;i=o-1}}return~n}(this._data,e,q);r<0&&(r=~r-1);var n=r-t;n<0&&(n=0);var i=n+Number(this._interpolationOrder);return i>=this._data.length&&(i=this._data.length-1,this._data.length>t&&(n=i-t)),{startIndex:n,stopIndex:i}},e}(),te=Math.sin,re=Math.cos,ne=Math.sqrt;function ie(e){return Math.exp(Math.log(e)/3)}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.PARABOLIC=1]="PARABOLIC",e[e.HYPERBOLIC=2]="HYPERBOLIC",e[e.ELLIPTICAL=3]="ELLIPTICAL",e[e.TABLE=4]="TABLE"}(Z||(Z={}));var oe=function(){function e(e,t){this._ephem=e,this._orbitStart=0,this._orbitStop=0,this._options=l({color:"white",eclipticLineColor:"cyan"},t,{orbitPathSettings:l({leadDurationYears:10,trailDurationYears:10,numberSamplePoints:360},t.orbitPathSettings)}),this._orbitType=function(e){if(e instanceof ee)return Z.TABLE;var t=e.get("e");return t>.9&&t<1.2?Z.PARABOLIC:t>1.2?Z.HYPERBOLIC:Z.ELLIPTICAL}(this._ephem)}var r=e.prototype;return r.getPositionAtTime=function(e,t){switch(void 0===t&&(t=!1),this._orbitType){case Z.PARABOLIC:return this.getPositionAtTimeNearParabolic(e,t);case Z.HYPERBOLIC:return this.getPositionAtTimeHyperbolic(e,t);case Z.ELLIPTICAL:return this.getPositionAtTimeElliptical(e,t);case Z.TABLE:return this.getPositionAtTimeTable(e,t)}throw new Error("No handler for this type of orbit")},r.getPositionAtTimeParabolic=function(e,t){var r=this._ephem;if(r instanceof ee)throw new Error("Poor logic allowing table type here");var n=r.get("q"),i=(e-r.get("tp"))*(.01720209895/ne(2))/ne(n*n*n)*1.5,o=ne(1+i*i),s=ie(o+i)-ie(o-i),a=2*Math.atan(s);return this.vectorToHeliocentric(a,n*(1+s*s))},r.getPositionAtTimeNearParabolic=function(e,t){var r=this._ephem;if(r instanceof ee)throw new Error("Poor logic allowing table type here");var n=r.get("e"),i=r.get("q"),o=.75*(e-r.get("tp"))*.01720209895*ne((1+n)/(i*i*i)),s=ne(1+o*o),a=ie(s+o)-ie(s-o),c=(1-n)/(1+n),l=a*a/(1+a*a),u=c*l*l,p=a*(1+c*l*(2/3+.4*a*a+(1.4+33/35*a*a+37/175*Math.pow(a,4))*u+a*a*(432/175+956/1125*a*a+84/1575*Math.pow(a,4))*u*u)),h=2*Math.atan(p);return this.vectorToHeliocentric(h,i*(1+p*p)/(1+p*p*c))},r.getPositionAtTimeHyperbolic=function(e,t){var r=this._ephem;if(r instanceof ee)throw new Error("Poor logic allowing table type here");for(var n=r.get("e"),i=r.get("a"),o=r.get("ma")+r.get("n","rad")*(e-r.get("epoch")),s=o,a=0;a<100;a++){var c=(o+n*(s*Math.cosh(s)-Math.sinh(s)))/(n*Math.cosh(s)-1),l=Math.abs(c-s);if(s=c,l<1e-7)break}var u=s,p=2*Math.atan(ne((n+1)/(n-1)))*Math.tanh(u/2),h=i*(1-n*n)/(1+n*re(p));return this.vectorToHeliocentric(p,h)},r.getPositionAtTimeElliptical=function(e,t){void 0===t&&(t=!1);var r=this._ephem;if(r instanceof ee)throw new Error("Poor logic allowing table type here");var n=r.get("e"),i=r.get("ma","rad"),o=r.get("n","rad"),s=e-r.get("epoch"),a=i+o*s;t&&(console.info("period=",r.get("period")),console.info("n=",o),console.info("ma=",i),console.info("d=",s),console.info("M=",a));for(var c=a,l=0;l<100;l++){var u=a+n*te(c),p=Math.abs(u-c);if(c=u,p<1e-7)break}var h=c,d=2*Math.atan(ne((1+n)/(1-n))*Math.tan(h/2)),f=r.get("a")*(1-n*n)/(1+n*re(d));return this.vectorToHeliocentric(d,f)},r.getPositionAtTimeTable=function(e,t){if(this._ephem instanceof j)throw new Error("Poor logic allowing non-table type here");var r=this._ephem.getPositionAtTime(e);return K(r[0],r[1],r[2])},r.vectorToHeliocentric=function(e,t){var r=this._ephem;if(r instanceof ee)throw new Error("Poor logic allowing table type here");var n=r.get("i","rad"),i=r.get("om","rad"),o=r.get("wBar","rad");return K(t*(re(i)*re(e+o-i)-te(i)*te(e+o-i)*re(n)),t*(te(i)*re(e+o-i)+re(i)*te(e+o-i)*re(n)),t*(te(e+o-i)*te(n)))},r.needsUpdateForTime=function(e){return this._orbitType===Z.TABLE&&(e<this._orbitStart||e>this._orbitStop)},r.getOrbitShape=function(e,t){if(void 0===t&&(t=!1),t&&(this._orbitShape&&(this._orbitShape.geometry.dispose(),this._orbitShape.material.dispose()),this._orbitShape=void 0,this._orbitPoints&&this._orbitPoints.dispose(),this._orbitPoints=void 0,this._eclipticDropLines&&(this._eclipticDropLines.geometry.dispose(),this._eclipticDropLines.material.dispose()),this._eclipticDropLines=void 0),this._orbitShape)return this._orbitShape;if(this._orbitType===Z.ELLIPTICAL)return this.getEllipse();var r=(this._orbitType===Z.TABLE?e:this._ephem.get("tp"))||i.toJulianDay(new Date),n=r-365.25*this._options.orbitPathSettings.trailDurationYears,o=r+365.25*this._options.orbitPathSettings.leadDurationYears,s=(o-n)/this._options.orbitPathSettings.numberSamplePoints;switch(this._orbitStart=n,this._orbitStop=o,this._orbitType){case Z.HYPERBOLIC:return this.getLine(this.getPositionAtTimeHyperbolic.bind(this),n,o,s);case Z.PARABOLIC:return this.getLine(this.getPositionAtTimeNearParabolic.bind(this),n,o,s);case Z.TABLE:return this.getTableOrbit(n,o,s)}throw new Error("Unknown orbit shape")},r.getLine=function(e,r,n,i){for(var o=[],s=r;s<=n;s+=i){var a=e(s);a[0]=y(a[0]),a[1]=y(a[1]),a[2]=y(a[2]),o.push(new t.Vector3(a[0],a[1],a[2]))}var c=new t.BufferGeometry;return c.setFromPoints(o),this.generateAndCacheOrbitShape(c)},r.getTableOrbit=function(e,r,n){if(this._ephem instanceof j)throw new Error("Poor logic allowing non-table type here");var i=this._ephem.getPositions(e,r,n).map((function(e){return[1*(t=e)[0],1*t[1],1*t[2]];var t})).map((function(e){return new t.Vector3(e[0],e[1],e[2])})),o=new t.BufferGeometry;return o.setFromPoints(i),this.generateAndCacheOrbitShape(o)},r.getEllipse=function(){var e=this.getEllipseGeometry();return this.generateAndCacheOrbitShape(e)},r.getEllipseGeometry=function(){var e=this._ephem;if(e instanceof ee)throw new Error("Poor logic allowing table type here");e.get("period");for(var r=e.get("a"),n=e.get("e"),i=2*Math.PI,o=i/90,s=[],a=0;a<i;a+=o){var c=2*Math.atan(ne((1+n)/(1-n))*Math.tan(a/2)),l=r*(1-n*n)/(1+n*re(c)),u=this.vectorToHeliocentric(c,l);(isNaN(u[0])||isNaN(u[1])||isNaN(u[2]))&&(console.error("NaN position value - you may have bad or incomplete data in the following ephemeris:"),console.error(e)),s.push(new t.Vector3(y(u[0]),y(u[1]),y(u[2])))}s.push(s[0]);var p=new t.BufferGeometry;return p.setFromPoints(s),p},r.generateAndCacheOrbitShape=function(e){return this._orbitPoints=e,this._orbitShape=new t.Line(e,new t.LineBasicMaterial({color:new t.Color(this._options.color||4473924)})),this._orbitShape},r.getLinesToEcliptic=function(){if(this._eclipticDropLines)return this._eclipticDropLines;this._orbitPoints||this.getOrbitShape();var e=this._orbitPoints,r=new t.BufferGeometry;if(!e)throw new Error("Poor logic letting point be undefined here");return this._eclipticDropLines=new t.LineSegments(r,new t.LineBasicMaterial({color:this._options.eclipticLineColor||3355443,blending:t.AdditiveBlending})),this._eclipticDropLines},r.getHexColor=function(){var e;return null==(e=this._orbitShape)?void 0:e.material.color.getHex()},r.setHexColor=function(e){var r,n;null!=(r=this._orbitShape)&&null!=(n=r.material)&&n.color&&(this._orbitShape.material.color=new t.Color(e))},r.getVisibility=function(){var e;return null==(e=this._orbitShape)?void 0:e.visible},r.setVisibility=function(e){this._orbitShape&&(this._orbitShape.visible=e)},e}();function se(e){var t=e.length()/B,r=(Math.log10(t)+1)/t,n=e.clone();return n.multiplyScalar(r),n}var ae=y(1),ce=function(){function e(e,r,n,i,o){var s=this;switch(void 0===r&&(r=C.PLANET),void 0===i&&(i="white"),void 0===o&&(o=.7),this.name=e,this.orbitalType=r,this.skephem=n,this.color=i,this.opacity=o,this.loadPlanet=function(){s.SKEph=z[s.name],s.SKOrbit=new oe(s.SKEph,{color:s.orbitalType===C.PLANET?"white":"pink",eclipticLineColor:void 0,orbitPathSettings:void 0}),s.SKprojectedOrbitLine=s.getMorphedOrbitLine(),s.SKprojectedOrbitLine.material.transparent=!0,s.SKprojectedOrbitLine.material.opacity=s.opacity||1,s.SKprojectedOrbitLine.material.needsUpdate=!0},this.loadAsteroid=function(){s.SKEph=s.skephem||new j({epoch:2458600.5,a:5.38533,e:.19893,i:22.11137,om:294.42992,w:314.2889,ma:229.14238},"deg"),s.SKOrbit=new oe(s.SKEph,{color:"cyan",eclipticLineColor:void 0,orbitPathSettings:void 0}),s.SKprojectedOrbitLine=s.getMorphedOrbitLine(),s.SKprojectedOrbitLine.material.color=new t.Color("cyan"),s.SKprojectedOrbitLine.material.transparent=!0,s.SKprojectedOrbitLine.material.opacity=s.opacity||1,s.SKprojectedOrbitLine.material.needsUpdate=!0},this.getProjectedOrbitLine=function(){return s.SKprojectedOrbitLine},this.orbitalType){case C.ASTEROID:this.loadAsteroid();break;case C.PLANET:case C.DWARF_PLANET:default:this.loadPlanet()}}var r=e.prototype;return r.getMorphedOrbitLine=function(){if(this.orbitLine)return this.orbitLine;if(!this.SKOrbit)throw new Error("Poor logic mi amigo");var e=this.SKOrbit.getEllipseGeometry();e.morphAttributes.position=[];for(var r=e.attributes.position,n=[],i=0;i<r.count;i++){var o=r.getX(i),s=r.getY(i),a=r.getZ(i),c=se(new t.Vector3(o,s,a));n.push(c.x,c.y,c.z)}return e.morphAttributes.position[0]=new t.Float32BufferAttribute(n,3),this.orbitLine=new t.Line(e,new t.LineBasicMaterial({color:new t.Color(this.color||4473924),morphTargets:!0})),this.orbitLine},r.getXyzMeters=function(e){var t;void 0===e&&(e=0);var r=null==(t=this.SKOrbit)?void 0:t.getPositionAtTime(e);return r?{x:y(r[0]),y:y(r[1]),z:y(r[2])}:{x:0,y:0,z:0}},r.getPosition=function(e){void 0===e&&(e=0);var r=this.getXyzMeters(e);return new t.Vector3(r.x,r.y,r.z)},r.getTail=function(e,r,n){void 0===r&&(r=.3*ae),void 0===n&&(n=0);for(var i=this.getPosition(n),s=se(i),a=n,c=n,l=0,u=0,p=!0,h=!0;p||h;)h=u<r,(p=l<r)&&(l=i.distanceTo(this.getPosition(a+=.5))),h&&(u=s.distanceTo(se(this.getPosition(c+=.5))));for(var d=(a-n)/5,f=(c-n)/5,y=e/5,m=[],g=i.clone(),_=s.clone(),v=i.clone(),w=s.clone(),b=e,P=1;P<=5;P++){var E=n+P*f;v=this.getPosition(n+P*d),w=se(this.getPosition(E));var S=b-y,x=g.distanceTo(v),M=_.distanceTo(w),T=new t.CylinderGeometry(b,S,x,3,1,!1),L=new t.CylinderGeometry(b,S,M,3,1,!1),A=g.x,O=g.y,I=g.z,k=new t.Matrix4;k.makeTranslation(A,O,I),k.lookAt(g,v,new t.Vector3(0,0,1)),T.translate(0,-x/2,0),T.rotateX(Math.PI/2),T.applyMatrix4(k);var D=_.x,C=_.y,B=_.z,N=new t.Matrix4;N.makeTranslation(D,C,B),N.lookAt(_,w,new t.Vector3(0,0,1)),L.translate(0,-M/2,0),L.rotateX(Math.PI/2),L.applyMatrix4(N),m.push({realSegmentGeometry:T,loggedSegmentGeometry:L}),g=v,_=w,b=S}return{realGeometry:o.BufferGeometryUtils.mergeBufferGeometries(m.map((function(e){return e.realSegmentGeometry})),!0),loggedGeometry:o.BufferGeometryUtils.mergeBufferGeometries(m.map((function(e){return e.loggedSegmentGeometry})),!0)}},e}(),le=["MERCURY","VENUS","EARTH","MARS","CERES","PLUTO"],ue=["HAUMEA","MAKEMAKE","ERIS"],pe=["CERES","PLUTO","HAUMEA","MAKEMAKE","ERIS"],he=function(e){function r(r){var n,i;return(n=e.call(this,"PLUTO"===(i=r)||"CERES"===i?1e4:"HAUMEA"===i||"MAKEMAKE"===i||"ERIS"===i?15e3:3e3)||this).NAME=r,n.model=new t.Group,n.loadPlanetAsObject=c(d.mark((function e(){var r,i,o,s;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.NAME.toLowerCase(),i=k+"/planets/"+r+"/"+r+".glb",(o=new t.Mesh(new t.SphereGeometry(n.radius,32,32),new t.MeshPhongMaterial)).rotateX(Math.PI/2),n.model.add(o),s=function(e){o.visible=!1,e&&n.model.add(e)},!n._isAsyncLoad()){e.next=10;break}V(i,n.radius).then(s).catch((function(e){return s(null)})),e.next=15;break;case 10:return e.t0=s,e.next=13,V(i,n.radius).catch((function(e){return null}));case 13:e.t1=e.sent,(0,e.t0)(e.t1);case 15:case"end":return e.stop()}}),e)}))),n.loadPlanetAsTexturedSphere=c(d.mark((function e(){var r,i,o,s,a,c,l,u,p;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.NAME.toLowerCase(),i=k+"/planets/"+r+"/"+r+"-map-1024.jpg",o=k+"/planets/"+r+"/"+r+"-bump-1024.png",s=le.includes(n.NAME),a="EARTH"===n.NAME,c=Promise.resolve(null),(l=new t.Mesh(new t.SphereGeometry(n.radius,32,32),new t.MeshPhongMaterial({shininess:a?25:2}))).rotateX(Math.PI/2),n.model.add(l),u=function(e){var r=e[0],i=e[1],o=e[2],s="fulfilled"===i.status?i.value:null,a="fulfilled"===o.status?o.value:null;l.material.map="fulfilled"===r.status?r.value:null,l.material.bumpMap=s,l.material.bumpScale=50*n.radius,l.material.needsUpdate=!0,a&&(n.clouds=new t.Mesh(new t.SphereGeometry(1.05*n.radius,32,32),new t.MeshPhongMaterial({map:a,side:t.DoubleSide,transparent:!0,opacity:.6,depthWrite:!1})),n.model.add(n.clouds))},p=[M(i,r).catch((function(e){return null})),s?M(o,r).catch((function(e){return null})):c,a?new Promise((function(e,r){var n=document.createElement("canvas");n.width=1024,n.height=512;var i=n.getContext("2d"),o=new Image;o.crossOrigin="Anonymous",o.onerror=function(e){console.log("Error: ",e),r()},o.onload=function(){var s=document.createElement("canvas");s.width=o.width,s.height=o.height;var a=s.getContext("2d");a.drawImage(o,0,0);var c=a.getImageData(0,0,s.width,s.height),l=new Image;l.crossOrigin="Anonymous",l.addEventListener("load",(function(){var u=document.createElement("canvas");u.width=l.width,u.height=l.height;var p=u.getContext("2d");p.drawImage(l,0,0);try{for(var h=p.getImageData(0,0,u.width,u.height),d=a.createImageData(s.width,s.height),f=0,y=0;f<o.height;f++)for(var m=0;m<o.width;m++,y+=4)d.data[y+0]=c.data[y+0],d.data[y+1]=c.data[y+1],d.data[y+2]=c.data[y+2],d.data[y+3]=255-h.data[y+0];i.putImageData(d,0,0)}catch(e){console.log("Error: ",e),r()}e(new t.CanvasTexture(n))})),l.src=k+"/planets/earth/earth-clouds-trans-1024.png"},o.src=k+"/planets/earth/earth-clouds-color-1024.png"})).catch((function(e){return null})):c],!n._isAsyncLoad()){e.next=15;break}Promise.allSettled(p).then(u),e.next=20;break;case 15:return e.t0=u,e.next=18,Promise.allSettled(p);case 18:e.t1=e.sent,(0,e.t0)(e.t1);case 20:case"end":return e.stop()}}),e)}))),n.getPosition=function(){return n.model.position},n.getRadius=function(){return n.radius},n.getOrbit=function(){return n.orbit},n.setIsOrbitVisible=function(e){n.SKprojectedOrbitLine.visible=e},n.radius=function(e){return T[e].radiusMeters}(r),n.orbit=new ce(n.NAME,function(e){return pe.includes(e)?C.DWARF_PLANET:C.PLANET}(r)),n.SKprojectedOrbitLine=n.orbit.getProjectedOrbitLine(),n._sceneEntityGroup.add(n.SKprojectedOrbitLine),n._toyGroup.push(n.model),n.helper=new t.LineSegments(new t.EdgesGeometry(new t.SphereGeometry(1.2*n.radius,32)),new t.LineBasicMaterial({color:new t.Color("cyan")})),n.helper.userData.isHelper=!0,n.helper.rotateX(Math.PI/2),n.model.add(n.helper),n}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var t=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(r){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ue.includes(t.NAME)){e.next=5;break}return e.next=3,t.loadPlanetAsObject();case 3:e.next=7;break;case 5:return e.next=7,t.loadPlanetAsTexturedSphere();case 7:P("RESOLVED "+t.NAME),t._sceneEntityGroup.add(t.model),r(t._sceneEntityGroup);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.getDestinationPosition=function(e){void 0===e&&(e=0);var t=this.getLogInterpolationParam(),r=this.orbit.getPosition(e),n=se(r);return r.lerp(n,t)},n.updateOrbitLine=function(){var e=this.getLogInterpolationParam();this.SKprojectedOrbitLine.morphTargetInfluences[0]=e},n.update=function(){var e=this.getDestinationPosition();this.model.position.set(e.x,e.y,e.z),this.updateOrbitLine(),this._updateModelScale(),this.model.rotateZ(.0015),this.clouds&&(this.clouds.rotateY(-1e-4),this.clouds.rotateZ(-4e-4))},r}(I),de=function(e){function r(r){var n;return(n=e.call(this)||this).NAME="STARFIELD",n.texture=null,n.invertColor=function(){n.texture&&(n.texture=function(e,r){void 0===r&&(r=!1);var n=e.image,i=document.createElement("canvas"),o=n.width,s=n.height;i.width=o,i.height=s;var a=i.getContext("2d");a.drawImage(n,0,0);for(var c=a.getImageData(0,0,o,s),l=0,u=0;l<s;l++)for(var p=0;p<o;p++,u+=4)c.data[u+0]=255-c.data[u+0],c.data[u+1]=255-c.data[u+1],c.data[u+2]=255-c.data[u+2],r&&(c.data[u+3]=255-c.data[u+3]);return a.putImageData(c,0,0),new t.CanvasTexture(i)}(n.texture),n.material.map=n.texture,n.material.needsUpdate=!0)},n.material=new t.MeshPhongMaterial({side:t.DoubleSide,transparent:!0,color:"black",opacity:1,shininess:0}),n.mesh=new t.Mesh(new t.SphereGeometry(r,32,32),n.material),n.mesh.rotation.y=Math.PI/2,n._sceneEntityGroup.name="STARFIELD",n}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(n){var i;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=k+"/stars/galaxy-starfield-4096.jpg",!r._isAsyncLoad()){e.next=5;break}M(i,"star-field").then((function(e){r.texture=e,e.encoding=t.GammaEncoding,r.material.map=e,r.material.needsUpdate=!0})),e.next=11;break;case 5:return e.next=7,M(i,"star-field");case 7:r.texture=e.sent,r.material.map=r.texture,r.material.color=new t.Color,r.material.needsUpdate=!0;case 11:r._sceneEntityGroup.add(r.mesh),console.log("Starfield resolved",+new Date-+We()),n(r._sceneEntityGroup);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.update=function(){},r}(O),fe=function(e){function r(){var t;return(t=e.apply(this,arguments)||this).NAME="Misc Helpers",t.update=function(){},t}return u(r,e),r.prototype.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=new t.AxesHelper(y(100));n.userData.isHelper=!0,r._sceneEntityGroup.add(n),e(r._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r}(O),ye=function(e){function r(t){var r;return void 0===t&&(t=.3),(r=e.call(this)||this)._defaultIntensity=t,r.NAME="Simple Light",r.setPower=function(e){r._light.intensity=e||r._defaultIntensity},r.update=function(){},r}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){r._light=new t.AmbientLight(3355443,r._defaultIntensity),r._light.userData.isAmbientLight=!0,r._sceneEntityGroup.add(r._light),e(r._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.setIsOn=function(e){this._light.visible=e},r}(O),me=function(e,r,n){void 0===r&&(r=.25),void 0===n&&(n=new t.Vector3);for(var i=new t.DodecahedronGeometry(e,1),o=i.getAttribute("position"),s=new t.Vector3,a={},c=0;c<o.count;c++){s.fromBufferAttribute(o,c);var l=[s.x,s.y,s.z].join(",");a[l]||(a[l]={x:s.x+=Math.random()*e*r,y:s.y+=Math.random()*e*r,z:s.z+=Math.random()*e*r});var u=a[l];o.setXYZ(c,u.x,u.y,u.z)}var p=.5+Math.random(),h=.5+Math.random(),d=.5+Math.random();i.scale(p,h,d);var f=i.clone(),y=se(n);return i.translate(n.x,n.y,n.z),f.translate(y.x,y.y,y.z),{realGeometry:i,loggedGeometry:f}},ge=function(e){function r(r,n){var i;return void 0===n&&(n=1e4),(i=e.call(this,3e6)||this).NAME=r,i.radius=n,i.model=new t.Group,i.getPosition=function(){var e=i.orbit.getXyzMeters();return new t.Vector3(e.x,e.y,e.z)},i.getRadius=function(){return i.radius},i.getOrbit=function(){return i.orbit},i.setIsOrbitVisible=function(e){i.SKprojectedOrbitLine.visible=e},i.orbit=new ce(r,C.ASTEROID),i.SKprojectedOrbitLine=i.orbit.getMorphedOrbitLine(),i._sceneEntityGroup.add(i.SKprojectedOrbitLine),i}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(n){var i,o,s;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=k+"/misc/asteroid-texture-1024.jpg",o=me(r.radius),e.t0=t.Mesh,e.t1=o.realGeometry,e.t2=t.MeshPhongMaterial,e.next=7,M(i);case 7:e.t3=e.sent,e.t4={map:e.t3,shininess:0},e.t5=new e.t2(e.t4),s=new e.t0(e.t1,e.t5),r.model.add(s),r._toyGroup.push(r.model),r._sceneEntityGroup.add(r.model),n(r._sceneEntityGroup);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.updateOrbitLine=function(){var e=this.getLogInterpolationParam();this.SKprojectedOrbitLine.morphTargetInfluences[0]=e},n.getDestinationPosition=function(e){void 0===e&&(e=0);var t=this.getLogInterpolationParam(),r=this.orbit.getPosition(e),n=se(r);return r.lerp(n,t)},n.update=function(){var e=this.getDestinationPosition();this.model.position.set(e.x,e.y,e.z),this.updateOrbitLine(),this._updateModelScale()},r}(I),_e=function(e){function r(t,r){var n;return void 0===t&&(t=.3),void 0===r&&(r=1),(n=e.call(this)||this)._defaultIntensity=t,n._radius=r,n.NAME="Point Light",n.setPower=function(e){n._light.intensity=e||n._defaultIntensity},n.update=function(){},n}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){r._light=new t.PointLight(3355443,r._defaultIntensity);var n=new t.PointLightHelper(r._light,r._radius,new t.Color("red"));n.userData.isHelper=!0,r._sceneEntityGroup.add(r._light),r._sceneEntityGroup.add(n),e(r._sceneEntityGroup)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.setIsOn=function(e){this._light.visible=e},r}(O),ve=.1*B,we=function(e){function r(r,n){var i;void 0===r&&(r="BIRDSEYE"),void 0===n&&(n=30),(i=e.call(this,1)||this).NAME=r,i.token=new t.Object3D,i.position=new t.Vector3(ve,ve,30*B),i.getPosition=function(){return i.token.position},i.getRadius=function(){return 1},i.position.setZ(n*B);var o=i.position;return i.token.position.set(o.x,o.y,o.z),i._sceneEntityGroup.add(i.token),i}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var t=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(r){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(t._sceneEntityGroup);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.update=function(){},r}(I),be=function(e){return e instanceof we?new t.Vector3(0,0,0):e.getPosition()},Pe=["MBA","NEO1KM","NOT_NEO1KM","PHA","DISTANTOBJECT"];function Ee(e){switch(e){case"MBA":return"grey";case"NEO1KM":return"orange";case"NOT_NEO1KM":return"pink";case"PHA":return"red";case"DISTANTOBJECT":return"cyan"}}function Se(e){return URL.createObjectURL(new Blob(['importScripts( "'+e+'" );'],{type:"text/javascript"}))}function xe(e,t){return Me.apply(this,arguments)}function Me(){return(Me=c(d.mark((function e(r,n){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(i){var o,s,a;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o="http://localhost:3001";try{o="https://sbn-solar-system-viewer.s3.amazonaws.com/scripts"}catch(e){}return s=Se(o+"/asteroid-belt-worker-0.1.0.js"),P("Start getting worker"),e.next=7,Promise.all(r.map((function(e){return new Promise((function(t){var r=new Worker(s);r.onmessage=function(r){setTimeout((function(){t({belt:e,data:r.data})}),100)},r.postMessage(e)}))})));case 7:a=e.sent,n.updateDisplayedMessage("Loading asteroids belts"),n.setIsScenePaused(!0),setTimeout((function(){var e=a.map((function(e){var r=e.belt,n=JSON.parse(e.data),i=new t.BufferGeometryLoader;return{mergedAsteroidGeometry:i.parse(n.mergedAsteroidGeometry),mergedTailsGeometry:i.parse(n.mergedTailsGeometry),belt:r}}));n.updateDisplayedMessage("Asteroids Loaded"),n.setIsScenePaused(!1),i(e)}),100);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Te=function(){return Pe.reduce((function(e,r,n){return e[r]=new t.Mesh(new t.BufferGeometry,new t.MeshPhongMaterial({morphTargets:!0})),e}),{})},Le=function(e){function r(r,n){var i;return(i=e.call(this,3e3)||this).belts=r,i.parentSceneManager=n,i.isMeshesLoaded=!1,i.isBeltVisible=!0,i.mergedAsteroidsMeshes=Te(),i.mergedTailsMeshes=Te(),i.getPosition=function(){return new t.Vector3},i.getRadius=function(){return 1},i.NAME="BELTS",i.belts.forEach((function(e){i._sceneEntityGroup.add(i.mergedAsteroidsMeshes[e]),i._sceneEntityGroup.add(i.mergedTailsMeshes[e])})),i.parentSceneManager.updateDisplayedMessage("Building asteroid belt"),i}u(r,e);var n=r.prototype;return n.init=function(){var e=c(d.mark((function e(){var r=this;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(n){var i,o;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=k+"/misc/rock-texture-512.png",e.next=3,M(i).catch((function(e){return null}));case 3:o=e.sent,xe(r.belts,r.parentSceneManager).then((function(e){e.forEach((function(e){var n=e.belt,i=e.mergedAsteroidGeometry,s=e.mergedTailsGeometry,a=Ee(n);r.mergedAsteroidsMeshes[n].geometry=i,r.mergedAsteroidsMeshes[n].material=new t.MeshPhongMaterial({color:new t.Color(a),map:o,shininess:0,transparent:!0,morphTargets:!0}),r.mergedAsteroidsMeshes[n].material.needsUpdate=!0,r.mergedAsteroidsMeshes[n].morphTargetInfluences=[0],r.mergedTailsMeshes[n].geometry=s,r.mergedTailsMeshes[n].material=new t.MeshPhongMaterial({color:new t.Color(a),transparent:!0,morphTargets:!0}),r.mergedTailsMeshes[n].material.needsUpdate=!0,r.mergedTailsMeshes[n].morphTargetInfluences=[0],P(r.NAME+" LOADED"),r.isMeshesLoaded=!0}))})),P("RESOLVED "+r.NAME),n(r._sceneEntityGroup);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),n.updateMeshes=function(){var e=this,t=this.getLogInterpolationParam();this.belts.forEach((function(r){e.mergedAsteroidsMeshes[r].morphTargetInfluences[0]=t,e.mergedTailsMeshes[r].morphTargetInfluences[0]=t}))},n.setIsBeltVisible=function(e){var t=this;this.isBeltVisible=e,this.belts.forEach((function(e){t.mergedAsteroidsMeshes[e].visible=t.isBeltVisible,t.mergedTailsMeshes[e].visible=t.isBeltVisible}))},n.toggleIsBeltVisible=function(){this.setIsBeltVisible(!this.isBeltVisible)},n.update=function(e){var r=this;if(this._updateModelScale(),this.isMeshesLoaded&&this.updateMeshes(),e){var n=e.position.distanceTo(new t.Vector3),i=0;(i=(n-4*B)/(.5*B))<0&&(i=0),i>1&&(i=1),this.belts.forEach((function(e){r.isBeltVisible&&(r.mergedTailsMeshes[e].material.opacity=i,r.mergedTailsMeshes[e].visible=0!==i,r.mergedTailsMeshes[e].material.needsUpdate=!0)}))}},r}(I),Ae=function(){var e=c(d.mark((function e(t,r){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){})));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Oe=function(){var e=c(d.mark((function e(t,r){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=c(d.mark((function e(n){var i;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("Canvas Container is Falsy!");case 2:return(i=document.createElement("div")).style.setProperty("display","flex"),i.style.setProperty("flex-direction","column"),i.style.setProperty("gap","12px"),i.style.setProperty("position","absolute"),i.style.setProperty("top","100px"),i.style.setProperty("bottom","100px"),i.style.setProperty("right","0px"),i.style.setProperty("width","120px"),r.append(i),e.next=14,Promise.all(t.map(function(){var e=c(d.mark((function e(t){var r;return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=document.createElement("div")).innerText=t.label,r.style.setProperty("display","flex"),r.style.setProperty("flex","1"),r.style.setProperty("justify-content","center"),r.style.setProperty("align-items","center"),e.next=8,Ae(r,t.cb);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:e.sent.forEach((function(e){i.append(e)})),n();case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),Ie=function(e){Object.keys(e).forEach((function(t){localStorage.setItem(t,JSON.stringify(e[t]))}))},ke=function(e){void 0===e&&(e="placeholder-id"+v());var t=document.createElement("div");t.classList.add("three-column-container"),t.style.setProperty("overflow-x","scroll"),t.style.setProperty("width","100%"),t.style.setProperty("height","34px"),t.style.setProperty("display","flex"),t.style.setProperty("white-space","nowrap"),t.id=e;var r=document.createElement("div");r.classList.add("first-column"),r.style.setProperty("display","flex"),r.style.setProperty("align-items","center"),r.style.setProperty("justify-content","right"),r.style.setProperty("flex","1 0 280px"),r.style.setProperty("padding-right","10px"),r.style.setProperty("overflow-x","scroll"),t.append(r);var n=document.createElement("div");n.classList.add("second-column"),n.style.setProperty("display","flex"),n.style.setProperty("align-items","center"),n.style.setProperty("justify-content","center"),n.style.setProperty("flex","0 0 70px"),t.append(n);var i=document.createElement("div");return i.classList.add("third-column"),i.style.setProperty("display","flex"),i.style.setProperty("align-items","center"),i.style.setProperty("justify-content","left"),i.style.setProperty("flex","1 0 calc(100% - 70px - 280px - 20px)"),i.style.setProperty("padding-left","10px"),t.append(i),{threeColumnContainerDiv:t,firstColumnDiv:r,secondColumnDiv:n,thirdColumnDiv:i}},De=function(e,t,r,n,i){void 0===i&&(i=function(e){});var o,s=ke(),a=s.threeColumnContainerDiv,c=s.firstColumnDiv,l=s.secondColumnDiv,u=s.thirdColumnDiv,p=(o=A(),{__sbnViewer__isBeltAbundanceToyModel:o.__sbnViewer__isBeltAbundanceToyModel,__sbnViewer__isBeltLoadedBeforeAnimationBegins:o.__sbnViewer__isBeltLoadedBeforeAnimationBegins,__sbnViewer__isPlanetsLoadedBeforeAnimationBegins:o.__sbnViewer__isPlanetsLoadedBeforeAnimationBegins})[n];c.innerHTML="<span>"+e+"</span>",u.innerHTML="<span>"+(p?t:r)+"</span>";var h=document.createElement("label");h.classList.add("switch"),l.append(h);var d=document.createElement("input");d.type="checkbox",d.checked=p,h.append(d);var f=document.createElement("span");return f.classList.add("slider"),h.append(f),d.addEventListener("click",(function(){setTimeout((function(){var e;Ie(((e={})[n]=!A()[n],e));var o=d.checked;u.innerHTML=""+(o?t:r),i(o)}),0)})),a},Ce=function(e,t){var r=ke(),n=r.threeColumnContainerDiv,i=r.secondColumnDiv;r.firstColumnDiv.innerHTML="<span>"+e+"</span>";var o,s=document.createElement("input");return s.style.setProperty("min-width","10px"),s.style.setProperty("max-width","50px"),s.style.setProperty("min-height","10px"),s.style.setProperty("height","30px"),s.id="input-id-123",s.value=(o=A(),{__sbnViewer__beltAbundanceHThreshold:o.__sbnViewer__beltAbundanceHThreshold,__sbnViewer__beltAbundanceMaxObjects:o.__sbnViewer__beltAbundanceMaxObjects})[t]+"",i.append(s),s.oninput=function(){setTimeout((function(){try{var e,r=parseInt(s.value);Ie(((e={})[t]=r,e))}catch(e){alert("Something went horribly wrong with your logic")}}),0)},n};function Be(){var e=document.createElement("div");return e.style.setProperty("width","100%"),e.style.setProperty("height","1px"),e.style.setProperty("background-color","black"),e}var Ne,Ve="settings-panel-id-"+v(),Re="max-objects-container-div-id-"+v(),Ge="threshold-H-container-div-id-"+v(),Ue=!1,je=function(e){function r(r){var n;(n=e.call(this,r)||this).sun=new N,n.isToyScale=!0,n.isOrbitsVisible=!0,n.isLogScale=!1,n.logScalables=[],n.zoomables=[],n.zoomableOrbitals=[],n.zoomTarget=n.sun,n.isZoomingPosition=!1,n.isZoomingAngle=!1,n.zoomTraversalFraction=0,n.zoomClock=new t.Clock,n.isScenePaused=!1,n.updateDisplayedMessage=function(){console.log("denied!")},n.setIsToyScale=function(e){n.isToyScale=!!e,n.toyScalables.forEach((function(e){return e.setIsZoomToToyScale(n.isToyScale)}))},n.toggleIsToyScale=function(){n.isToyScale=!n.isToyScale,n.setIsToyScale(n.isToyScale)},n.setIsOrbitsVisible=function(e){n.isOrbitsVisible=!!e,n.zoomableOrbitals.forEach((function(e){return e instanceof ge||e.setIsOrbitVisible(n.isOrbitsVisible)}))},n.toggleIsOrbitsVisible=function(){n.isOrbitsVisible=!n.isOrbitsVisible,n.setIsOrbitsVisible(n.isOrbitsVisible)},n.toggleAsteroids=function(){n.asteroidBelts.forEach((function(e){return e.toggleIsBeltVisible()}))},n.setIsLogScale=function(e){n.isLogScale=!!e,n.logScalables.forEach((function(e){return e.toggleIsLogScale()})),n.tryToStartZooming(n.isLogScale?"BIRDSEYELOG":"BIRDSEYE")},n.toggleIsLogScale=function(){n.isLogScale=!n.isLogScale,n.setIsLogScale(n.isLogScale)},n.tryToStartZooming=function(e){var r=e.toUpperCase(),i=n.zoomables.find((function(e){return e.NAME===r}));i&&(n.isZoomingPosition=!0,n.isZoomingAngle=!0,n.zoomTarget=i,n.zoomClock=new t.Clock(!0),n._controls.enabled=!0)},n.tryToStopZooming=function(){n.isZoomingAngle||n.isZoomingPosition||(n._controls.target=n.zoomTarget instanceof we?new t.Vector3(0,0,0):n.zoomTarget.getPosition(),n._controls.enabled=!0)},n.updateCamera=function(){var e,r,i,o,s,a,c,l,u,p,h,d,f,y;if(n._clock.getElapsedTime(),n.isZoomingPosition||n.isZoomingAngle){if(n.zoomTraversalFraction=((r=(e=n.zoomClock.getElapsedTime())*e*e*.01)<0&&(r=0),r>1&&(r=1),r),n.isZoomingPosition&&(n.isZoomingPosition=(s=n._camera,a=n.zoomTraversalFraction,c=function(e){var r=e.getScale(),n=e.getRadius();if("SUN"===e.NAME){var i=e.getPosition();return new t.Vector3(i.x+3*n*r,i.y+3*n*r,i.z)}if(e instanceof we)return e.getPosition();var o=e.getPosition().clone(),s=2*n*r/o.length(),a=Math.asin(s);o.applyAxisAngle(new t.Vector3(0,0,1),a);var c=(o.length()+4*n*r)/o.length();return o.multiplyScalar(c),o}(n.zoomTarget),d=new t.Vector3((l=c.x)-(h=s.position).x,(u=c.y)-h.y,(p=c.z)-h.z),y=!0,(i=f=new t.Vector3(h.x+d.x*a,h.y+d.y*a,h.z+d.z*a),o=new t.Vector3(l,u,p),new t.Vector3(o.x-i.x,o.y-i.y,o.z-i.z)).length()<1e-4*B&&(y=!1,f=new t.Vector3(l,u,p)),s.position.set(f.x,f.y,f.z),y)),n.isZoomingAngle)n.isZoomingAngle=function(e,r,n){var i=e.position,o=be(r),s=new t.Vector3(o.x-i.x,o.y-i.y,o.z-i.z),a=e.getWorldDirection(new t.Vector3);a.multiplyScalar(s.length());var c=new t.Vector3(s.x-a.x,s.y-a.y,s.z-a.z),l=new t.Vector3(e.position.x+a.x+c.x*n,e.position.y+a.y+c.y*n,e.position.z+a.z+c.z*n),u=!0;return s.angleTo(a)<.0025&&(u=!1,l=o),e.lookAt(l.x,l.y,l.z),u}(n._camera,n.zoomTarget,n.zoomTraversalFraction);else{var m=be(n.zoomTarget);n._camera.lookAt(m.x,m.y,m.z)}n.tryToStopZooming()}else n._controls.update()};var i,o=((i=document.createElement("div")).id="message-field",i.style.setProperty("position","absolute"),i.style.setProperty("left","0%"),i.style.setProperty("right","0px"),i.style.setProperty("bottom","0px"),i.style.setProperty("height","40px"),i.style.setProperty("display","flex"),i.style.setProperty("justify-content","flex-end"),i.style.setProperty("align-items","center"),i.style.setProperty("padding-right","10px"),i.style.setProperty("background-color","rgba(255,255,255,0.1)"),i.style.setProperty("color","white"),{displayMessageDiv:i,updateMessageCb:function(e){i.innerHTML=e}}),s=o.updateMessageCb;n._container.append(o.displayMessageDiv),n.updateDisplayedMessage=s,n.updateDisplayedMessage("Loading...");var a,c,u,h=(a=n.tryToStartZooming,c=document.createElement("div"),u=document.createElement("input"),c.style.setProperty("position","absolute"),c.style.setProperty("top","10px"),c.style.setProperty("left","10px"),c.style.setProperty("width","120px"),c.style.setProperty("height","40px"),c.style.setProperty("background-color","green"),u.value="Earth",u.style.setProperty("width","100%"),u.style.setProperty("height","100%"),u.style.setProperty("font-size","20px"),u.style.setProperty("font-family","'Odibee Sans', cursive"),u.style.setProperty("font-size","20px"),u.classList.add("sbn-solar-system-viewer-input"),u.addEventListener("keypress",(function(e){"Enter"===e.key&&a(u.value)})),c.append(u),c);n._container.append(h),Oe([{label:"Toggle Toy Scale",cb:n.toggleIsToyScale},{label:"Toggle helpers",cb:n.toggleHelpersVisibility},{label:"Toggle Orbits",cb:n.toggleIsOrbitsVisible},{label:"Toggle Log Scale",cb:n.toggleIsLogScale},{label:"Toggle Asteroids",cb:n.toggleAsteroids}],n._container);var d=function(){var e=document.createElement("div");e.id=Ve,e.style.setProperty("position","absolute"),e.style.setProperty("top","0px"),e.style.setProperty("right",Ue?"0%":"100%"),e.style.setProperty("left","0px"),e.style.setProperty("bottom","0px"),e.style.setProperty("transition","right 1s ease-in-out"),e.style.setProperty("overflow","hidden"),e.style.setProperty("font-family",'"Odibee Sans", cursive'),e.style.setProperty("font-size","22px"),e.style.setProperty("background-color","rgba(255,255,255,0.9)"),e.style.setProperty("color","black"),e.style.setProperty("display","flex"),e.style.setProperty("flex-direction","column"),e.style.setProperty("gap","5px"),e.style.setProperty("justify-content","start"),e.style.setProperty("align-items","center");var t=ke(),r=t.threeColumnContainerDiv;t.secondColumnDiv.innerHTML="<h1>Settings</h1>",r.style.setProperty("height","100px"),e.append(r),e.append(Be());var n=De("Planet loading mode?","Load planets before animation begins","Begin animation then load planets","__sbnViewer__isPlanetsLoadedBeforeAnimationBegins");e.append(n),e.append(Be());var i=De("Comet-Asteroid Loading Mode?","Start animation then load comets-asteroids","Wait for comets-asteroids before starting animation","__sbnViewer__isBeltLoadedBeforeAnimationBegins");e.append(i),e.append(Be());var o=De("Comet-Asteroid Abundance Mode?","Toy Model","Real World Proportions","__sbnViewer__isBeltAbundanceToyModel",(function(e){var t=document.getElementById(Re);t&&t.style.setProperty("display",e?"none":"flex");var r=document.getElementById(Ge);r&&r.style.setProperty("display",e?"none":"flex")}));e.append(o);var s=A().__sbnViewer__isBeltAbundanceToyModel,a=Ce("Max number of objects","__sbnViewer__beltAbundanceMaxObjects");a.style.setProperty("display",s?"none":"flex"),a.id=Re,e.append(a);var c=Ce("Minimum H Mag","__sbnViewer__beltAbundanceHThreshold");return c.id=Ge,c.style.setProperty("display",s?"none":"flex"),e.append(c),e.append(Be()),{toggleSettingsPanelCb:function(){e.style.setProperty("right",(Ue=!Ue)?"0%":"100%")},settingsPanelDiv:e}}(),f=d.toggleSettingsPanelCb;n._container.append(d.settingsPanelDiv);var m=function(e){var t,r,n,i,o,s=document.createElement("div");return s.style.setProperty("position","absolute"),s.style.setProperty("top","0px"),s.style.setProperty("right","0px"),s.style.setProperty("height","70px"),s.style.setProperty("width","70px"),s.style.setProperty("display","flex"),s.style.setProperty("justify-content","center"),s.style.setProperty("align-items","center"),s.style.setProperty("z-index","2"),s.append((r=(t=l({sizePxls:18,color:"black",isOutlined:!1},{color:"white",sizePxls:50})).sizePxls,n=t.isOutlined,i=t.color,(o=document.createElement("span")).innerHTML="settings",o.classList.add(n?"material-icons-outlined":"material-icons"),o.style.setProperty("font-size",r+"px"),o.style.setProperty("color",i),o.style.setProperty("cursor","pointer"),o)),s.addEventListener("click",e),s}(f);return n._container.append(m),n.birdsEyes=[new we,new we("BIRDSEYELOG",5)],n.planets=[new he("MERCURY"),new he("VENUS"),new he("EARTH"),new he("MARS"),new he("CERES"),new he("JUPITER"),new he("SATURN"),new he("URANUS"),new he("NEPTUNE"),new he("PLUTO"),new he("HAUMEA"),new he("MAKEMAKE"),new he("ERIS")],n.asteroids=[],n.asteroidBelts=[new Le(["DISTANTOBJECT","MBA","NEO1KM","PHA"],p(n))],n.starField=new de(y(999)),n.zoomables=[].concat(n.planets,n.asteroids,n.birdsEyes,[n.sun]),n.zoomableOrbitals=[].concat(n.planets,n.asteroids),n.toyScalables=[].concat(n.planets,n.asteroids,n.asteroidBelts,[n.sun]),n.logScalables=[].concat(n.planets,n.asteroids,n.asteroidBelts),P("Begin registering entities"),n.registerSceneEntities([new fe,new ye(.4),new _e(5,T.SUN.radiusMeters)].concat(n.planets,n.asteroids,n.asteroidBelts,[n.sun])),P("Finish registering entities"),n._preInitHook=function(){var e=y(4);n._initialViewingVector=new t.Vector3(0,0,e)},n._postInitHook=function(){n._controls.maxDistance=y(100),n.setHelpersVisibility(!1),n._camera.position.set(35426284497.8745,-725267146538.4939,-111665855099.58893)},setTimeout((function(){n.setIsToyScale(!0),n.tryToStartZooming("BIRDSEYE")}),3500),n._camera.up.set(1,1,1),n._destroyHook=function(){},n}return u(r,e),r.prototype.setIsScenePaused=function(e){this.isScenePaused=e,this.isScenePaused?(this._clock.stop(),this.setIsLoaderDivVisible(!0,0)):(this._clock.start(),this.setIsLoaderDivVisible(!1,0))},r}(x),He=[],ze=function(e){if(!He.includes(e)){He.push(e);var t=document.createElement("link");t.rel="stylesheet",t.href="https://fonts.googleapis.com/"+e,document.head.append(t)}},Ke=!1,Fe=function(){if(!Ke){Ke=!0;var e=document.createElement("style");e.innerHTML='\n    @keyframes sbn-solar-system-viewer-fade-in {\n      from { opacity: 0; }\n      to   { opacity: 1; }\n    }\n\n    @keyframes sbn-solar-system-viewer-loader-spin {\n      0% { transform: rotate(0deg); }\n      100% { transform: rotate(360deg); }\n    }\n\n    .sbn-solar-system-viewer-input:focus{\n        outline-width: 0;\n    }\n\n    /**\n     *\n     * This is for styling the switches\n     *\n     */\n    .three-column-container {\n      width: 100%;\n      height: 34px;\n      display: flex;\n      white-space: nowrap;\n    }\n\n    .three-column-container .switch {\n      position: relative;\n      display: inline-block;\n      width: 60px;\n      height: 34px;\n    }\n\n    /* Hide default HTML checkbox */\n    .three-column-container .switch input {\n      opacity: 0;\n      width: 0;\n      height: 0;\n    }\n\n    /* The slider */\n    .three-column-container .slider {\n      position: absolute;\n      cursor: pointer;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n      background-color: #ccc;\n      background-color: red;\n      -webkit-transition: .4s;\n      transition: .4s;\n    }\n\n    .three-column-container .slider:before {\n      position: absolute;\n      content: "";\n      height: 26px;\n      width: 26px;\n      left: 4px;\n      bottom: 4px;\n      background-color: white;\n      -webkit-transition: .4s;\n      transition: .4s;\n    }\n\n    .three-column-container input:checked + .slider {\n      background-color: #2196F3;\n      background-color: blue;\n    }\n\n    .three-column-container input:focus + .slider {\n      box-shadow: 0 0 1px #2196F3;\n    }\n\n    .three-column-container input:checked + .slider:before {\n      -webkit-transform: translateX(26px);\n      -ms-transform: translateX(26px);\n      transform: translateX(26px);\n    }\n  ',document.head.append(e)}},Ze=!1,Ye=function(){var e=c(d.mark((function e(){return d.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){if(console.log("Debug A"),!Ze)if(Ze=!0,console.log("Debug B"),Fe(),console.log("Debug C"),ze("css2?family=Odibee+Sans"),ze("icon?family=Material+Icons"),ze("icon?family=Material+Icons+Outlined"),console.log("Debug D"),"128"===window.__THREE__)console.log("Debug E"),e();else{console.log("Debug F");var r=document.createElement("script");document.head.append(r),r.onload=function(){console.log("Debug G"),e()},r.onerror=function(){console.log("Debug H"),t()},r.src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();exports.initDate=new Date;var qe=function(e){return exports.initDate=e},We=function(){return exports.initDate};function Je(e){void 0===e&&(e="threejs-canvas-container"),console.log("Debug 0"),Ye().then((function(t){if(console.log("Debug 1"),!document.getElementById(e))throw new Error("Can't find div of id "+e);(Ne=new je(e)).init()})).catch((function(e){console.log("Error loading stuff")}))}function Xe(){Ne.destroy()}exports.SbnSolarSystemViewer=function(e){var t=l({width:"100%",height:"100%",backgroundColor:"grey"},e),r=t.width,n=t.height,i=t.backgroundColor,o="this-id-will-never-be-duplicated-says-007";return s.useEffect((function(){return Je(o),function(){Xe(),console.log("Widget app removed!!!")}}),[]),s.createElement("div",{id:o,style:{width:r,height:n,backgroundColor:i}})},exports.destroy=Xe,exports.getInitDate=We,exports.init=Je,exports.setInitDate=qe;
//# sourceMappingURL=sbnsolarsystemviewer.cjs.production.min.js.map
